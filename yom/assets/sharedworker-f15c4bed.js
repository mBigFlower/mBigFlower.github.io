(function(){"use strict";var Jr=Object.defineProperty,eo=(p,d,b)=>d in p?Jr(p,d,{enumerable:!0,configurable:!0,writable:!0,value:b}):p[d]=b,dt=(p,d,b)=>(eo(p,typeof d!="symbol"?d+"":d,b),b),commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var dexie_min={exports:{}};(function(p,d){(function(b,g){p.exports=g()})(commonjsGlobal,function(){var b=function(e,t){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var u in a)Object.prototype.hasOwnProperty.call(a,u)&&(r[u]=a[u])})(e,t)},g=function(){return(g=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var u in t=arguments[r])Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u]);return e}).apply(this,arguments)};function k(e,t,r){if(r||arguments.length===2)for(var a,u=0,l=t.length;u<l;u++)!a&&u in t||((a=a||Array.prototype.slice.call(t,0,u))[u]=t[u]);return e.concat(a||Array.prototype.slice.call(t))}var C=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:commonjsGlobal,L=Object.keys,B=Array.isArray;function h(e,t){return typeof t!="object"||L(t).forEach(function(r){e[r]=t[r]}),e}typeof Promise>"u"||C.Promise||(C.Promise=Promise);var m=Object.getPrototypeOf,y={}.hasOwnProperty;function D(e,t){return y.call(e,t)}function K(e,t){typeof t=="function"&&(t=t(m(e))),(typeof Reflect>"u"?L:Reflect.ownKeys)(t).forEach(function(r){W(e,r,t[r])})}var Y=Object.defineProperty;function W(e,t,r,a){Y(e,t,h(r&&D(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},a))}function ye(e){return{from:function(t){return e.prototype=Object.create(t.prototype),W(e.prototype,"constructor",e),{extend:K.bind(null,e.prototype)}}}}var te=Object.getOwnPropertyDescriptor,fe=[].slice;function ue(e,t,r){return fe.call(e,t,r)}function de(e,t){return t(e)}function Me(e){if(!e)throw new Error("Assertion Failed")}function De(e){C.setImmediate?setImmediate(e):setTimeout(e,0)}function Ie(e,t){if(typeof t=="string"&&D(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],a=0,u=t.length;a<u;++a){var l=Ie(e,t[a]);r.push(l)}return r}var v=t.indexOf(".");if(v!==-1){var w=e[t.substr(0,v)];return w==null?void 0:Ie(w,t.substr(v+1))}}function Ee(e,t,r){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){Me(typeof r!="string"&&"length"in r);for(var a=0,u=t.length;a<u;++a)Ee(e,t[a],r[a])}else{var l,v,w=t.indexOf(".");w!==-1?(l=t.substr(0,w),(v=t.substr(w+1))===""?r===void 0?B(e)&&!isNaN(parseInt(l))?e.splice(l,1):delete e[l]:e[l]=r:Ee(w=!(w=e[l])||!D(e,l)?e[l]={}:w,v,r)):r===void 0?B(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function Ye(e){var t,r={};for(t in e)D(e,t)&&(r[t]=e[t]);return r}var Xe=[].concat;function Se(e){return Xe.apply([],e)}var mt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Se([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return C[e]}),ce=new Set(mt.map(function(e){return C[e]})),be=null;function $(e){return be=new WeakMap,e=function t(r){if(!r||typeof r!="object")return r;var a=be.get(r);if(a)return a;if(B(r)){a=[],be.set(r,a);for(var u=0,l=r.length;u<l;++u)a.push(t(r[u]))}else if(ce.has(r.constructor))a=r;else{var v,w=m(r);for(v in a=w===Object.prototype?{}:Object.create(w),be.set(r,a),r)D(r,v)&&(a[v]=t(r[v]))}return a}(e),be=null,e}var X={}.toString;function G(e){return X.call(e).slice(8,-1)}var ae=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ge=typeof ae=="symbol"?function(e){var t;return e!=null&&(t=e[ae])&&t.apply(e)}:function(){return null};function we(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var Be={};function Re(e){var t,r,a,u;if(arguments.length===1){if(B(e))return e.slice();if(this===Be&&typeof e=="string")return[e];if(u=ge(e)){for(r=[];!(a=u.next()).done;)r.push(a.value);return r}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(r=new Array(t);t--;)r[t]=e[t];return r}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}var $e=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},j=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ut=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(j),Pe={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ue(e,t){this.name=e,this.message=t}function Ae(e,t){return e+". Errors: "+Object.keys(t).map(function(r){return t[r].toString()}).filter(function(r,a,u){return u.indexOf(r)===a}).join(`
`)}function ve(e,t,r,a){this.failures=t,this.failedKeys=a,this.successCount=r,this.message=Ae(e,t)}function He(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(r){return t[r]}),this.failuresByPos=t,this.message=Ae(e,this.failures)}ye(Ue).from(Error).extend({toString:function(){return this.name+": "+this.message}}),ye(ve).from(Ue),ye(He).from(Ue);var Fe=ut.reduce(function(e,t){return e[t]=t+"Error",e},{}),nt=Ue,oe=ut.reduce(function(e,t){var r=t+"Error";function a(u,l){this.name=r,u?typeof u=="string"?(this.message="".concat(u).concat(l?`
 `+l:""),this.inner=l||null):typeof u=="object"&&(this.message="".concat(u.name," ").concat(u.message),this.inner=u):(this.message=Pe[t]||r,this.inner=null)}return ye(a).from(nt),e[t]=a,e},{});oe.Syntax=SyntaxError,oe.Type=TypeError,oe.Range=RangeError;var Ze=j.reduce(function(e,t){return e[t+"Error"]=oe[t],e},{}),Qe=ut.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=oe[t]),e},{});function ie(){}function he(e){return e}function pe(e,t){return e==null||e===he?t:function(r){return t(e(r))}}function le(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function qe(e,t){return e===ie?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var a=this.onsuccess,u=this.onerror;this.onsuccess=null,this.onerror=null;var l=t.apply(this,arguments);return a&&(this.onsuccess=this.onsuccess?le(a,this.onsuccess):a),u&&(this.onerror=this.onerror?le(u,this.onerror):u),l!==void 0?l:r}}function o(e,t){return e===ie?t:function(){e.apply(this,arguments);var r=this.onsuccess,a=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?le(r,this.onsuccess):r),a&&(this.onerror=this.onerror?le(a,this.onerror):a)}}function s(e,t){return e===ie?t:function(r){var a=e.apply(this,arguments);h(r,a);var u=this.onsuccess,l=this.onerror;return this.onsuccess=null,this.onerror=null,r=t.apply(this,arguments),u&&(this.onsuccess=this.onsuccess?le(u,this.onsuccess):u),l&&(this.onerror=this.onerror?le(l,this.onerror):l),a===void 0?r===void 0?void 0:r:h(a,r)}}function f(e,t){return e===ie?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function A(e,t){return e===ie?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var a=this,u=arguments.length,l=new Array(u);u--;)l[u]=arguments[u];return r.then(function(){return t.apply(a,l)})}return t.apply(this,arguments)}}Qe.ModifyError=ve,Qe.DexieError=Ue,Qe.BulkError=He;var n=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function i(e){n=e}var c={},_=100,mt=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,m(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,m(t),e]}(),j=mt[0],ut=mt[1],mt=mt[2],ut=ut&&ut.then,M=j&&j.constructor,Q=!!mt,me=function(e,t){Ut.push([e,t]),Oe&&(queueMicrotask(Ar),Oe=!1)},Ve=!0,Oe=!0,Le=[],Je=[],gt=he,ct={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ie,pgp:!1,env:{},finalize:ie},se=ct,Ut=[],Tt=0,Ht=[];function re(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=se;if(typeof e!="function"){if(e!==c)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&wn(this,this._value))}this._state=null,this._value=null,++t.ref,function r(a,u){try{u(function(l){if(a._state===null){if(l===a)throw new TypeError("A promise cannot be resolved with itself.");var v=a._lib&&Pt();l&&typeof l.then=="function"?r(a,function(w,x){l instanceof re?l._then(w,x):l.then(w,x)}):(a._state=!0,a._value=l,Zn(a)),v&&Bt()}},wn.bind(null,a))}catch(l){wn(a,l)}}(this,e)}var bn={get:function(){var e=se,t=Qt;function r(a,u){var l=this,v=!e.global&&(e!==se||t!==Qt),w=v&&!bt(),x=new re(function(T,R){kn(l,new Qn(tr(a,e,v,w),tr(u,e,v,w),T,R,e))});return this._consoleTask&&(x._consoleTask=this._consoleTask),x}return r.prototype=c,r},set:function(e){W(this,"then",e&&e.prototype===c?bn:{get:function(){return e},set:bn.set})}};function Qn(e,t,r,a,u){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=a,this.psd=u}function wn(e,t){var r,a;Je.push(t),e._state===null&&(r=e._lib&&Pt(),t=gt(t),e._state=!1,e._value=t,a=e,Le.some(function(u){return u._value===a._value})||Le.push(a),Zn(e),r&&Bt())}function Zn(e){var t=e._listeners;e._listeners=[];for(var r=0,a=t.length;r<a;++r)kn(e,t[r]);var u=e._PSD;--u.ref||u.finalize(),Tt===0&&(++Tt,me(function(){--Tt==0&&_n()},[]))}function kn(e,t){if(e._state!==null){var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Tt,me(Dr,[r,e,t])}else e._listeners.push(t)}function Dr(e,t,r){try{var a,u=t._value;!t._state&&Je.length&&(Je=[]),a=n&&t._consoleTask?t._consoleTask.run(function(){return e(u)}):e(u),t._state||Je.indexOf(u)!==-1||function(l){for(var v=Le.length;v;)if(Le[--v]._value===l._value)return Le.splice(v,1)}(t),r.resolve(a)}catch(l){r.reject(l)}finally{--Tt==0&&_n(),--r.psd.ref||r.psd.finalize()}}function Ar(){Ct(ct,function(){Pt()&&Bt()})}function Pt(){var e=Ve;return Oe=Ve=!1,e}function Bt(){var e,t,r;do for(;0<Ut.length;)for(e=Ut,Ut=[],r=e.length,t=0;t<r;++t){var a=e[t];a[0].apply(null,a[1])}while(0<Ut.length);Oe=Ve=!0}function _n(){var e=Le;Le=[],e.forEach(function(a){a._PSD.onunhandled.call(null,a._value,a)});for(var t=Ht.slice(0),r=t.length;r;)t[--r]()}function Gt(e){return new re(c,!1,e)}function ze(e,t){var r=se;return function(){var a=Pt(),u=se;try{return wt(r,!0),e.apply(this,arguments)}catch(l){t&&t(l)}finally{wt(u,!1),a&&Bt()}}}K(re.prototype,{then:bn,_then:function(e,t){kn(this,new Qn(null,null,e,t,se))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,r=arguments[1];return typeof t=="function"?this.then(null,function(a){return(a instanceof t?r:Gt)(a)}):this.then(null,function(a){return(a&&a.name===t?r:Gt)(a)})},finally:function(e){return this.then(function(t){return re.resolve(e()).then(function(){return t})},function(t){return re.resolve(e()).then(function(){return Gt(t)})})},timeout:function(e,t){var r=this;return e<1/0?new re(function(a,u){var l=setTimeout(function(){return u(new oe.Timeout(t))},e);r.then(a,u).finally(clearTimeout.bind(null,l))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&W(re.prototype,Symbol.toStringTag,"Dexie.Promise"),ct.env=er(),K(re,{all:function(){var e=Re.apply(null,arguments).map(Zt);return new re(function(t,r){e.length===0&&t([]);var a=e.length;e.forEach(function(u,l){return re.resolve(u).then(function(v){e[l]=v,--a||t(e)},r)})})},resolve:function(e){return e instanceof re?e:e&&typeof e.then=="function"?new re(function(t,r){e.then(t,r)}):new re(c,!0,e)},reject:Gt,race:function(){var e=Re.apply(null,arguments).map(Zt);return new re(function(t,r){e.map(function(a){return re.resolve(a).then(t,r)})})},PSD:{get:function(){return se},set:function(e){return se=e}},totalEchoes:{get:function(){return Qt}},newPSD:vt,usePSD:Ct,scheduler:{get:function(){return me},set:function(e){me=e}},rejectionMapper:{get:function(){return gt},set:function(e){gt=e}},follow:function(e,t){return new re(function(r,a){return vt(function(u,l){var v=se;v.unhandleds=[],v.onunhandled=l,v.finalize=le(function(){var w,x=this;w=function(){x.unhandleds.length===0?u():l(x.unhandleds[0])},Ht.push(function T(){w(),Ht.splice(Ht.indexOf(T),1)}),++Tt,me(function(){--Tt==0&&_n()},[])},v.finalize),e()},t,r,a)})}}),M&&(M.allSettled&&W(re,"allSettled",function(){var e=Re.apply(null,arguments).map(Zt);return new re(function(t){e.length===0&&t([]);var r=e.length,a=new Array(r);e.forEach(function(u,l){return re.resolve(u).then(function(v){return a[l]={status:"fulfilled",value:v}},function(v){return a[l]={status:"rejected",reason:v}}).then(function(){return--r||t(a)})})})}),M.any&&typeof AggregateError<"u"&&W(re,"any",function(){var e=Re.apply(null,arguments).map(Zt);return new re(function(t,r){e.length===0&&r(new AggregateError([]));var a=e.length,u=new Array(a);e.forEach(function(l,v){return re.resolve(l).then(function(w){return t(w)},function(w){u[v]=w,--a||r(new AggregateError(u))})})})}));var et={awaits:0,echoes:0,id:0},Ir=0,Wt=[],Jt=0,Qt=0,Pr=0;function vt(e,t,r,a){var u=se,l=Object.create(u);return l.parent=u,l.ref=0,l.global=!1,l.id=++Pr,ct.env,l.env=Q?{Promise:re,PromiseProp:{value:re,configurable:!0,writable:!0},all:re.all,race:re.race,allSettled:re.allSettled,any:re.any,resolve:re.resolve,reject:re.reject}:{},t&&h(l,t),++u.ref,l.finalize=function(){--this.parent.ref||this.parent.finalize()},a=Ct(l,e,r,a),l.ref===0&&l.finalize(),a}function Rt(){return et.id||(et.id=++Ir),++et.awaits,et.echoes+=_,et.id}function bt(){return!!et.awaits&&(--et.awaits==0&&(et.id=0),et.echoes=et.awaits*_,!0)}function Zt(e){return et.echoes&&e&&e.constructor===M?(Rt(),e.then(function(t){return bt(),t},function(t){return bt(),Ge(t)})):e}function Br(){var e=Wt[Wt.length-1];Wt.pop(),wt(e,!1)}function wt(e,t){var r,a=se;(t?!et.echoes||Jt++&&e===se:!Jt||--Jt&&e===se)||queueMicrotask(t?(function(u){++Qt,et.echoes&&--et.echoes!=0||(et.echoes=et.awaits=et.id=0),Wt.push(se),wt(u,!0)}).bind(null,e):Br),e!==se&&(se=e,a===ct&&(ct.env=er()),Q&&(r=ct.env.Promise,t=e.env,(a.global||e.global)&&(Object.defineProperty(C,"Promise",t.PromiseProp),r.all=t.all,r.race=t.race,r.resolve=t.resolve,r.reject=t.reject,t.allSettled&&(r.allSettled=t.allSettled),t.any&&(r.any=t.any))))}function er(){var e=C.Promise;return Q?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(C,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Ct(e,t,r,a,u){var l=se;try{return wt(e,!0),t(r,a,u)}finally{wt(l,!1)}}function tr(e,t,r,a){return typeof e!="function"?e:function(){var u=se;r&&Rt(),wt(t,!0);try{return e.apply(this,arguments)}finally{wt(u,!1),a&&queueMicrotask(bt)}}}function En(e){Promise===M&&et.echoes===0?Jt===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+ut).indexOf("[native code]")===-1&&(Rt=bt=ie);var Ge=re.reject,St=String.fromCharCode(65535),pt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",nr="String expected.",Ot=[],en="__dbnames",Tn="readonly",Cn="readwrite";function xt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var rr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function tn(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=$(t))[e],t}}function ir(){throw oe.Type()}function je(e,t){try{var r=or(e),a=or(t);if(r!==a)return r==="Array"?1:a==="Array"?-1:r==="binary"?1:a==="binary"?-1:r==="string"?1:a==="string"?-1:r==="Date"?1:a!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(u,l){for(var v=u.length,w=l.length,x=v<w?v:w,T=0;T<x;++T)if(u[T]!==l[T])return u[T]<l[T]?-1:1;return v===w?0:v<w?-1:1}(ar(e),ar(t));case"Array":return function(u,l){for(var v=u.length,w=l.length,x=v<w?v:w,T=0;T<x;++T){var R=je(u[T],l[T]);if(R!==0)return R}return v===w?0:v<w?-1:1}(e,t)}}catch{}return NaN}function or(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=G(e),e==="ArrayBuffer"?"binary":e)}function ar(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var sr=(Ke.prototype._trans=function(e,t,r){var a=this._tx||se.trans,u=this.name,l=n&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function v(T,R,E){if(!E.schema[u])throw new oe.NotFound("Table "+u+" not part of transaction");return t(E.idbtrans,E)}var w=Pt();try{var x=a&&a.db._novip===this.db._novip?a===se.trans?a._promise(e,v,r):vt(function(){return a._promise(e,v,r)},{trans:a,transless:se.transless||se}):function T(R,E,O,S){if(R.idbdb&&(R._state.openComplete||se.letThrough||R._vip)){var I=R._createTransaction(E,O,R._dbSchema);try{I.create(),R._state.PR1398_maxLoop=3}catch(N){return N.name===Fe.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return T(R,E,O,S)})):Ge(N)}return I._promise(E,function(N,P){return vt(function(){return se.trans=I,S(N,P,I)})}).then(function(N){if(E==="readwrite")try{I.idbtrans.commit()}catch{}return E==="readonly"?N:I._completion.then(function(){return N})})}if(R._state.openComplete)return Ge(new oe.DatabaseClosed(R._state.dbOpenError));if(!R._state.isBeingOpened){if(!R._state.autoOpen)return Ge(new oe.DatabaseClosed);R.open().catch(ie)}return R._state.dbReadyPromise.then(function(){return T(R,E,O,S)})}(this.db,e,[this.name],v);return l&&(x._consoleTask=l,x=x.catch(function(T){return console.trace(T),Ge(T)})),x}finally{w&&Bt()}},Ke.prototype.get=function(e,t){var r=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?Ge(new oe.Type("Invalid argument to Table.get()")):this._trans("readonly",function(a){return r.core.get({trans:a,key:e}).then(function(u){return r.hook.reading.fire(u)})}).then(t)},Ke.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(B(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=L(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(x){if(x.compound&&t.every(function(R){return 0<=x.keyPath.indexOf(R)})){for(var T=0;T<t.length;++T)if(t.indexOf(x.keyPath[T])===-1)return!1;return!0}return!1}).sort(function(x,T){return x.keyPath.length-T.keyPath.length})[0];if(r&&this.db._maxKey!==St){var v=r.keyPath.slice(0,t.length);return this.where(v).equals(v.map(function(T){return e[T]}))}!r&&n&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var a=this.schema.idxByName,u=this.db._deps.indexedDB;function l(x,T){return u.cmp(x,T)===0}var w=t.reduce(function(O,T){var R=O[0],E=O[1],O=a[T],S=e[T];return[R||O,R||!O?xt(E,O&&O.multi?function(I){return I=Ie(I,T),B(I)&&I.some(function(N){return l(S,N)})}:function(I){return l(S,Ie(I,T))}):E]},[null,null]),v=w[0],w=w[1];return v?this.where(v.name).equals(e[v.keyPath]).filter(w):r?this.filter(w):this.where(t).equals("")},Ke.prototype.filter=function(e){return this.toCollection().and(e)},Ke.prototype.count=function(e){return this.toCollection().count(e)},Ke.prototype.offset=function(e){return this.toCollection().offset(e)},Ke.prototype.limit=function(e){return this.toCollection().limit(e)},Ke.prototype.each=function(e){return this.toCollection().each(e)},Ke.prototype.toArray=function(e){return this.toCollection().toArray(e)},Ke.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Ke.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,B(e)?"[".concat(e.join("+"),"]"):e))},Ke.prototype.reverse=function(){return this.toCollection().reverse()},Ke.prototype.mapToClass=function(e){var t,r=this.db,a=this.name;function u(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof ir&&(function(x,T){if(typeof T!="function"&&T!==null)throw new TypeError("Class extends value "+String(T)+" is not a constructor or null");function R(){this.constructor=x}b(x,T),x.prototype=T===null?Object.create(T):(R.prototype=T.prototype,new R)}(u,t=e),Object.defineProperty(u.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),u.prototype.table=function(){return a},e=u);for(var l=new Set,v=e.prototype;v;v=m(v))Object.getOwnPropertyNames(v).forEach(function(x){return l.add(x)});function w(x){if(!x)return x;var T,R=Object.create(e.prototype);for(T in x)if(!l.has(T))try{R[T]=x[T]}catch{}return R}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=w,this.hook("reading",w),e},Ke.prototype.defineClass=function(){return this.mapToClass(function(e){h(this,e)})},Ke.prototype.add=function(e,t){var r=this,a=this.schema.primKey,u=a.auto,l=a.keyPath,v=e;return l&&u&&(v=tn(l)(e)),this._trans("readwrite",function(w){return r.core.mutate({trans:w,type:"add",keys:t!=null?[t]:null,values:[v]})}).then(function(w){return w.numFailures?re.reject(w.failures[0]):w.lastResult}).then(function(w){if(l)try{Ee(e,l,w)}catch{}return w})},Ke.prototype.update=function(e,t){return typeof e!="object"||B(e)?this.where(":id").equals(e).modify(t):(e=Ie(e,this.schema.primKey.keyPath),e===void 0?Ge(new oe.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},Ke.prototype.put=function(e,t){var r=this,a=this.schema.primKey,u=a.auto,l=a.keyPath,v=e;return l&&u&&(v=tn(l)(e)),this._trans("readwrite",function(w){return r.core.mutate({trans:w,type:"put",values:[v],keys:t!=null?[t]:null})}).then(function(w){return w.numFailures?re.reject(w.failures[0]):w.lastResult}).then(function(w){if(l)try{Ee(e,l,w)}catch{}return w})},Ke.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:[e]})}).then(function(r){return r.numFailures?re.reject(r.failures[0]):void 0})},Ke.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:rr})}).then(function(t){return t.numFailures?re.reject(t.failures[0]):void 0})},Ke.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(r){return t.core.getMany({keys:e,trans:r}).then(function(a){return a.map(function(u){return t.hook.reading.fire(u)})})})},Ke.prototype.bulkAdd=function(e,t,r){var a=this,u=Array.isArray(t)?t:void 0,l=(r=r||(u?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(v){var T=a.schema.primKey,w=T.auto,T=T.keyPath;if(T&&u)throw new oe.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(u&&u.length!==e.length)throw new oe.InvalidArgument("Arguments objects and keys must have the same length");var x=e.length,T=T&&w?e.map(tn(T)):e;return a.core.mutate({trans:v,type:"add",keys:u,values:T,wantResults:l}).then(function(I){var E=I.numFailures,O=I.results,S=I.lastResult,I=I.failures;if(E===0)return l?O:S;throw new He("".concat(a.name,".bulkAdd(): ").concat(E," of ").concat(x," operations failed"),I)})})},Ke.prototype.bulkPut=function(e,t,r){var a=this,u=Array.isArray(t)?t:void 0,l=(r=r||(u?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(v){var T=a.schema.primKey,w=T.auto,T=T.keyPath;if(T&&u)throw new oe.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(u&&u.length!==e.length)throw new oe.InvalidArgument("Arguments objects and keys must have the same length");var x=e.length,T=T&&w?e.map(tn(T)):e;return a.core.mutate({trans:v,type:"put",keys:u,values:T,wantResults:l}).then(function(I){var E=I.numFailures,O=I.results,S=I.lastResult,I=I.failures;if(E===0)return l?O:S;throw new He("".concat(a.name,".bulkPut(): ").concat(E," of ").concat(x," operations failed"),I)})})},Ke.prototype.bulkUpdate=function(e){var t=this,r=this.core,a=e.map(function(v){return v.key}),u=e.map(function(v){return v.changes}),l=[];return this._trans("readwrite",function(v){return r.getMany({trans:v,keys:a,cache:"clone"}).then(function(w){var x=[],T=[];e.forEach(function(E,O){var S=E.key,I=E.changes,N=w[O];if(N){for(var P=0,U=Object.keys(I);P<U.length;P++){var F=U[P],q=I[F];if(F===t.schema.primKey.keyPath){if(je(q,S)!==0)throw new oe.Constraint("Cannot update primary key in bulkUpdate()")}else Ee(N,F,q)}l.push(O),x.push(S),T.push(N)}});var R=x.length;return r.mutate({trans:v,type:"put",keys:x,values:T,updates:{keys:a,changeSpecs:u}}).then(function(E){var O=E.numFailures,S=E.failures;if(O===0)return R;for(var I=0,N=Object.keys(S);I<N.length;I++){var P,U=N[I],F=l[Number(U)];F!=null&&(P=S[U],delete S[U],S[F]=P)}throw new He("".concat(t.name,".bulkUpdate(): ").concat(O," of ").concat(R," operations failed"),S)})})})},Ke.prototype.bulkDelete=function(e){var t=this,r=e.length;return this._trans("readwrite",function(a){return t.core.mutate({trans:a,type:"delete",keys:e})}).then(function(v){var u=v.numFailures,l=v.lastResult,v=v.failures;if(u===0)return l;throw new He("".concat(t.name,".bulkDelete(): ").concat(u," of ").concat(r," operations failed"),v)})},Ke);function Ke(){}function Mt(e){function t(v,w){if(w){for(var x=arguments.length,T=new Array(x-1);--x;)T[x-1]=arguments[x];return r[v].subscribe.apply(null,T),e}if(typeof v=="string")return r[v]}var r={};t.addEventType=l;for(var a=1,u=arguments.length;a<u;++a)l(arguments[a]);return t;function l(v,w,x){if(typeof v!="object"){var T;w=w||f;var R={subscribers:[],fire:x=x||ie,subscribe:function(E){R.subscribers.indexOf(E)===-1&&(R.subscribers.push(E),R.fire=w(R.fire,E))},unsubscribe:function(E){R.subscribers=R.subscribers.filter(function(O){return O!==E}),R.fire=R.subscribers.reduce(w,x)}};return r[v]=t[v]=R}L(T=v).forEach(function(E){var O=T[E];if(B(O))l(E,T[E][0],T[E][1]);else{if(O!=="asap")throw new oe.InvalidArgument("Invalid event config");var S=l(E,he,function(){for(var I=arguments.length,N=new Array(I);I--;)N[I]=arguments[I];S.subscribers.forEach(function(P){De(function(){P.apply(null,N)})})})}})}}function Ft(e,t){return ye(t).from({prototype:e}),t}function Nt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Sn(e,t){e.filter=xt(e.filter,t)}function xn(e,t,r){var a=e.replayFilter;e.replayFilter=a?function(){return xt(a(),t())}:t,e.justLimit=r&&!a}function nn(e,t){if(e.isPrimKey)return t.primaryKey;var r=t.getIndexByKeyPath(e.index);if(!r)throw new oe.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function ur(e,t,r){var a=nn(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:a,range:e.range}})}function rn(e,t,r,a){var u=e.replayFilter?xt(e.filter,e.replayFilter()):e.filter;if(e.or){var l={},v=function(w,x,T){var R,E;u&&!u(x,T,function(O){return x.stop(O)},function(O){return x.fail(O)})||((E=""+(R=x.primaryKey))=="[object ArrayBuffer]"&&(E=""+new Uint8Array(R)),D(l,E)||(l[E]=!0,t(w,x,T)))};return Promise.all([e.or._iterate(v,r),cr(ur(e,a,r),e.algorithm,v,!e.keysOnly&&e.valueMapper)])}return cr(ur(e,a,r),xt(e.algorithm,u),t,!e.keysOnly&&e.valueMapper)}function cr(e,t,r,a){var u=ze(a?function(l,v,w){return r(a(l),v,w)}:r);return e.then(function(l){if(l)return l.start(function(){var v=function(){return l.continue()};t&&!t(l,function(w){return v=w},function(w){l.stop(w),v=ie},function(w){l.fail(w),v=ie})||u(l.value,l,function(w){return v=w}),v()})})}var mt=Symbol(),qt=(lr.prototype.execute=function(e){if(this.add!==void 0){var t=this.add;if(B(t))return k(k([],B(e)?e:[],!0),t,!0).sort();if(typeof t=="number")return(Number(e)||0)+t;if(typeof t=="bigint")try{return BigInt(e)+t}catch{return BigInt(0)+t}throw new TypeError("Invalid term ".concat(t))}if(this.remove!==void 0){var r=this.remove;if(B(r))return B(e)?e.filter(function(a){return!r.includes(a)}).sort():[];if(typeof r=="number")return Number(e)-r;if(typeof r=="bigint")try{return BigInt(e)-r}catch{return BigInt(0)-r}throw new TypeError("Invalid subtrahend ".concat(r))}return t=(t=this.replacePrefix)===null||t===void 0?void 0:t[0],t&&typeof e=="string"&&e.startsWith(t)?this.replacePrefix[1]+e.substring(t.length):e},lr);function lr(e){Object.assign(this,e)}var Rr=(Ne.prototype._read=function(e,t){var r=this._ctx;return r.error?r.table._trans(null,Ge.bind(null,r.error)):r.table._trans("readonly",e).then(t)},Ne.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,Ge.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},Ne.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=xt(t.algorithm,e)},Ne.prototype._iterate=function(e,t){return rn(this._ctx,e,t,this._ctx.table.core)},Ne.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&h(r,e),t._ctx=r,t},Ne.prototype.raw=function(){return this._ctx.valueMapper=null,this},Ne.prototype.each=function(e){var t=this._ctx;return this._read(function(r){return rn(t,e,r,t.table.core)})},Ne.prototype.count=function(e){var t=this;return this._read(function(r){var a=t._ctx,u=a.table.core;if(Nt(a,!0))return u.count({trans:r,query:{index:nn(a,u.schema),range:a.range}}).then(function(v){return Math.min(v,a.limit)});var l=0;return rn(a,function(){return++l,!1},r,u).then(function(){return l})}).then(e)},Ne.prototype.sortBy=function(e,t){var r=e.split(".").reverse(),a=r[0],u=r.length-1;function l(x,T){return T?l(x[r[T]],T-1):x[a]}var v=this._ctx.dir==="next"?1:-1;function w(x,T){return x=l(x,u),T=l(T,u),x<T?-v:T<x?v:0}return this.toArray(function(x){return x.sort(w)}).then(t)},Ne.prototype.toArray=function(e){var t=this;return this._read(function(r){var a=t._ctx;if(a.dir==="next"&&Nt(a,!0)&&0<a.limit){var u=a.valueMapper,l=nn(a,a.table.core.schema);return a.table.core.query({trans:r,limit:a.limit,values:!0,query:{index:l,range:a.range}}).then(function(w){return w=w.result,u?w.map(u):w})}var v=[];return rn(a,function(w){return v.push(w)},r,a.table.core).then(function(){return v})},e)},Ne.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Nt(t)?xn(t,function(){var r=e;return function(a,u){return r===0||(r===1?--r:u(function(){a.advance(r),r=0}),!1)}}):xn(t,function(){var r=e;return function(){return--r<0}})),this},Ne.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),xn(this._ctx,function(){var t=e;return function(r,a,u){return--t<=0&&a(u),0<=t}},!0),this},Ne.prototype.until=function(e,t){return Sn(this._ctx,function(r,a,u){return!e(r.value)||(a(u),t)}),this},Ne.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},Ne.prototype.last=function(e){return this.reverse().first(e)},Ne.prototype.filter=function(e){var t;return Sn(this._ctx,function(r){return e(r.value)}),(t=this._ctx).isMatch=xt(t.isMatch,e),this},Ne.prototype.and=function(e){return this.filter(e)},Ne.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},Ne.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Ne.prototype.desc=function(){return this.reverse()},Ne.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,a){e(a.key,a)})},Ne.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},Ne.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,a){e(a.primaryKey,a)})},Ne.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var r=[];return this.each(function(a,u){r.push(u.key)}).then(function(){return r}).then(e)},Ne.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&Nt(t,!0)&&0<t.limit)return this._read(function(a){var u=nn(t,t.table.core.schema);return t.table.core.query({trans:a,values:!1,limit:t.limit,query:{index:u,range:t.range}})}).then(function(a){return a.result}).then(e);t.keysOnly=!t.isMatch;var r=[];return this.each(function(a,u){r.push(u.primaryKey)}).then(function(){return r}).then(e)},Ne.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},Ne.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},Ne.prototype.lastKey=function(e){return this.reverse().firstKey(e)},Ne.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return Sn(this._ctx,function(u){var a=u.primaryKey.toString(),u=D(t,a);return t[a]=!0,!u}),this},Ne.prototype.modify=function(e){var t=this,r=this._ctx;return this._write(function(a){var u,l,v;v=typeof e=="function"?e:(u=L(e),l=u.length,function(P){for(var U=!1,F=0;F<l;++F){var q=u[F],V=e[q],z=Ie(P,q);V instanceof qt?(Ee(P,q,V.execute(z)),U=!0):z!==V&&(Ee(P,q,V),U=!0)}return U});function w(P,q){var F=q.failures,q=q.numFailures;I+=P-q;for(var V=0,z=L(F);V<z.length;V++){var ee=z[V];S.push(F[ee])}}var x=r.table.core,T=x.schema.primaryKey,R=T.outbound,E=T.extractKey,O=t.db._options.modifyChunkSize||200,S=[],I=0,N=[];return t.clone().primaryKeys().then(function(P){function U(q){var V=Math.min(O,P.length-q);return x.getMany({trans:a,keys:P.slice(q,q+V),cache:"immutable"}).then(function(z){for(var ee=[],H=[],Z=R?[]:null,ne=[],J=0;J<V;++J){var ke=z[J],_e={value:$(ke),primKey:P[q+J]};v.call(_e,_e.value,_e)!==!1&&(_e.value==null?ne.push(P[q+J]):R||je(E(ke),E(_e.value))===0?(H.push(_e.value),R&&Z.push(P[q+J])):(ne.push(P[q+J]),ee.push(_e.value)))}return Promise.resolve(0<ee.length&&x.mutate({trans:a,type:"add",values:ee}).then(function(xe){for(var Te in xe.failures)ne.splice(parseInt(Te),1);w(ee.length,xe)})).then(function(){return(0<H.length||F&&typeof e=="object")&&x.mutate({trans:a,type:"put",keys:Z,values:H,criteria:F,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<q}).then(function(xe){return w(H.length,xe)})}).then(function(){return(0<ne.length||F&&e===Dn)&&x.mutate({trans:a,type:"delete",keys:ne,criteria:F,isAdditionalChunk:0<q}).then(function(xe){return w(ne.length,xe)})}).then(function(){return P.length>q+V&&U(q+O)})})}var F=Nt(r)&&r.limit===1/0&&(typeof e!="function"||e===Dn)&&{index:r.index,range:r.range};return U(0).then(function(){if(0<S.length)throw new ve("Error modifying one or more objects",S,I,N);return P.length})})})},Ne.prototype.delete=function(){var e=this._ctx,t=e.range;return Nt(e)&&(e.isPrimKey||t.type===3)?this._write(function(r){var a=e.table.core.schema.primaryKey,u=t;return e.table.core.count({trans:r,query:{index:a,range:u}}).then(function(l){return e.table.core.mutate({trans:r,type:"deleteRange",range:u}).then(function(v){var w=v.failures;if(v.lastResult,v.results,v=v.numFailures,v)throw new ve("Could not delete some values",Object.keys(w).map(function(x){return w[x]}),l-v);return l-v})})}):this.modify(Dn)},Ne);function Ne(){}var Dn=function(e,t){return t.value=null};function Or(e,t){return e<t?-1:e===t?0:1}function Nr(e,t){return t<e?-1:e===t?0:1}function st(e,t,r){return e=e instanceof hr?new e.Collection(e):e,e._ctx.error=new(r||TypeError)(t),e}function Lt(e){return new e.Collection(e,function(){return fr("")}).limit(0)}function on(e,t,r,a){var u,l,v,w,x,T,R,E=r.length;if(!r.every(function(I){return typeof I=="string"}))return st(e,nr);function O(I){u=I==="next"?function(P){return P.toUpperCase()}:function(P){return P.toLowerCase()},l=I==="next"?function(P){return P.toLowerCase()}:function(P){return P.toUpperCase()},v=I==="next"?Or:Nr;var N=r.map(function(P){return{lower:l(P),upper:u(P)}}).sort(function(P,U){return v(P.lower,U.lower)});w=N.map(function(P){return P.upper}),x=N.map(function(P){return P.lower}),R=(T=I)==="next"?"":a}O("next"),e=new e.Collection(e,function(){return kt(w[0],x[E-1]+a)}),e._ondirectionchange=function(I){O(I)};var S=0;return e._addAlgorithm(function(I,N,P){var U=I.key;if(typeof U!="string")return!1;var F=l(U);if(t(F,x,S))return!0;for(var q=null,V=S;V<E;++V){var z=function(ee,H,Z,ne,J,ke){for(var _e=Math.min(ee.length,ne.length),xe=-1,Te=0;Te<_e;++Te){var lt=H[Te];if(lt!==ne[Te])return J(ee[Te],Z[Te])<0?ee.substr(0,Te)+Z[Te]+Z.substr(Te+1):J(ee[Te],ne[Te])<0?ee.substr(0,Te)+ne[Te]+Z.substr(Te+1):0<=xe?ee.substr(0,xe)+H[xe]+Z.substr(xe+1):null;J(ee[Te],lt)<0&&(xe=Te)}return _e<ne.length&&ke==="next"?ee+Z.substr(ee.length):_e<ee.length&&ke==="prev"?ee.substr(0,Z.length):xe<0?null:ee.substr(0,xe)+ne[xe]+Z.substr(xe+1)}(U,F,w[V],x[V],v,T);z===null&&q===null?S=V+1:(q===null||0<v(q,z))&&(q=z)}return N(q!==null?function(){I.continue(q+R)}:P),!1}),e}function kt(e,t,r,a){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:a}}function fr(e){return{type:1,lower:e,upper:e}}var hr=(Object.defineProperty(tt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),tt.prototype.between=function(e,t,r,a){r=r!==!1,a=a===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(r||a)&&(!r||!a)?Lt(this):new this.Collection(this,function(){return kt(e,t,!r,!a)})}catch{return st(this,pt)}},tt.prototype.equals=function(e){return e==null?st(this,pt):new this.Collection(this,function(){return fr(e)})},tt.prototype.above=function(e){return e==null?st(this,pt):new this.Collection(this,function(){return kt(e,void 0,!0)})},tt.prototype.aboveOrEqual=function(e){return e==null?st(this,pt):new this.Collection(this,function(){return kt(e,void 0,!1)})},tt.prototype.below=function(e){return e==null?st(this,pt):new this.Collection(this,function(){return kt(void 0,e,!1,!0)})},tt.prototype.belowOrEqual=function(e){return e==null?st(this,pt):new this.Collection(this,function(){return kt(void 0,e)})},tt.prototype.startsWith=function(e){return typeof e!="string"?st(this,nr):this.between(e,e+St,!0,!0)},tt.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):on(this,function(t,r){return t.indexOf(r[0])===0},[e],St)},tt.prototype.equalsIgnoreCase=function(e){return on(this,function(t,r){return t===r[0]},[e],"")},tt.prototype.anyOfIgnoreCase=function(){var e=Re.apply(Be,arguments);return e.length===0?Lt(this):on(this,function(t,r){return r.indexOf(t)!==-1},e,"")},tt.prototype.startsWithAnyOfIgnoreCase=function(){var e=Re.apply(Be,arguments);return e.length===0?Lt(this):on(this,function(t,r){return r.some(function(a){return t.indexOf(a)===0})},e,St)},tt.prototype.anyOf=function(){var e=this,t=Re.apply(Be,arguments),r=this._cmp;try{t.sort(r)}catch{return st(this,pt)}if(t.length===0)return Lt(this);var a=new this.Collection(this,function(){return kt(t[0],t[t.length-1])});a._ondirectionchange=function(l){r=l==="next"?e._ascending:e._descending,t.sort(r)};var u=0;return a._addAlgorithm(function(l,v,w){for(var x=l.key;0<r(x,t[u]);)if(++u===t.length)return v(w),!1;return r(x,t[u])===0||(v(function(){l.continue(t[u])}),!1)}),a},tt.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},tt.prototype.noneOf=function(){var e=Re.apply(Be,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return st(this,pt)}var t=e.reduce(function(r,a){return r?r.concat([[r[r.length-1][1],a]]):[[-1/0,a]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},tt.prototype.inAnyRange=function(U,t){var r=this,a=this._cmp,u=this._ascending,l=this._descending,v=this._min,w=this._max;if(U.length===0)return Lt(this);if(!U.every(function(F){return F[0]!==void 0&&F[1]!==void 0&&u(F[0],F[1])<=0}))return st(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",oe.InvalidArgument);var x=!t||t.includeLowers!==!1,T=t&&t.includeUppers===!0,R,E=u;function O(F,q){return E(F[0],q[0])}try{(R=U.reduce(function(F,q){for(var V=0,z=F.length;V<z;++V){var ee=F[V];if(a(q[0],ee[1])<0&&0<a(q[1],ee[0])){ee[0]=v(ee[0],q[0]),ee[1]=w(ee[1],q[1]);break}}return V===z&&F.push(q),F},[])).sort(O)}catch{return st(this,pt)}var S=0,I=T?function(F){return 0<u(F,R[S][1])}:function(F){return 0<=u(F,R[S][1])},N=x?function(F){return 0<l(F,R[S][0])}:function(F){return 0<=l(F,R[S][0])},P=I,U=new this.Collection(this,function(){return kt(R[0][0],R[R.length-1][1],!x,!T)});return U._ondirectionchange=function(F){E=F==="next"?(P=I,u):(P=N,l),R.sort(O)},U._addAlgorithm(function(F,q,V){for(var z,ee=F.key;P(ee);)if(++S===R.length)return q(V),!1;return!I(z=ee)&&!N(z)||(r._cmp(ee,R[S][1])===0||r._cmp(ee,R[S][0])===0||q(function(){E===u?F.continue(R[S][0]):F.continue(R[S][1])}),!1)}),U},tt.prototype.startsWithAnyOf=function(){var e=Re.apply(Be,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?Lt(this):this.inAnyRange(e.map(function(t){return[t,t+St]})):st(this,"startsWithAnyOf() only works with strings")},tt);function tt(){}function ft(e){return ze(function(t){return Vt(t),e(t.target.error),!1})}function Vt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Kt="storagemutated",An="x-storagemutated-1",_t=Mt(null,Kt),Lr=(ht.prototype._lock=function(){return Me(!se.global),++this._reculock,this._reculock!==1||se.global||(se.lockOwnerFor=this),this},ht.prototype._unlock=function(){if(Me(!se.global),--this._reculock==0)for(se.global||(se.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{Ct(e[1],e[0])}catch{}}return this},ht.prototype._locked=function(){return this._reculock&&se.lockOwnerFor!==this},ht.prototype.create=function(e){var t=this;if(!this.mode)return this;var r=this.db.idbdb,a=this.db._state.dbOpenError;if(Me(!this.idbtrans),!e&&!r)switch(a&&a.name){case"DatabaseClosedError":throw new oe.DatabaseClosed(a);case"MissingAPIError":throw new oe.MissingAPI(a.message,a);default:throw new oe.OpenFailed(a)}if(!this.active)throw new oe.TransactionInactive;return Me(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||r).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=ze(function(u){Vt(u),t._reject(e.error)}),e.onabort=ze(function(u){Vt(u),t.active&&t._reject(new oe.Abort(e.error)),t.active=!1,t.on("abort").fire(u)}),e.oncomplete=ze(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&_t.storagemutated.fire(e.mutatedParts)}),this},ht.prototype._promise=function(e,t,r){var a=this;if(e==="readwrite"&&this.mode!=="readwrite")return Ge(new oe.ReadOnly("Transaction is readonly"));if(!this.active)return Ge(new oe.TransactionInactive);if(this._locked())return new re(function(l,v){a._blockedFuncs.push([function(){a._promise(e,t,r).then(l,v)},se])});if(r)return vt(function(){var l=new re(function(v,w){a._lock();var x=t(v,w,a);x&&x.then&&x.then(v,w)});return l.finally(function(){return a._unlock()}),l._lib=!0,l});var u=new re(function(l,v){var w=t(l,v,a);w&&w.then&&w.then(l,v)});return u._lib=!0,u},ht.prototype._root=function(){return this.parent?this.parent._root():this},ht.prototype.waitFor=function(e){var t,r=this._root(),a=re.resolve(e);r._waitingFor?r._waitingFor=r._waitingFor.then(function(){return a}):(r._waitingFor=a,r._waitingQueue=[],t=r.idbtrans.objectStore(r.storeNames[0]),function l(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(t.get(-1/0).onsuccess=l)}());var u=r._waitingFor;return new re(function(l,v){a.then(function(w){return r._waitingQueue.push(ze(l.bind(null,w)))},function(w){return r._waitingQueue.push(ze(v.bind(null,w)))}).finally(function(){r._waitingFor===u&&(r._waitingFor=null)})})},ht.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new oe.Abort))},ht.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(D(t,e))return t[e];var r=this.schema[e];if(!r)throw new oe.NotFound("Table "+e+" not part of transaction");return r=new this.db.Table(e,r,this),r.core=this.db.core.table(e),t[e]=r},ht);function ht(){}function In(e,t,r,a,u,l,v){return{name:e,keyPath:t,unique:r,multi:a,auto:u,compound:l,src:(r&&!v?"&":"")+(a?"*":"")+(u?"++":"")+pr(t)}}function pr(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Pn(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:(a=function(u){return[u.name,u]},r.reduce(function(u,l,v){return v=a(l,v),v&&(u[v[0]]=v[1]),u},{}))};var a}var $t=function(e){try{return e.only([[]]),$t=function(){return[[]]},[[]]}catch{return $t=function(){return St},St}};function Bn(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(r){return r[t]}:function(r){return Ie(r,t)}:function(r){return Ie(r,e)};var t}function dr(e){return[].slice.call(e)}var jr=0;function zt(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Ur(e,t,x){function a(P){if(P.type===3)return null;if(P.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var S=P.lower,I=P.upper,N=P.lowerOpen,P=P.upperOpen;return S===void 0?I===void 0?null:t.upperBound(I,!!P):I===void 0?t.lowerBound(S,!!N):t.bound(S,I,!!N,!!P)}function u(O){var S,I=O.name;return{name:I,schema:O,mutate:function(N){var P=N.trans,U=N.type,F=N.keys,q=N.values,V=N.range;return new Promise(function(z,ee){z=ze(z);var H=P.objectStore(I),Z=H.keyPath==null,ne=U==="put"||U==="add";if(!ne&&U!=="delete"&&U!=="deleteRange")throw new Error("Invalid operation type: "+U);var J,ke=(F||q||{length:1}).length;if(F&&q&&F.length!==q.length)throw new Error("Given keys array must have same length as given values array.");if(ke===0)return z({numFailures:0,failures:{},results:[],lastResult:void 0});function _e(at){++lt,Vt(at)}var xe=[],Te=[],lt=0;if(U==="deleteRange"){if(V.type===4)return z({numFailures:lt,failures:Te,results:[],lastResult:void 0});V.type===3?xe.push(J=H.clear()):xe.push(J=H.delete(a(V)))}else{var Z=ne?Z?[q,F]:[q,null]:[F,null],Ce=Z[0],it=Z[1];if(ne)for(var ot=0;ot<ke;++ot)xe.push(J=it&&it[ot]!==void 0?H[U](Ce[ot],it[ot]):H[U](Ce[ot])),J.onerror=_e;else for(ot=0;ot<ke;++ot)xe.push(J=H[U](Ce[ot])),J.onerror=_e}function vn(at){at=at.target.result,xe.forEach(function(It,Jn){return It.error!=null&&(Te[Jn]=It.error)}),z({numFailures:lt,failures:Te,results:U==="delete"?F:xe.map(function(It){return It.result}),lastResult:at})}J.onerror=function(at){_e(at),vn(at)},J.onsuccess=vn})},getMany:function(N){var P=N.trans,U=N.keys;return new Promise(function(F,q){F=ze(F);for(var V,z=P.objectStore(I),ee=U.length,H=new Array(ee),Z=0,ne=0,J=function(xe){xe=xe.target,H[xe._pos]=xe.result,++ne===Z&&F(H)},ke=ft(q),_e=0;_e<ee;++_e)U[_e]!=null&&((V=z.get(U[_e]))._pos=_e,V.onsuccess=J,V.onerror=ke,++Z);Z===0&&F(H)})},get:function(N){var P=N.trans,U=N.key;return new Promise(function(F,q){F=ze(F);var V=P.objectStore(I).get(U);V.onsuccess=function(z){return F(z.target.result)},V.onerror=ft(q)})},query:(S=T,function(N){return new Promise(function(P,U){P=ze(P);var F,q,V,Z=N.trans,z=N.values,ee=N.limit,J=N.query,H=ee===1/0?void 0:ee,ne=J.index,J=J.range,Z=Z.objectStore(I),ne=ne.isPrimaryKey?Z:Z.index(ne.name),J=a(J);if(ee===0)return P({result:[]});S?((H=z?ne.getAll(J,H):ne.getAllKeys(J,H)).onsuccess=function(ke){return P({result:ke.target.result})},H.onerror=ft(U)):(F=0,q=!z&&"openKeyCursor"in ne?ne.openKeyCursor(J):ne.openCursor(J),V=[],q.onsuccess=function(ke){var _e=q.result;return _e?(V.push(z?_e.value:_e.primaryKey),++F===ee?P({result:V}):void _e.continue()):P({result:V})},q.onerror=ft(U))})}),openCursor:function(N){var P=N.trans,U=N.values,F=N.query,q=N.reverse,V=N.unique;return new Promise(function(z,ee){z=ze(z);var ne=F.index,H=F.range,Z=P.objectStore(I),Z=ne.isPrimaryKey?Z:Z.index(ne.name),ne=q?V?"prevunique":"prev":V?"nextunique":"next",J=!U&&"openKeyCursor"in Z?Z.openKeyCursor(a(H),ne):Z.openCursor(a(H),ne);J.onerror=ft(ee),J.onsuccess=ze(function(ke){var _e,xe,Te,lt,Ce=J.result;Ce?(Ce.___id=++jr,Ce.done=!1,_e=Ce.continue.bind(Ce),xe=(xe=Ce.continuePrimaryKey)&&xe.bind(Ce),Te=Ce.advance.bind(Ce),lt=function(){throw new Error("Cursor not stopped")},Ce.trans=P,Ce.stop=Ce.continue=Ce.continuePrimaryKey=Ce.advance=function(){throw new Error("Cursor not started")},Ce.fail=ze(ee),Ce.next=function(){var it=this,ot=1;return this.start(function(){return ot--?it.continue():it.stop()}).then(function(){return it})},Ce.start=function(it){function ot(){if(J.result)try{it()}catch(at){Ce.fail(at)}else Ce.done=!0,Ce.start=function(){throw new Error("Cursor behind last entry")},Ce.stop()}var vn=new Promise(function(at,It){at=ze(at),J.onerror=ft(It),Ce.fail=It,Ce.stop=function(Jn){Ce.stop=Ce.continue=Ce.continuePrimaryKey=Ce.advance=lt,at(Jn)}});return J.onsuccess=ze(function(at){J.onsuccess=ot,ot()}),Ce.continue=_e,Ce.continuePrimaryKey=xe,Ce.advance=Te,ot(),vn},z(Ce)):z(null)},ee)})},count:function(N){var P=N.query,U=N.trans,F=P.index,q=P.range;return new Promise(function(V,z){var ee=U.objectStore(I),H=F.isPrimaryKey?ee:ee.index(F.name),ee=a(q),H=ee?H.count(ee):H.count();H.onsuccess=ze(function(Z){return V(Z.target.result)}),H.onerror=ft(z)})}}}var l,v,w,R=(v=x,w=dr((l=e).objectStoreNames),{schema:{name:l.name,tables:w.map(function(O){return v.objectStore(O)}).map(function(O){var S=O.keyPath,P=O.autoIncrement,I=B(S),N={},P={name:O.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:S==null,compound:I,keyPath:S,autoIncrement:P,unique:!0,extractKey:Bn(S)},indexes:dr(O.indexNames).map(function(U){return O.index(U)}).map(function(V){var F=V.name,q=V.unique,z=V.multiEntry,V=V.keyPath,z={name:F,compound:B(V),keyPath:V,unique:q,multiEntry:z,extractKey:Bn(V)};return N[zt(V)]=z}),getIndexByKeyPath:function(U){return N[zt(U)]}};return N[":id"]=P.primaryKey,S!=null&&(N[zt(S)]=P.primaryKey),P})},hasGetAll:0<w.length&&"getAll"in v.objectStore(w[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),x=R.schema,T=R.hasGetAll,R=x.tables.map(u),E={};return R.forEach(function(O){return E[O.name]=O}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(O){if(!E[O])throw new Error("Table '".concat(O,"' not found"));return E[O]},MIN_KEY:-1/0,MAX_KEY:$t(t),schema:x}}function Mr(e,t,r,a){var u=r.IDBKeyRange;return r.indexedDB,{dbcore:(a=Ur(t,u,a),e.dbcore.reduce(function(l,v){return v=v.create,g(g({},l),v(l))},a))}}function an(e,a){var r=a.db,a=Mr(e._middlewares,r,e._deps,a);e.core=a.dbcore,e.tables.forEach(function(u){var l=u.name;e.core.schema.tables.some(function(v){return v.name===l})&&(u.core=e.core.table(l),e[l]instanceof e.Table&&(e[l].core=u.core))})}function sn(e,t,r,a){r.forEach(function(u){var l=a[u];t.forEach(function(v){var w=function x(T,R){return te(T,R)||(T=m(T))&&x(T,R)}(v,u);(!w||"value"in w&&w.value===void 0)&&(v===e.Transaction.prototype||v instanceof e.Transaction?W(v,u,{get:function(){return this.table(u)},set:function(x){Y(this,u,{value:x,writable:!0,configurable:!0,enumerable:!0})}}):v[u]=new e.Table(u,l))})})}function Rn(e,t){t.forEach(function(r){for(var a in r)r[a]instanceof e.Table&&delete r[a]})}function Fr(e,t){return e._cfg.version-t._cfg.version}function qr(e,t,r,a){var u=e._dbSchema;r.objectStoreNames.contains("$meta")&&!u.$meta&&(u.$meta=Pn("$meta",yr("")[0],[]),e._storeNames.push("$meta"));var l=e._createTransaction("readwrite",e._storeNames,u);l.create(r),l._completion.catch(a);var v=l._reject.bind(l),w=se.transless||se;vt(function(){return se.trans=l,se.transless=w,t!==0?(an(e,r),T=t,((x=l).storeNames.includes("$meta")?x.table("$meta").get("version").then(function(R){return R??T}):re.resolve(T)).then(function(R){return O=R,S=l,I=r,N=[],R=(E=e)._versions,P=E._dbSchema=cn(0,E.idbdb,I),(R=R.filter(function(U){return U._cfg.version>=O})).length!==0?(R.forEach(function(U){N.push(function(){var F=P,q=U._cfg.dbschema;ln(E,F,I),ln(E,q,I),P=E._dbSchema=q;var V=On(F,q);V.add.forEach(function(ne){Nn(I,ne[0],ne[1].primKey,ne[1].indexes)}),V.change.forEach(function(ne){if(ne.recreate)throw new oe.Upgrade("Not yet support for changing primary key");var J=I.objectStore(ne.name);ne.add.forEach(function(ke){return un(J,ke)}),ne.change.forEach(function(ke){J.deleteIndex(ke.name),un(J,ke)}),ne.del.forEach(function(ke){return J.deleteIndex(ke)})});var z=U._cfg.contentUpgrade;if(z&&U._cfg.version>O){an(E,I),S._memoizedTables={};var ee=Ye(q);V.del.forEach(function(ne){ee[ne]=F[ne]}),Rn(E,[E.Transaction.prototype]),sn(E,[E.Transaction.prototype],L(ee),ee),S.schema=ee;var H,Z=$e(z);return Z&&Rt(),V=re.follow(function(){var ne;(H=z(S))&&Z&&(ne=bt.bind(null,null),H.then(ne,ne))}),H&&typeof H.then=="function"?re.resolve(H):V.then(function(){return H})}}),N.push(function(F){var q,V,z=U._cfg.dbschema;q=z,V=F,[].slice.call(V.db.objectStoreNames).forEach(function(ee){return q[ee]==null&&V.db.deleteObjectStore(ee)}),Rn(E,[E.Transaction.prototype]),sn(E,[E.Transaction.prototype],E._storeNames,E._dbSchema),S.schema=E._dbSchema}),N.push(function(F){E.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(E.idbdb.version/10)===U._cfg.version?(E.idbdb.deleteObjectStore("$meta"),delete E._dbSchema.$meta,E._storeNames=E._storeNames.filter(function(q){return q!=="$meta"})):F.objectStore("$meta").put(U._cfg.version,"version"))})}),function U(){return N.length?re.resolve(N.shift()(S.idbtrans)).then(U):re.resolve()}().then(function(){mr(P,I)})):re.resolve();var E,O,S,I,N,P}).catch(v)):(L(u).forEach(function(R){Nn(r,R,u[R].primKey,u[R].indexes)}),an(e,r),void re.follow(function(){return e.on.populate.fire(l)}).catch(v));var x,T})}function Vr(e,t){mr(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var r=cn(0,e.idbdb,t);ln(e,e._dbSchema,t);for(var a=0,u=On(r,e._dbSchema).change;a<u.length;a++){var l=function(v){if(v.change.length||v.recreate)return console.warn("Unable to patch indexes of table ".concat(v.name," because it has changes on the type of index or primary key.")),{value:void 0};var w=t.objectStore(v.name);v.add.forEach(function(x){n&&console.debug("Dexie upgrade patch: Creating missing index ".concat(v.name,".").concat(x.src)),un(w,x)})}(u[a]);if(typeof l=="object")return l.value}}function On(e,t){var r,a={del:[],add:[],change:[]};for(r in e)t[r]||a.del.push(r);for(r in t){var u=e[r],l=t[r];if(u){var v={name:r,def:l,recreate:!1,del:[],add:[],change:[]};if(""+(u.primKey.keyPath||"")!=""+(l.primKey.keyPath||"")||u.primKey.auto!==l.primKey.auto)v.recreate=!0,a.change.push(v);else{var w=u.idxByName,x=l.idxByName,T=void 0;for(T in w)x[T]||v.del.push(T);for(T in x){var R=w[T],E=x[T];R?R.src!==E.src&&v.change.push(E):v.add.push(E)}(0<v.del.length||0<v.add.length||0<v.change.length)&&a.change.push(v)}}else a.add.push([r,l])}return a}function Nn(e,t,r,a){var u=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return a.forEach(function(l){return un(u,l)}),u}function mr(e,t){L(e).forEach(function(r){t.db.objectStoreNames.contains(r)||(n&&console.debug("Dexie: Creating missing table",r),Nn(t,r,e[r].primKey,e[r].indexes))})}function un(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function cn(e,t,r){var a={};return ue(t.objectStoreNames,0).forEach(function(u){for(var l=r.objectStore(u),v=In(pr(T=l.keyPath),T||"",!0,!1,!!l.autoIncrement,T&&typeof T!="string",!0),w=[],x=0;x<l.indexNames.length;++x){var R=l.index(l.indexNames[x]),T=R.keyPath,R=In(R.name,T,!!R.unique,!!R.multiEntry,!1,T&&typeof T!="string",!1);w.push(R)}a[u]=Pn(u,v,w)}),a}function ln(e,t,r){for(var a=r.db.objectStoreNames,u=0;u<a.length;++u){var l=a[u],v=r.objectStore(l);e._hasGetAll="getAll"in v;for(var w=0;w<v.indexNames.length;++w){var x=v.indexNames[w],T=v.index(x).keyPath,R=typeof T=="string"?T:"["+ue(T).join("+")+"]";!t[l]||(T=t[l].idxByName[R])&&(T.name=x,delete t[l].idxByName[R],t[l].idxByName[x]=T)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&C.WorkerGlobalScope&&C instanceof C.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function yr(e){return e.split(",").map(function(t,r){var a=(t=t.trim()).replace(/([&*]|\+\+)/g,""),u=/^\[/.test(a)?a.match(/^\[(.*)\]$/)[1].split("+"):a;return In(a,u||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),B(u),r===0)})}var Kr=(fn.prototype._parseStoresSpec=function(e,t){L(e).forEach(function(r){if(e[r]!==null){var a=yr(e[r]),u=a.shift();if(u.unique=!0,u.multi)throw new oe.Schema("Primary key cannot be multi-valued");a.forEach(function(l){if(l.auto)throw new oe.Schema("Only primary key can be marked as autoIncrement (++)");if(!l.keyPath)throw new oe.Schema("Index must have a name and cannot be an empty string")}),t[r]=Pn(r,u,a)}})},fn.prototype.stores=function(r){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?h(this._cfg.storesSource,r):r;var r=t._versions,a={},u={};return r.forEach(function(l){h(a,l._cfg.storesSource),u=l._cfg.dbschema={},l._parseStoresSpec(a,u)}),t._dbSchema=u,Rn(t,[t._allTables,t,t.Transaction.prototype]),sn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],L(u),u),t._storeNames=L(u),this},fn.prototype.upgrade=function(e){return this._cfg.contentUpgrade=A(this._cfg.contentUpgrade||ie,e),this},fn);function fn(){}function Ln(e,t){var r=e._dbNamesDB;return r||(r=e._dbNamesDB=new yt(en,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),r.table("dbnames")}function jn(e){return e&&typeof e.databases=="function"}function Un(e){return vt(function(){return se.letThrough=!0,e()})}function Mn(e){return!("from"in e)}var rt=function(e,t){if(!this){var r=new rt;return e&&"d"in e&&h(r,e),r}h(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function Yt(e,t,r){var a=je(t,r);if(!isNaN(a)){if(0<a)throw RangeError();if(Mn(e))return h(e,{from:t,to:r,d:1});var u=e.l,a=e.r;if(je(r,e.from)<0)return u?Yt(u,t,r):e.l={from:t,to:r,d:1,l:null,r:null},gr(e);if(0<je(t,e.to))return a?Yt(a,t,r):e.r={from:t,to:r,d:1,l:null,r:null},gr(e);je(t,e.from)<0&&(e.from=t,e.l=null,e.d=a?a.d+1:1),0<je(r,e.to)&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1),r=!e.r,u&&!e.l&&Xt(e,u),a&&r&&Xt(e,a)}}function Xt(e,t){Mn(t)||function r(a,x){var l=x.from,v=x.to,w=x.l,x=x.r;Yt(a,l,v),w&&r(a,w),x&&r(a,x)}(e,t)}function hn(e,t){var r=Fn(t),a=r.next();if(a.done)return!1;for(var u=a.value,l=Fn(e),v=l.next(u.from),w=v.value;!a.done&&!v.done;){if(je(w.from,u.to)<=0&&0<=je(w.to,u.from))return!0;je(u.from,w.from)<0?u=(a=r.next(w.from)).value:w=(v=l.next(u.from)).value}return!1}function Fn(e){var t=Mn(e)?null:{s:0,n:e};return{next:function(r){for(var a=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,a)for(;t.n.l&&je(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!a||je(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function gr(e){var t,r,a=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),u=1<a?"r":a<-1?"l":"";u&&(t=u=="r"?"l":"r",r=g({},e),a=e[u],e.from=a.from,e.to=a.to,e[u]=a[u],r[u]=a[t],(e[t]=r).d=vr(r)),e.d=vr(e)}function vr(r){var t=r.r,r=r.l;return(t?r?Math.max(t.d,r.d):t.d:r?r.d:0)+1}function pn(e,t){return L(t).forEach(function(r){e[r]?Xt(e[r],t[r]):e[r]=function a(u){var l,v,w={};for(l in u)D(u,l)&&(v=u[l],w[l]=!v||typeof v!="object"||ce.has(v.constructor)?v:a(v));return w}(t[r])}),e}function qn(e,t){return e.all||t.all||Object.keys(e).some(function(r){return t[r]&&hn(t[r],e[r])})}K(rt.prototype,((ut={add:function(e){return Xt(this,e),this},addKey:function(e){return Yt(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(r){return Yt(t,r,r)}),this}})[ae]=function(){return Fn(this)},ut));var Dt={},Vn={},Kn=!1;function dn(e){pn(Vn,e),Kn||(Kn=!0,setTimeout(function(){Kn=!1,$n(Vn,!(Vn={}))},0))}function $n(e,t){t===void 0&&(t=!1);var r=new Set;if(e.all)for(var a=0,u=Object.values(Dt);a<u.length;a++)br(v=u[a],e,r,t);else for(var l in e){var v,w=/^idb\:\/\/(.*)\/(.*)\//.exec(l);w&&(l=w[1],w=w[2],(v=Dt["idb://".concat(l,"/").concat(w)])&&br(v,e,r,t))}r.forEach(function(x){return x()})}function br(e,t,r,a){for(var u=[],l=0,v=Object.entries(e.queries.query);l<v.length;l++){for(var w=v[l],x=w[0],T=[],R=0,E=w[1];R<E.length;R++){var O=E[R];qn(t,O.obsSet)?O.subscribers.forEach(function(P){return r.add(P)}):a&&T.push(O)}a&&u.push([x,T])}if(a)for(var S=0,I=u;S<I.length;S++){var N=I[S],x=N[0],T=N[1];e.queries.query[x]=T}}function $r(e){var t=e._state,r=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?Ge(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var a=t.openCanceller,u=Math.round(10*e.verno),l=!1;function v(){if(t.openCanceller!==a)throw new oe.DatabaseClosed("db.open() was cancelled")}function w(){return new re(function(O,S){if(v(),!r)throw new oe.MissingAPI;var I=e.name,N=t.autoSchema||!u?r.open(I):r.open(I,u);if(!N)throw new oe.MissingAPI;N.onerror=ft(S),N.onblocked=ze(e._fireOnBlocked),N.onupgradeneeded=ze(function(P){var U;R=N.transaction,t.autoSchema&&!e._options.allowEmptyDB?(N.onerror=Vt,R.abort(),N.result.close(),(U=r.deleteDatabase(I)).onsuccess=U.onerror=ze(function(){S(new oe.NoSuchDatabase("Database ".concat(I," doesnt exist")))})):(R.onerror=ft(S),P=P.oldVersion>Math.pow(2,62)?0:P.oldVersion,E=P<1,e.idbdb=N.result,l&&Vr(e,R),qr(e,P/10,R,S))},S),N.onsuccess=ze(function(){R=null;var P,U,F,q,V,z=e.idbdb=N.result,ee=ue(z.objectStoreNames);if(0<ee.length)try{var H=z.transaction((q=ee).length===1?q[0]:q,"readonly");if(t.autoSchema)U=z,F=H,(P=e).verno=U.version/10,F=P._dbSchema=cn(0,U,F),P._storeNames=ue(U.objectStoreNames,0),sn(P,[P._allTables],L(F),F);else if(ln(e,e._dbSchema,H),((V=On(cn(0,(V=e).idbdb,H),V._dbSchema)).add.length||V.change.some(function(Z){return Z.add.length||Z.change.length}))&&!l)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),z.close(),u=z.version+1,l=!0,O(w());an(e,H)}catch{}Ot.push(e),z.onversionchange=ze(function(Z){t.vcFired=!0,e.on("versionchange").fire(Z)}),z.onclose=ze(function(Z){e.on("close").fire(Z)}),E&&(V=e._deps,H=I,z=V.indexedDB,V=V.IDBKeyRange,jn(z)||H===en||Ln(z,V).put({name:H}).catch(ie)),O()},S)}).catch(function(O){switch(O==null?void 0:O.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),w();break;case"VersionError":if(0<u)return u=0,w()}return re.reject(O)})}var x,T=t.dbReadyResolve,R=null,E=!1;return re.race([a,(typeof navigator>"u"?re.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(O){function S(){return indexedDB.databases().finally(O)}x=setInterval(S,100),S()}).finally(function(){return clearInterval(x)}):Promise.resolve()).then(w)]).then(function(){return v(),t.onReadyBeingFired=[],re.resolve(Un(function(){return e.on.ready.fire(e.vip)})).then(function O(){if(0<t.onReadyBeingFired.length){var S=t.onReadyBeingFired.reduce(A,ie);return t.onReadyBeingFired=[],re.resolve(Un(function(){return S(e.vip)})).then(O)}})}).finally(function(){t.openCanceller===a&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(O){t.dbOpenError=O;try{R&&R.abort()}catch{}return a===t.openCanceller&&e._close(),Ge(O)}).finally(function(){t.openComplete=!0,T()}).then(function(){var O;return E&&(O={},e.tables.forEach(function(S){S.schema.indexes.forEach(function(I){I.name&&(O["idb://".concat(e.name,"/").concat(S.name,"/").concat(I.name)]=new rt(-1/0,[[[]]]))}),O["idb://".concat(e.name,"/").concat(S.name,"/")]=O["idb://".concat(e.name,"/").concat(S.name,"/:dels")]=new rt(-1/0,[[[]]])}),_t(Kt).fire(O),$n(O,!0)),e})}function zn(e){function t(l){return e.next(l)}var r=u(t),a=u(function(l){return e.throw(l)});function u(l){return function(x){var w=l(x),x=w.value;return w.done?x:x&&typeof x.then=="function"?x.then(r,a):B(x)?Promise.all(x).then(r,a):r(x)}}return u(t)()}function mn(e,t,r){for(var a=B(e)?e.slice():[e],u=0;u<r;++u)a.push(t);return a}var zr={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return g(g({},e),{table:function(t){var r=e.table(t),a=r.schema,u={},l=[];function v(E,O,S){var I=zt(E),N=u[I]=u[I]||[],P=E==null?0:typeof E=="string"?1:E.length,U=0<O,U=g(g({},S),{name:U?"".concat(I,"(virtual-from:").concat(S.name,")"):S.name,lowLevelIndex:S,isVirtual:U,keyTail:O,keyLength:P,extractKey:Bn(E),unique:!U&&S.unique});return N.push(U),U.isPrimaryKey||l.push(U),1<P&&v(P===2?E[0]:E.slice(0,P-1),O+1,S),N.sort(function(F,q){return F.keyTail-q.keyTail}),U}t=v(a.primaryKey.keyPath,0,a.primaryKey),u[":id"]=[t];for(var w=0,x=a.indexes;w<x.length;w++){var T=x[w];v(T.keyPath,0,T)}function R(E){var O,S=E.query.index;return S.isVirtual?g(g({},E),{query:{index:S.lowLevelIndex,range:(O=E.query.range,S=S.keyTail,{type:O.type===1?2:O.type,lower:mn(O.lower,O.lowerOpen?e.MAX_KEY:e.MIN_KEY,S),lowerOpen:!0,upper:mn(O.upper,O.upperOpen?e.MIN_KEY:e.MAX_KEY,S),upperOpen:!0})}}):E}return g(g({},r),{schema:g(g({},a),{primaryKey:t,indexes:l,getIndexByKeyPath:function(E){return(E=u[zt(E)])&&E[0]}}),count:function(E){return r.count(R(E))},query:function(E){return r.query(R(E))},openCursor:function(E){var O=E.query.index,S=O.keyTail,I=O.isVirtual,N=O.keyLength;return I?r.openCursor(R(E)).then(function(U){return U&&P(U)}):r.openCursor(E);function P(U){return Object.create(U,{continue:{value:function(F){F!=null?U.continue(mn(F,E.reverse?e.MAX_KEY:e.MIN_KEY,S)):E.unique?U.continue(U.key.slice(0,N).concat(E.reverse?e.MIN_KEY:e.MAX_KEY,S)):U.continue()}},continuePrimaryKey:{value:function(F,q){U.continuePrimaryKey(mn(F,e.MAX_KEY,S),q)}},primaryKey:{get:function(){return U.primaryKey}},key:{get:function(){var F=U.key;return N===1?F[0]:F.slice(0,N)}},value:{get:function(){return U.value}}})}}})}})}};function Yn(e,t,r,a){return r=r||{},a=a||"",L(e).forEach(function(u){var l,v,w;D(t,u)?(l=e[u],v=t[u],typeof l=="object"&&typeof v=="object"&&l&&v?(w=G(l))!==G(v)?r[a+u]=t[u]:w==="Object"?Yn(l,v,r,a+u+"."):l!==v&&(r[a+u]=t[u]):l!==v&&(r[a+u]=t[u])):r[a+u]=void 0}),L(t).forEach(function(u){D(e,u)||(r[a+u]=t[u])}),r}function Xn(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Yr={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return g(g({},e),{table:function(t){var r=e.table(t),a=r.schema.primaryKey;return g(g({},r),{mutate:function(u){var l=se.trans,v=l.table(t).hook,w=v.deleting,x=v.creating,T=v.updating;switch(u.type){case"add":if(x.fire===ie)break;return l._promise("readwrite",function(){return R(u)},!0);case"put":if(x.fire===ie&&T.fire===ie)break;return l._promise("readwrite",function(){return R(u)},!0);case"delete":if(w.fire===ie)break;return l._promise("readwrite",function(){return R(u)},!0);case"deleteRange":if(w.fire===ie)break;return l._promise("readwrite",function(){return function E(O,S,I){return r.query({trans:O,values:!1,query:{index:a,range:S},limit:I}).then(function(N){var P=N.result;return R({type:"delete",keys:P,trans:O}).then(function(U){return 0<U.numFailures?Promise.reject(U.failures[0]):P.length<I?{failures:[],numFailures:0,lastResult:void 0}:E(O,g(g({},S),{lower:P[P.length-1],lowerOpen:!0}),I)})})}(u.trans,u.range,1e4)},!0)}return r.mutate(u);function R(E){var O,S,I,N=se.trans,P=E.keys||Xn(a,E);if(!P)throw new Error("Keys missing");return(E=E.type==="add"||E.type==="put"?g(g({},E),{keys:P}):g({},E)).type!=="delete"&&(E.values=k([],E.values,!0)),E.keys&&(E.keys=k([],E.keys,!0)),O=r,I=P,((S=E).type==="add"?Promise.resolve([]):O.getMany({trans:S.trans,keys:I,cache:"immutable"})).then(function(U){var F=P.map(function(q,V){var z,ee,H,Z=U[V],ne={onerror:null,onsuccess:null};return E.type==="delete"?w.fire.call(ne,q,Z,N):E.type==="add"||Z===void 0?(z=x.fire.call(ne,q,E.values[V],N),q==null&&z!=null&&(E.keys[V]=q=z,a.outbound||Ee(E.values[V],a.keyPath,q))):(z=Yn(Z,E.values[V]),(ee=T.fire.call(ne,z,q,Z,N))&&(H=E.values[V],Object.keys(ee).forEach(function(J){D(H,J)?H[J]=ee[J]:Ee(H,J,ee[J])}))),ne});return r.mutate(E).then(function(q){for(var V=q.failures,z=q.results,ee=q.numFailures,q=q.lastResult,H=0;H<P.length;++H){var Z=(z||P)[H],ne=F[H];Z==null?ne.onerror&&ne.onerror(V[H]):ne.onsuccess&&ne.onsuccess(E.type==="put"&&U[H]?E.values[H]:Z)}return{failures:V,results:z,numFailures:ee,lastResult:q}}).catch(function(q){return F.forEach(function(V){return V.onerror&&V.onerror(q)}),Promise.reject(q)})})}}})}})}};function wr(e,t,r){try{if(!t||t.keys.length<e.length)return null;for(var a=[],u=0,l=0;u<t.keys.length&&l<e.length;++u)je(t.keys[u],e[l])===0&&(a.push(r?$(t.values[u]):t.values[u]),++l);return a.length===e.length?a:null}catch{return null}}var Xr={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var r=e.table(t);return g(g({},r),{getMany:function(a){if(!a.cache)return r.getMany(a);var u=wr(a.keys,a.trans._cache,a.cache==="clone");return u?re.resolve(u):r.getMany(a).then(function(l){return a.trans._cache={keys:a.keys,values:a.cache==="clone"?$(l):l},l})},mutate:function(a){return a.type!=="add"&&(a.trans._cache=null),r.mutate(a)}})}}}};function kr(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function _r(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Hr={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,r=new rt(e.MIN_KEY,e.MAX_KEY);return g(g({},e),{transaction:function(a,u,l){if(se.subscr&&u!=="readonly")throw new oe.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(se.querier));return e.transaction(a,u,l)},table:function(a){var u=e.table(a),l=u.schema,v=l.primaryKey,E=l.indexes,w=v.extractKey,x=v.outbound,T=v.autoIncrement&&E.filter(function(S){return S.compound&&S.keyPath.includes(v.keyPath)}),R=g(g({},u),{mutate:function(S){function I(J){return J="idb://".concat(t,"/").concat(a,"/").concat(J),q[J]||(q[J]=new rt)}var N,P,U,F=S.trans,q=S.mutatedParts||(S.mutatedParts={}),V=I(""),z=I(":dels"),ee=S.type,ne=S.type==="deleteRange"?[S.range]:S.type==="delete"?[S.keys]:S.values.length<50?[Xn(v,S).filter(function(J){return J}),S.values]:[],H=ne[0],Z=ne[1],ne=S.trans._cache;return B(H)?(V.addKeys(H),(ne=ee==="delete"||H.length===Z.length?wr(H,ne):null)||z.addKeys(H),(ne||Z)&&(N=I,P=ne,U=Z,l.indexes.forEach(function(J){var ke=N(J.name||"");function _e(Te){return Te!=null?J.extractKey(Te):null}function xe(Te){return J.multiEntry&&B(Te)?Te.forEach(function(lt){return ke.addKey(lt)}):ke.addKey(Te)}(P||U).forEach(function(Te,it){var Ce=P&&_e(P[it]),it=U&&_e(U[it]);je(Ce,it)!==0&&(Ce!=null&&xe(Ce),it!=null&&xe(it))})}))):H?(Z={from:H.lower,to:H.upper},z.add(Z),V.add(Z)):(V.add(r),z.add(r),l.indexes.forEach(function(J){return I(J.name).add(r)})),u.mutate(S).then(function(J){return!H||S.type!=="add"&&S.type!=="put"||(V.addKeys(J.results),T&&T.forEach(function(ke){var _e=S.values.map(function(Te){return ke.extractKey(Te)}),xe=ke.keyPath.findIndex(function(Te){return Te===v.keyPath});J.results.forEach(function(Te){return _e[xe]=Te}),I(ke.name).addKeys(_e)})),F.mutatedParts=pn(F.mutatedParts||{},q),J})}}),E=function(I){var N=I.query,I=N.index,N=N.range;return[I,new rt((I=N.lower)!==null&&I!==void 0?I:e.MIN_KEY,(N=N.upper)!==null&&N!==void 0?N:e.MAX_KEY)]},O={get:function(S){return[v,new rt(S.key)]},getMany:function(S){return[v,new rt().addKeys(S.keys)]},count:E,query:E,openCursor:E};return L(O).forEach(function(S){R[S]=function(I){var N=se.subscr,P=!!N,U=kr(se,u)&&_r(S,I)?I.obsSet={}:N;if(P){var F=function(Z){return Z="idb://".concat(t,"/").concat(a,"/").concat(Z),U[Z]||(U[Z]=new rt)},q=F(""),V=F(":dels"),N=O[S](I),P=N[0],N=N[1];if((S==="query"&&P.isPrimaryKey&&!I.values?V:F(P.name||"")).add(N),!P.isPrimaryKey){if(S!=="count"){var z=S==="query"&&x&&I.values&&u.query(g(g({},I),{values:!1}));return u[S].apply(this,arguments).then(function(Z){if(S==="query"){if(x&&I.values)return z.then(function(_e){return _e=_e.result,q.addKeys(_e),Z});var ne=I.values?Z.result.map(w):Z.result;(I.values?q:V).addKeys(ne)}else if(S==="openCursor"){var J=Z,ke=I.values;return J&&Object.create(J,{key:{get:function(){return V.addKey(J.primaryKey),J.key}},primaryKey:{get:function(){var _e=J.primaryKey;return V.addKey(_e),_e}},value:{get:function(){return ke&&q.addKey(J.primaryKey),J.value}}})}return Z})}V.add(r)}}return u[S].apply(this,arguments)}}),R}})}};function Er(e,t,r){if(r.numFailures===0)return t;if(t.type==="deleteRange")return null;var a=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return r.numFailures===a?null:(t=g({},t),B(t.keys)&&(t.keys=t.keys.filter(function(u,l){return!(l in r.failures)})),"values"in t&&B(t.values)&&(t.values=t.values.filter(function(u,l){return!(l in r.failures)})),t)}function Hn(e,t){return r=e,((a=t).lower===void 0||(a.lowerOpen?0<je(r,a.lower):0<=je(r,a.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?je(e,t.upper)<0:je(e,t.upper)<=0));var r,a}function Tr(e,t,O,a,u,l){if(!O||O.length===0)return e;var v=t.query.index,w=v.multiEntry,x=t.query.range,T=a.schema.primaryKey.extractKey,R=v.extractKey,E=(v.lowLevelIndex||v).extractKey,O=O.reduce(function(S,I){var N=S,P=I.type==="add"||I.type==="put"?I.values.filter(function(V){return V=R(V),w&&B(V)?V.some(function(z){return Hn(z,x)}):Hn(V,x)}).map(function(V){return V=$(V),l&&Object.freeze(V),V}):[];switch(I.type){case"add":N=S.concat(t.values?P:P.map(function(z){return T(z)}));break;case"put":var U=new rt().addKeys(I.values.map(function(z){return T(z)})),N=S.filter(function(z){return z=t.values?T(z):z,!hn(new rt(z),U)}).concat(t.values?P:P.map(function(z){return T(z)}));break;case"delete":var F=new rt().addKeys(I.keys);N=S.filter(function(z){return z=t.values?T(z):z,!hn(new rt(z),F)});break;case"deleteRange":var q=I.range;N=S.filter(function(z){return!Hn(T(z),q)})}return N},e);return O===e?e:(O.sort(function(S,I){return je(E(S),E(I))||je(T(S),T(I))}),t.limit&&t.limit<1/0&&(O.length>t.limit?O.length=t.limit:e.length===t.limit&&O.length<t.limit&&(u.dirty=!0)),l?Object.freeze(O):O)}function Cr(e,t){return je(e.lower,t.lower)===0&&je(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Gr(e,t){return function(r,a,u,l){if(r===void 0)return a!==void 0?-1:0;if(a===void 0)return 1;if((a=je(r,a))===0){if(u&&l)return 0;if(u)return 1;if(l)return-1}return a}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(r,a,u,l){if(r===void 0)return a!==void 0?1:0;if(a===void 0)return-1;if((a=je(r,a))===0){if(u&&l)return 0;if(u)return-1;if(l)return 1}return a}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function Wr(e,t,r,a){e.subscribers.add(r),a.addEventListener("abort",function(){var u,l;e.subscribers.delete(r),e.subscribers.size===0&&(u=e,l=t,setTimeout(function(){u.subscribers.size===0&&we(l,u)},3e3))})}var Qr={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return g(g({},e),{transaction:function(r,a,u){var l,v,w=e.transaction(r,a,u);return a==="readwrite"&&(v=(l=new AbortController).signal,u=function(x){return function(){if(l.abort(),a==="readwrite"){for(var T=new Set,R=0,E=r;R<E.length;R++){var O=E[R],S=Dt["idb://".concat(t,"/").concat(O)];if(S){var I=e.table(O),N=S.optimisticOps.filter(function(ke){return ke.trans===w});if(w._explicit&&x&&w.mutatedParts)for(var P=0,U=Object.values(S.queries.query);P<U.length;P++)for(var F=0,q=(ee=U[P]).slice();F<q.length;F++)qn((H=q[F]).obsSet,w.mutatedParts)&&(we(ee,H),H.subscribers.forEach(function(ke){return T.add(ke)}));else if(0<N.length){S.optimisticOps=S.optimisticOps.filter(function(ke){return ke.trans!==w});for(var V=0,z=Object.values(S.queries.query);V<z.length;V++)for(var ee,H,Z,ne=0,J=(ee=z[V]).slice();ne<J.length;ne++)(H=J[ne]).res!=null&&w.mutatedParts&&(x&&!H.dirty?(Z=Object.isFrozen(H.res),Z=Tr(H.res,H.req,N,I,H,Z),H.dirty?(we(ee,H),H.subscribers.forEach(function(ke){return T.add(ke)})):Z!==H.res&&(H.res=Z,H.promise=re.resolve({result:Z}))):(H.dirty&&we(ee,H),H.subscribers.forEach(function(ke){return T.add(ke)})))}}}T.forEach(function(ke){return ke()})}}},w.addEventListener("abort",u(!1),{signal:v}),w.addEventListener("error",u(!1),{signal:v}),w.addEventListener("complete",u(!0),{signal:v})),w},table:function(r){var a=e.table(r),u=a.schema.primaryKey;return g(g({},a),{mutate:function(l){var v=se.trans;if(u.outbound||v.db._options.cache==="disabled"||v.explicit)return a.mutate(l);var w=Dt["idb://".concat(t,"/").concat(r)];return w?(v=a.mutate(l),l.type!=="add"&&l.type!=="put"||!(50<=l.values.length||Xn(u,l).some(function(x){return x==null}))?(w.optimisticOps.push(l),l.mutatedParts&&dn(l.mutatedParts),v.then(function(x){0<x.numFailures&&(we(w.optimisticOps,l),(x=Er(0,l,x))&&w.optimisticOps.push(x),l.mutatedParts&&dn(l.mutatedParts))}),v.catch(function(){we(w.optimisticOps,l),l.mutatedParts&&dn(l.mutatedParts)})):v.then(function(x){var T=Er(0,g(g({},l),{values:l.values.map(function(S,E){var O,S=(O=u.keyPath)!==null&&O!==void 0&&O.includes(".")?$(S):g({},S);return Ee(S,u.keyPath,x.results[E]),S})}),x);w.optimisticOps.push(T),queueMicrotask(function(){return l.mutatedParts&&dn(l.mutatedParts)})}),v):a.mutate(l)},query:function(l){if(!kr(se,a)||!_r("query",l))return a.query(l);var v=((T=se.trans)===null||T===void 0?void 0:T.db._options.cache)==="immutable",E=se,w=E.requery,x=E.signal,T=function(I,N,P,U){var F=Dt["idb://".concat(I,"/").concat(N)];if(!F)return[];if(!(N=F.queries[P]))return[null,!1,F,null];var q=N[(U.query?U.query.index.name:null)||""];if(!q)return[null,!1,F,null];switch(P){case"query":var V=q.find(function(z){return z.req.limit===U.limit&&z.req.values===U.values&&Cr(z.req.query.range,U.query.range)});return V?[V,!0,F,q]:[q.find(function(z){return("limit"in z.req?z.req.limit:1/0)>=U.limit&&(!U.values||z.req.values)&&Gr(z.req.query.range,U.query.range)}),!1,F,q];case"count":return V=q.find(function(z){return Cr(z.req.query.range,U.query.range)}),[V,!!V,F,q]}}(t,r,"query",l),R=T[0],E=T[1],O=T[2],S=T[3];return R&&E?R.obsSet=l.obsSet:(E=a.query(l).then(function(I){var N=I.result;if(R&&(R.res=N),v){for(var P=0,U=N.length;P<U;++P)Object.freeze(N[P]);Object.freeze(N)}else I.result=$(N);return I}).catch(function(I){return S&&R&&we(S,R),Promise.reject(I)}),R={obsSet:l.obsSet,promise:E,subscribers:new Set,type:"query",req:l,dirty:!1},S?S.push(R):(S=[R],(O=O||(Dt["idb://".concat(t,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[l.query.index.name||""]=S)),Wr(R,S,w,x),R.promise.then(function(I){return{result:Tr(I.result,l,O==null?void 0:O.optimisticOps,a,R,v)}})}})}})}};function yn(e,t){return new Proxy(e,{get:function(r,a,u){return a==="db"?t:Reflect.get(r,a,u)}})}var yt=(We.prototype.version=function(e){if(isNaN(e)||e<.1)throw new oe.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new oe.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,r=t.filter(function(a){return a._cfg.version===e})[0];return r||(r=new this.Version(e),t.push(r),t.sort(Fr),r.stores({}),this._state.autoSchema=!1,r)},We.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||se.letThrough||this._vip)?e():new re(function(r,a){if(t._state.openComplete)return a(new oe.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void a(new oe.DatabaseClosed);t.open().catch(ie)}t._state.dbReadyPromise.then(r,a)}).then(e)},We.prototype.use=function(e){var t=e.stack,r=e.create,a=e.level,u=e.name;return u&&this.unuse({stack:t,name:u}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:r,level:a??10,name:u}),e.sort(function(l,v){return l.level-v.level}),this},We.prototype.unuse=function(e){var t=e.stack,r=e.name,a=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(u){return a?u.create!==a:!!r&&u.name!==r})),this},We.prototype.open=function(){var e=this;return Ct(ct,function(){return $r(e)})},We.prototype._close=function(){var e=this._state,t=Ot.indexOf(this);if(0<=t&&Ot.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new re(function(r){e.dbReadyResolve=r}),e.openCanceller=new re(function(r,a){e.cancelOpen=a}))},We.prototype.close=function(r){var t=(r===void 0?{disableAutoOpen:!0}:r).disableAutoOpen,r=this._state;t?(r.isBeingOpened&&r.cancelOpen(new oe.DatabaseClosed),this._close(),r.autoOpen=!1,r.dbOpenError=new oe.DatabaseClosed):(this._close(),r.autoOpen=this._options.autoOpen||r.isBeingOpened,r.openComplete=!1,r.dbOpenError=null)},We.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var r=0<arguments.length&&typeof arguments[0]!="object",a=this._state;return new re(function(u,l){function v(){t.close(e);var w=t._deps.indexedDB.deleteDatabase(t.name);w.onsuccess=ze(function(){var x,T,R;x=t._deps,T=t.name,R=x.indexedDB,x=x.IDBKeyRange,jn(R)||T===en||Ln(R,x).delete(T).catch(ie),u()}),w.onerror=ft(l),w.onblocked=t._fireOnBlocked}if(r)throw new oe.InvalidArgument("Invalid closeOptions argument to db.delete()");a.isBeingOpened?a.dbReadyPromise.then(v):v()})},We.prototype.backendDB=function(){return this.idbdb},We.prototype.isOpen=function(){return this.idbdb!==null},We.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},We.prototype.hasFailed=function(){return this._state.dbOpenError!==null},We.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(We.prototype,"tables",{get:function(){var e=this;return L(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),We.prototype.transaction=function(){var e=(function(t,r,a){var u=arguments.length;if(u<2)throw new oe.InvalidArgument("Too few arguments");for(var l=new Array(u-1);--u;)l[u-1]=arguments[u];return a=l.pop(),[t,Se(l),a]}).apply(this,arguments);return this._transaction.apply(this,e)},We.prototype._transaction=function(e,t,r){var a=this,u=se.trans;u&&u.db===this&&e.indexOf("!")===-1||(u=null);var l,v,w=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(v=t.map(function(T){if(T=T instanceof a.Table?T.name:T,typeof T!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return T}),e=="r"||e===Tn)l=Tn;else{if(e!="rw"&&e!=Cn)throw new oe.InvalidArgument("Invalid transaction mode: "+e);l=Cn}if(u){if(u.mode===Tn&&l===Cn){if(!w)throw new oe.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");u=null}u&&v.forEach(function(T){if(u&&u.storeNames.indexOf(T)===-1){if(!w)throw new oe.SubTransaction("Table "+T+" not included in parent transaction.");u=null}}),w&&u&&!u.active&&(u=null)}}catch(T){return u?u._promise(null,function(R,E){E(T)}):Ge(T)}var x=(function T(R,E,O,S,I){return re.resolve().then(function(){var N=se.transless||se,P=R._createTransaction(E,O,R._dbSchema,S);if(P.explicit=!0,N={trans:P,transless:N},S)P.idbtrans=S.idbtrans;else try{P.create(),P.idbtrans._explicit=!0,R._state.PR1398_maxLoop=3}catch(q){return q.name===Fe.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return T(R,E,O,null,I)})):Ge(q)}var U,F=$e(I);return F&&Rt(),N=re.follow(function(){var q;(U=I.call(P,P))&&(F?(q=bt.bind(null,null),U.then(q,q)):typeof U.next=="function"&&typeof U.throw=="function"&&(U=zn(U)))},N),(U&&typeof U.then=="function"?re.resolve(U).then(function(q){return P.active?q:Ge(new oe.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):N.then(function(){return U})).then(function(q){return S&&P._resolve(),P._completion.then(function(){return q})}).catch(function(q){return P._reject(q),Ge(q)})})}).bind(null,this,l,v,u,r);return u?u._promise(l,x,"lock"):se.trans?Ct(se.transless,function(){return a._whenReady(x)}):this._whenReady(x)},We.prototype.table=function(e){if(!D(this._allTables,e))throw new oe.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},We);function We(e,t){var r=this;this._middlewares={},this.verno=0;var a=We.dependencies;this._options=t=g({addons:We.addons,autoOpen:!0,indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},a=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var u,l,v,w,x,T={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ie,dbReadyPromise:null,cancelOpen:ie,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};T.dbReadyPromise=new re(function(E){T.dbReadyResolve=E}),T.openCanceller=new re(function(E,O){T.cancelOpen=O}),this._state=T,this.name=e,this.on=Mt(this,"populate","blocked","versionchange","close",{ready:[A,ie]}),this.on.ready.subscribe=de(this.on.ready.subscribe,function(E){return function(O,S){We.vip(function(){var I,N=r._state;N.openComplete?(N.dbOpenError||re.resolve().then(O),S&&E(O)):N.onReadyBeingFired?(N.onReadyBeingFired.push(O),S&&E(O)):(E(O),I=r,S||E(function P(){I.on.ready.unsubscribe(O),I.on.ready.unsubscribe(P)}))})}}),this.Collection=(u=this,Ft(Rr.prototype,function(U,P){this.db=u;var S=rr,I=null;if(P)try{S=P()}catch(F){I=F}var N=U._ctx,P=N.table,U=P.hook.reading.fire;this._ctx={table:P,index:N.index,isPrimKey:!N.index||P.schema.primKey.keyPath&&N.index===P.schema.primKey.name,range:S,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:I,or:N.or,valueMapper:U!==he?U:null}})),this.Table=(l=this,Ft(sr.prototype,function(E,O,S){this.db=l,this._tx=S,this.name=E,this.schema=O,this.hook=l._allTables[E]?l._allTables[E].hook:Mt(null,{creating:[qe,ie],reading:[pe,he],updating:[s,ie],deleting:[o,ie]})})),this.Transaction=(v=this,Ft(Lr.prototype,function(E,O,S,I,N){var P=this;this.db=v,this.mode=E,this.storeNames=O,this.schema=S,this.chromeTransactionDurability=I,this.idbtrans=null,this.on=Mt(this,"complete","error","abort"),this.parent=N||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new re(function(U,F){P._resolve=U,P._reject=F}),this._completion.then(function(){P.active=!1,P.on.complete.fire()},function(U){var F=P.active;return P.active=!1,P.on.error.fire(U),P.parent?P.parent._reject(U):F&&P.idbtrans&&P.idbtrans.abort(),Ge(U)})})),this.Version=(w=this,Ft(Kr.prototype,function(E){this.db=w,this._cfg={version:E,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(x=this,Ft(hr.prototype,function(E,O,S){if(this.db=x,this._ctx={table:E,index:O===":id"?null:O,or:S},this._cmp=this._ascending=je,this._descending=function(I,N){return je(N,I)},this._max=function(I,N){return 0<je(I,N)?I:N},this._min=function(I,N){return je(I,N)<0?I:N},this._IDBKeyRange=x._deps.IDBKeyRange,!this._IDBKeyRange)throw new oe.MissingAPI})),this.on("versionchange",function(E){0<E.newVersion?console.warn("Another connection wants to upgrade database '".concat(r.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(r.name,"'. Closing db now to resume the delete request.")),r.close({disableAutoOpen:!1})}),this.on("blocked",function(E){!E.newVersion||E.newVersion<E.oldVersion?console.warn("Dexie.delete('".concat(r.name,"') was blocked")):console.warn("Upgrade '".concat(r.name,"' blocked by other connection holding version ").concat(E.oldVersion/10))}),this._maxKey=$t(t.IDBKeyRange),this._createTransaction=function(E,O,S,I){return new r.Transaction(E,O,S,r._options.chromeTransactionDurability,I)},this._fireOnBlocked=function(E){r.on("blocked").fire(E),Ot.filter(function(O){return O.name===r.name&&O!==r&&!O._state.vcFired}).map(function(O){return O.on("versionchange").fire(E)})},this.use(Xr),this.use(Qr),this.use(Hr),this.use(zr),this.use(Yr);var R=new Proxy(this,{get:function(E,O,S){if(O==="_vip")return!0;if(O==="table")return function(N){return yn(r.table(N),R)};var I=Reflect.get(E,O,S);return I instanceof sr?yn(I,R):O==="tables"?I.map(function(N){return yn(N,R)}):O==="_createTransaction"?function(){return yn(I.apply(this,arguments),R)}:I}});this.vip=R,a.forEach(function(E){return E(r)})}var gn,ut=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Zr=(Gn.prototype.subscribe=function(e,t,r){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:r})},Gn.prototype[ut]=function(){return this},Gn);function Gn(e){this._subscribe=e}try{gn={indexedDB:C.indexedDB||C.mozIndexedDB||C.webkitIndexedDB||C.msIndexedDB,IDBKeyRange:C.IDBKeyRange||C.webkitIDBKeyRange}}catch{gn={indexedDB:null,IDBKeyRange:null}}function Sr(e){var t,r=!1,a=new Zr(function(u){var l=$e(e),v,w=!1,x={},T={},R={get closed(){return w},unsubscribe:function(){w||(w=!0,v&&v.abort(),E&&_t.storagemutated.unsubscribe(S))}};u.start&&u.start(R);var E=!1,O=function(){return En(I)},S=function(N){pn(x,N),qn(T,x)&&O()},I=function(){var N,P,U;!w&&gn.indexedDB&&(x={},N={},v&&v.abort(),v=new AbortController,U=function(F){var q=Pt();try{l&&Rt();var V=vt(e,F);return V=l?V.finally(bt):V}finally{q&&Bt()}}(P={subscr:N,signal:v.signal,requery:O,querier:e,trans:null}),Promise.resolve(U).then(function(F){r=!0,t=F,w||P.signal.aborted||(x={},function(q){for(var V in q)if(D(q,V))return;return 1}(T=N)||E||(_t(Kt,S),E=!0),En(function(){return!w&&u.next&&u.next(F)}))},function(F){r=!1,["DatabaseClosedError","AbortError"].includes(F==null?void 0:F.name)||w||En(function(){w||u.error&&u.error(F)})}))};return setTimeout(O,0),R});return a.hasValue=function(){return r},a.getValue=function(){return t},a}var At=yt;function Wn(e){var t=Et;try{Et=!0,_t.storagemutated.fire(e),$n(e,!0)}finally{Et=t}}K(At,g(g({},Qe),{delete:function(e){return new At(e,{addons:[]}).delete()},exists:function(e){return new At(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=At.dependencies,r=t.indexedDB,t=t.IDBKeyRange,(jn(r)?Promise.resolve(r.databases()).then(function(a){return a.map(function(u){return u.name}).filter(function(u){return u!==en})}):Ln(r,t).toCollection().primaryKeys()).then(e)}catch{return Ge(new oe.MissingAPI)}var t,r},defineClass:function(){return function(e){h(this,e)}},ignoreTransaction:function(e){return se.trans?Ct(se.transless,e):e()},vip:Un,async:function(e){return function(){try{var t=zn(e.apply(this,arguments));return t&&typeof t.then=="function"?t:re.resolve(t)}catch(r){return Ge(r)}}},spawn:function(e,t,r){try{var a=zn(e.apply(r,t||[]));return a&&typeof a.then=="function"?a:re.resolve(a)}catch(u){return Ge(u)}},currentTransaction:{get:function(){return se.trans||null}},waitFor:function(e,t){return t=re.resolve(typeof e=="function"?At.ignoreTransaction(e):e).timeout(t||6e4),se.trans?se.trans.waitFor(t):t},Promise:re,debug:{get:function(){return n},set:function(e){i(e)}},derive:ye,extend:h,props:K,override:de,Events:Mt,on:_t,liveQuery:Sr,extendObservabilitySet:pn,getByKeyPath:Ie,setByKeyPath:Ee,delByKeyPath:function(e,t){typeof t=="string"?Ee(e,t,void 0):"length"in t&&[].map.call(t,function(r){Ee(e,r,void 0)})},shallowClone:Ye,deepClone:$,getObjectDiff:Yn,cmp:je,asap:De,minKey:-1/0,addons:[],connections:Ot,errnames:Fe,dependencies:gn,cache:Dt,semVer:"4.0.7",version:"4.0.7".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,r){return e+t/Math.pow(10,2*r)})})),At.maxKey=$t(At.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(_t(Kt,function(e){Et||(e=new CustomEvent(An,{detail:e}),Et=!0,dispatchEvent(e),Et=!1)}),addEventListener(An,function(e){e=e.detail,Et||Wn(e)}));var jt,Et=!1,xr=function(){};return typeof BroadcastChannel<"u"&&((xr=function(){(jt=new BroadcastChannel(An)).onmessage=function(e){return e.data&&Wn(e.data)}})(),typeof jt.unref=="function"&&jt.unref(),_t(Kt,function(e){Et||jt.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!yt.disableBfCache&&e.persisted){n&&console.debug("Dexie: handling persisted pagehide"),jt!=null&&jt.close();for(var t=0,r=Ot;t<r.length;t++)r[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!yt.disableBfCache&&e.persisted&&(n&&console.debug("Dexie: handling persisted pageshow"),xr(),Wn({all:new rt(-1/0,[[]])}))})),re.rejectionMapper=function(e,t){return!e||e instanceof Ue||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Ze[e.name]?e:(t=new Ze[e.name](t||e.message,e),"stack"in e&&W(t,"stack",{get:function(){return this.inner.stack}}),t)},i(n),g(yt,Object.freeze({__proto__:null,Dexie:yt,liveQuery:Sr,Entity:ir,cmp:je,PropModSymbol:mt,PropModification:qt,replacePrefix:function(e,t){return new qt({replacePrefix:[e,t]})},add:function(e){return new qt({add:e})},remove:function(e){return new qt({remove:e})},default:yt,RangeSet:rt,mergeRanges:Xt,rangesOverlap:hn}),{default:yt}),yt})})(dexie_min);var dexie_minExports=dexie_min.exports;const _Dexie=getDefaultExportFromCjs(dexie_minExports),DexieSymbol=Symbol.for("Dexie"),Dexie=globalThis[DexieSymbol]||(globalThis[DexieSymbol]=_Dexie);if(_Dexie.semVer!==Dexie.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${_Dexie.semVer} and ${Dexie.semVer}`);const version="v1.3.3",buildTime="2025-01-06 10 46                                                                      28",version$1={version,buildTime},FilterType={None:0,NoRequestBody:1,NoResponseBody:2,NoAllBody:3},networkFilterMap=new Map;function initNetworkFilter(p){networkFilterMap.clear(),p.forEach(d=>{const b=d.isFullPath?d.url:self.location.origin+d.url;networkFilterMap.has(b)||networkFilterMap.set(b,d.filter)}),console.log("networkFilterMap",networkFilterMap)}function isUrlFiltered(p){return networkFilterMap.get(p)===FilterType.None}function isReqBodyFiltered(p){return networkFilterMap.get(p)===FilterType.NoRequestBody}function isResBodyFiltered(p){return networkFilterMap.get(p)===FilterType.NoResponseBody}const DEFAULT_LOG_RORATE=3,LogLevel={Debug:"4",Info:"3",Warnings:"2",Errors:"1",None:"-1"},configParams={logLevel:LogLevel.Debug,logRorate:DEFAULT_LOG_RORATE,yomNetworkEnable:"1",yomConsoleEnable:"1",chromeConsoleEnable:"1",workerBaseUrl:"",dbName:"",networkFilter:[]};function setConfig(p){if(p.logLevel!==void 0){if(+p.logLevel==NaN||+p.logLevel<0||+p.logLevel>4)return console.error("Invalid log level");configParams.logLevel=p.logLevel,localStorageSetItem("yom-log-level",configParams.logLevel)}return p.logRorate!==void 0&&(configParams.logRorate=p.logRorate,localStorageSetItem("yom-log-rotate",configParams.logRorate)),p.yomNetworkEnable!==void 0&&(configParams.yomNetworkEnable=p.yomNetworkEnable,localStorageSetItem("yom-network-enable",configParams.yomNetworkEnable)),p.yomConsoleEnable!==void 0&&(configParams.yomConsoleEnable=p.yomConsoleEnable,localStorageSetItem("yom-console-enable",configParams.yomConsoleEnable)),p.chromeConsoleEnable!==void 0&&(configParams.chromeConsoleEnable=p.chromeConsoleEnable,localStorageSetItem("chrome-console-enable",configParams.chromeConsoleEnable)),p.workerBaseUrl!==void 0&&(configParams.workerBaseUrl=p.workerBaseUrl,localStorageSetItem("worker-base-url",configParams.workerBaseUrl)),p.dbName!==void 0&&(configParams.dbName=p.dbName,openNewDatabase(p.dbName),localStorageSetItem("db-name",configParams.dbName)),p.networkFilter!==void 0&&(configParams.networkFilter=p.networkFilter,initNetworkFilter(p.networkFilter)),configParams}function initConfig(){configParams.logLevel=localStorageGetItem("yom-log-level")||LogLevel.Debug,configParams.logRorate=localStorageGetItem("yom-log-rotate")||DEFAULT_LOG_RORATE,configParams.yomNetworkEnable=localStorageGetItem("yom-network-enable")||"1",configParams.yomConsoleEnable=localStorageGetItem("yom-console-enable")||"1",configParams.chromeConsoleEnable=localStorageGetItem("chrome-console-enable")||"1",configParams.workerBaseUrl=localStorageGetItem("worker-base-url")||"",console.table("yom initConfig",configParams)}initConfig();const config=Object.freeze(Object.defineProperty({__proto__:null,LogLevel,configParams,setConfig},Symbol.toStringTag,{value:"Module"}));function getAbsoultPath(p){if(!p||typeof p!="string")return"";if(isSelf())return getAbsolutePathInWorker(p);const d=document.createElement("a");return d.href=p,d.href}function getAbsolutePathInWorker(p){try{return new URL(p,configParams.workerBaseUrl).href}catch(d){return console.error("Error parsing URL:",d),p}}function key2UpperCase(p){return p.replace(/^\S|-[a-z]/g,d=>d.toUpperCase())}function formatLocalDate(p){const d=p.getFullYear(),b=String(p.getMonth()+1).padStart(2,"0"),g=String(p.getDate()).padStart(2,"0"),k=String(p.getHours()).padStart(2,"0"),C=String(p.getMinutes()).padStart(2,"0"),L=String(p.getSeconds()).padStart(2,"0");return`${d}-${b}-${g}T${k}:${C}:${L}`}function makeString2NumberChar(p){return p==null?void 0:p.replace(/[^a-zA-Z0-9]/g,"")}function callsites(){const p=Error.prepareStackTrace;try{let d=[];return Error.prepareStackTrace=(b,g)=>{const k=g.slice(1);return d=k,k},new Error().stack,d}finally{Error.prepareStackTrace=p}}function isSelf(){try{return typeof window>"u"&&typeof self<"u"}catch{return!0}}function localStorageGetItem(p){if(!isSelf())return localStorage.getItem(p)||""}function localStorageSetItem(p,d){if(!isSelf())return localStorage.setItem(p,d)}const ConsleTableName="consoles",NetworkTableName="networks",DBVersion=2;function addConsole(p,d,b){configParams.logLevel!==LogLevel.None&&configParams.yomConsoleEnable==="1"&&dbAddConsole({timestamp:d,type:p,data:b})}async function getConsole(p,d){return await dbGetConsole(p,d)}function addNetwork(p){if(configParams.yomNetworkEnable!=="1")return;const d=p.params.timestamp*1e3||Date.now();dbAddNetwork({timestamp:d,data:p})}async function getNetworks(p,d){return await dbGetNetwork(p,d)}let mainCallback;function addCallback(p){mainCallback=p}function clearDataRegularly(p){clearDataByTime(p)}function clearDataByTime(p){try{const d=p||configParams.logRorate;console.info("clearDataRegularly",d);let b=Date.now()-d*60*60*1e3;db[ConsleTableName].where("timestamp").below(b).delete().then(g=>console.log(`Consoles older than ${d} hours have been deleted.`,g)).catch(g=>console.error("Failed to delete Consoles:",g)),db[NetworkTableName].where("timestamp").below(b).delete().then(g=>console.log(`Networks older than ${d} hours have been deleted.`,g)).catch(g=>console.error("Failed to delete Networks:",g))}catch(d){console.error("Failed to delete data regularly:",d)}}function startClearInterval(){setInterval(()=>{console.log("startClearInterval"),clearDataRegularly()},1e3*60*60)}let consoleCount=0;function dbAddConsole(p){return remarkConsoleIntoDb(ConsleTableName,"add"),db[ConsleTableName].put(p).then(d=>{remarkConsoleIntoDb(ConsleTableName,"remove")})}async function dbGetConsole(p,d){return console.log("dbGetConsole",new Date(p).getTime(),new Date(d).getTime()),await db[ConsleTableName].where("timestamp").between(new Date(p).getTime(),new Date(d).getTime()).toArray()}function remarkConsoleIntoDb(p,d="add"){if(d==="add"?consoleCount++:consoleCount--,consoleCount>0&&consoleCount%100===0){const b=d==="add"?"Write too fast!!!":"Write over",g={type:d==="add"?"alarm":"unalarm",timestamp:Date.now(),data:{title:"Console",content:`${b}, queue count:${consoleCount}`}};mainCallback&&mainCallback(g),db[p].put(g)}}let networkCount=0;function dbAddNetwork(p){return remarkNetworkIntoDb(NetworkTableName,"add"),db[NetworkTableName].put(p).then(d=>{remarkNetworkIntoDb(NetworkTableName,"remove")})}async function dbGetNetwork(p,d){return console.log("dbGetNetwork",new Date(p).getTime(),new Date(d).getTime()),await db[NetworkTableName].where("timestamp").between(new Date(p).getTime(),new Date(d).getTime()).toArray()}function remarkNetworkIntoDb(p,d="add"){if(d==="add"?networkCount++:networkCount--,networkCount>0&&networkCount%100===0){const b=d==="add"?"Write too fast!!!":"Write over",g={type:d==="add"?"alarm":"unalarm",timestamp:Date.now(),data:{title:"Network",content:`${b}, queue count:${networkCount}`}};mainCallback&&mainCallback(g),db[p].put(g)}}async function exportConsoleData(p,d){console.info("exportConsoleData start");const b=await getConsole(p,d);await exportData(b,"console"),console.info("exportConsoleData over")}async function exportNetworkData(p,d){console.info("exportNetworkData start");const b=await getNetworks(p,d);await exportData(b,"network"),console.info("exportNetworkData over")}async function exportData(p,d){if(!(p!=null&&p.length))return alert("no data");if(p.length>8888)return alert("too large, change time again plz");await downloadData(p,d)}async function downloadData(p,d){let b=new ReadableStream({start(L){let B=new TextEncoder().encode("[");L.enqueue(B);for(let h=0;h<p.length;h++){const m=p[h],y=h===p.length-1?"]":",";let D=JSON.stringify(m)+y,K=new TextEncoder().encode(D);L.enqueue(K)}L.close()}}),g=await new Response(b).blob(),k=URL.createObjectURL(g),C=document.createElement("a");C.href=k,C.download=`${d}-${Date.now()}.json`,C.click(),URL.revokeObjectURL(k)}let db,dbKey;function openNewDatabase(p){const d=p||getDBKey();d!==dbKey&&(closeCurrentDatabase(),db=new Dexie("devtools"+d),db.version(DBVersion).stores({[ConsleTableName]:"++id,timestamp,type,data",[NetworkTableName]:"++id,timestamp,data"}))}function closeCurrentDatabase(){try{db&&db.close()}catch{}}openNewDatabase(),startClearInterval();function getDBKey(){try{return console.log("getDBKey",configParams),configParams.dbName?configParams.dbName:isSelf()?makeString2NumberChar(self.location.pathname)||"":makeString2NumberChar(window.location.pathname)||""}catch{return""}}console.log("%cYom-"+getDBKey()+"%c"+(version$1==null?void 0:version$1.version)+"%c"+(version$1==null?void 0:version$1.buildTime),"color:white;background:#606060;padding:4px 12px;border-radius:3px 0px 0px 3px","background:lightGreen;padding:4px 12px;","color:white;background:#0074af;padding:4px 12px;border-radius:0px 3px 3px 0px");async function getSeekableBlob(p){if(!EBML)return;console.log("getSeekableBlob EBML",EBML);const d=new EBML.Decoder,b=await p.arrayBuffer();console.log("buf",b);const g=d.decode(b);console.log(g);const k=new EBML.Reader;g.forEach(h=>{h.type==="unknown"&&h.name==="unknown"||k.read(h)}),k.stop(),console.log("reader",k);const C=EBML.tools.makeMetadataSeekable(k.metadatas,k.duration,k.cues);console.log("refinedMetadataBuf",C);const L=b.slice(k.metadataSize),B=new Blob([C,L],{type:"video/webm"});return console.log("aimBlob",B),B}const mimeType="video/webm;codecs=vp8";let mediaRecorder,blobSlice=[];const startRecordClick=p=>(console.log("startRecordClick"),new Promise((d,b)=>{p||(console.error("startRecord stream is null"),b("startRecord stream is null")),blobSlice=[],mediaRecorder=new MediaRecorder(p,{mimeType,videoBitsPerSecond:1e6}),mediaRecorder.ondataavailable=k=>{blobSlice.push(k.data)};const g=new Date().toLocaleString().replace(/\//g,"-");mediaRecorder.onstop=async()=>{console.log("onstop");const k=new Date().toLocaleString().replace(/\//g,"-");d({startTime:g,endTime:k})},mediaRecorder.start(1e3)})),downloadRecord=async(p,d)=>{const b=new Blob([...blobSlice],{type:mimeType});console.log("onstop newBlob",b);const g=await getSeekableBlob(b);console.log("onstop aimBlob",g);var k=URL.createObjectURL(g);console.log("videoURL",k);var C=document.createElement("a");C.href=k,C.style.display="none",C.download=getRecorderFileName(p,d),C.click(),blobSlice=[]};function getRecorderFileName(p,d){return`recorder,${p},${d}.mp4`}class _webrtc{constructor(){this._mediaConstraints={optional:[],mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}}}async getScreen(d){return navigator.mediaDevices.getDisplayMedia(d)}getMedia(d){return new Promise((b,g)=>{if(!this._isSupport())return g("browser not support webrtc.");navigator.mediaDevices.getUserMedia(d).then(function(k){b(k)}).catch(function(k){g("Unable to get video stream:"+k)})})}getDevices(){return navigator.mediaDevices.enumerateDevices()}getPeerConnection(d,b,g){const k=new RTCPeerConnection(null);return k.onicecandidate=d,k.ontrack=b,k.onicegatheringstatechange=function(){k.iceGatheringState==="complete"&&g()},k}addIceCandidate(d,b){return new Promise(function(g,k){d?d.addIceCandidate(new RTCIceCandidate(b)).then(g).catch(k):k("peerconnection is null.")})}addTracks(d,b){d&&b&&b.getTracks().forEach(function(g){d.addTrack(g,b)})}createOffer(d,b){return new Promise((g,k)=>{d?d.createOffer(C=>{d.setLocalDescription(C,function(){g(C)},k)},k,this._mediaConstraints):k("peerconnection is null.")})}createAnswer(d,b,g){return new Promise((k,C)=>{if(d){const L=new RTCSessionDescription(b);d.setRemoteDescription(L,()=>{d.createAnswer(B=>{d.setLocalDescription(B,function(){k(B)},C)},C,this._mediaConstraints)},C)}else C("peerconnection is null.")})}receiveAnswer(d,b){return new Promise(function(g,k){if(d){const C=new RTCSessionDescription(b);d.setRemoteDescription(C,g,k)}else k("peerconnection is null.")})}close(d){d&&(d.close(),d.onicecandidate=null,d.ontrack=null,d=null)}attachAudioOutput(d,b){return new Promise(function(g,k){typeof d.sinkId<"u"?d.setSinkId(b).then(g).catch(function(C){C.name==="SecurityError"?k("You need to use HTTPS for selecting audio output device: "+C):k(C)}):k("Element does not support output device selection.")})}mute(d,b){return new Promise(function(g,k){d?(d.getAudioTracks().forEach(function(C){C.enabled=!b}),g()):k("[mute] mediatream is null.")})}muteVideo(d,b){return new Promise(function(g,k){d?(d.getVideoTracks().forEach(function(C){C.enabled=!b}),g()):k("[muteVideo] mediatream is null.")})}_isSupport(){return!!navigator.mediaDevices.getUserMedia}_findLine(d,b,g){return this._findLineInRange(d,0,-1,b,g)}_findLineInRange(d,b,g,k,C){const L=g!==-1?g:d.length;for(let B=b;B<L;++B)if(d[B].indexOf(k)===0&&(!C||d[B].toLowerCase().indexOf(C.toLowerCase())!==-1))return B;return null}_getCodecPayloadType(d){const b=/a=rtpmap:(\d+) \w+\/\d+/,g=d.match(b);return g&&g.length===2?g[1]:null}_setVideoBitrate(d,b){const g=b,k=b,C=d.split(`\r
`),L=this._findLine(C,"a=rtpmap","H264/90000");let B;if(L&&(B=this._getCodecPayloadType(C[L])),!B)return d;let h=`\r
`;return h+="a=fmtp:"+B+" x-google-min-bitrate="+(g||"228")+"; x-google-max-bitrate="+(k||"228"),C[L]=C[L].concat(h),d=C.join(`\r
`),d}_updateBandwidthRestriction(d,b){if(!b||b==="unlimited")return d.replace(/b=AS:.*\r\n/,"").replace(/b=TIAS:.*\r\n/,"");{const g="AS";return d.indexOf("b="+g+":")===-1?d=d.replace(/a=mid:video\r\n/g,`a=mid:video\r
b=`+g+":"+b+`\r
`):d=d.replace(new RegExp("b="+g+`:.*\r
`),"b="+g+":"+b+`\r
`),d}}}const webrtc=new _webrtc,ID_OVERLAY="YomOverlay";function addOverlay(){var p=document.createElement("div");p.id=ID_OVERLAY,p.style.position="absolute",p.style.right="50px",p.style.bottom="100px",p.style.zIndex="9999",p.style.border="solid 2px black",p.style.backgroundColor="white",p.style.WebkitAppearance="auto",document.body.appendChild(p);const d=addOperationLayout();p.appendChild(d)}function addOperationLayout(){let p=document.createElement("div");p.id="myDiv",p.style.display="flex",p.style.flexDirection="column",p.style.justifyContent="start",p.style.alignItems="start",p.style.padding="20px";const d=document.createElement("input");d.type="datetime-local";const b=document.createElement("input");b.type="datetime-local";const g=new Date;b.value=formatLocalDate(g),g.setHours(g.getHours()-1),d.value=formatLocalDate(g),console.info("TimeInput ready",formatLocalDate(g)),console.info("TimeInput",d.value,b.value),p.appendChild(d),p.appendChild(b);let k=document.createElement("button");k.textContent="Export Console",k.style.margin="12px 0 0 0",k.style.padding="0 12px",k.style.WebkitAppearance="auto",k.onclick=function(){k.disabled=!0,k.textContent="Console downloading...";const h=d.value,m=b.value;exportConsoleData(h,m).then(()=>{k.disabled=!1,k.textContent="Export Console"})},p.appendChild(k);let C=document.createElement("button");C.textContent="Export Network",C.style.margin="12px 0 0 0",C.style.padding="0 12px",C.style.WebkitAppearance="auto",C.onclick=function(){C.disabled=!0,C.textContent="Network downloading...";const h=d.value,m=b.value;exportNetworkData(h,m).then(()=>{C.disabled=!1,C.textContent="Export Network"})},p.appendChild(C);let L=document.createElement("button");L.textContent="Record",L.style.margin="12px 0 0 0",L.style.padding="0 12px",L.style.WebkitAppearance="auto",L.onclick=async()=>{const h={audio:!0,video:{displaySurface:"window"}},m=await webrtc.getScreen(h);removeDivById(ID_OVERLAY),startRecordClick(m).then(async y=>{const{startTime:D,endTime:K}=y;console.log("startRecordClick then",D,K),await downloadRecord(D,K),await exportConsoleData(D,K),await exportNetworkData(D,K)})},p.appendChild(L);let B=document.createElement("button");return B.textContent="Close",B.style.margin="12px 0 0 0",B.style.padding="0 12px",B.style.WebkitAppearance="auto",B.onclick=function(){removeDivById(ID_OVERLAY)},p.appendChild(B),p}function removeDivById(p){var d=document.getElementById(p);console.log("removeDivById",d),d&&d.remove()}(function(p){typeof define=="function"&&define.amd?define(p):p()})(function(){(function(p){if(typeof exports=="object"&&typeof module<"u")module.exports=p();else if(typeof define=="function"&&define.amd)define([],p);else{var d;typeof window<"u"?d=window:typeof global<"u"?d=global:typeof self<"u"?d=self:d=this,d.EBML=p()}})(function(){return function(){function p(d,b,g){function k(B,h){if(!b[B]){if(!d[B]){var m=typeof require=="function"&&require;if(!h&&m)return m(B,!0);if(C)return C(B,!0);var y=new Error("Cannot find module '"+B+"'");throw y.code="MODULE_NOT_FOUND",y}var D=b[B]={exports:{}};d[B][0].call(D.exports,function(K){var Y=d[B][1][K];return k(Y||K)},D,D.exports,p,d,b,g)}return b[B].exports}for(var C=typeof require=="function"&&require,L=0;L<g.length;L++)k(g[L]);return k}return p}()({1:[function(p,d,b){Object.defineProperty(b,"__esModule",{value:!0});var g=p("./tools"),k=p("int64-buffer"),C=p("./tools"),L=p("matroska/lib/schema"),B=L.byEbmlID,h;(function(y){y[y.STATE_TAG=1]="STATE_TAG",y[y.STATE_SIZE=2]="STATE_SIZE",y[y.STATE_CONTENT=3]="STATE_CONTENT"})(h||(h={}));var m=function(){function y(){this._buffer=new g.Buffer(0),this._tag_stack=[],this._state=h.STATE_TAG,this._cursor=0,this._total=0,this._schema=B,this._result=[]}return y.prototype.decode=function(D){this.readChunk(D);var K=this._result;return this._result=[],K},y.prototype.readChunk=function(D){for(this._buffer=C.concat([this._buffer,new g.Buffer(D)]);this._cursor<this._buffer.length&&!(this._state===h.STATE_TAG&&!this.readTag()||this._state===h.STATE_SIZE&&!this.readSize()||this._state===h.STATE_CONTENT&&!this.readContent()););},y.prototype.getSchemaInfo=function(D){return this._schema[D]||{name:"unknown",level:-1,type:"unknown",description:"unknown"}},y.prototype.readTag=function(){if(this._cursor>=this._buffer.length)return!1;var D=g.readVint(this._buffer,this._cursor);if(D==null)return!1;var K=this._buffer.slice(this._cursor,this._cursor+D.length),Y=K.reduce(function(te,fe,ue,de){return te+fe*Math.pow(16,2*(de.length-1-ue))},0),W=this.getSchemaInfo(Y),ye={EBML_ID:Y.toString(16),schema:W,type:W.type,name:W.name,level:W.level,tagStart:this._total,tagEnd:this._total+D.length,sizeStart:this._total+D.length,sizeEnd:null,dataStart:null,dataEnd:null,dataSize:null,data:null};return this._tag_stack.push(ye),this._cursor+=D.length,this._total+=D.length,this._state=h.STATE_SIZE,!0},y.prototype.readSize=function(){if(this._cursor>=this._buffer.length)return!1;var D=g.readVint(this._buffer,this._cursor);if(D==null)return!1;var K=this._tag_stack[this._tag_stack.length-1];return K.sizeEnd=K.sizeStart+D.length,K.dataStart=K.sizeEnd,K.dataSize=D.value,D.value===-1?(K.dataEnd=-1,K.type==="m"&&(K.unknownSize=!0)):K.dataEnd=K.sizeEnd+D.value,this._cursor+=D.length,this._total+=D.length,this._state=h.STATE_CONTENT,!0},y.prototype.readContent=function(){var D=this._tag_stack[this._tag_stack.length-1];if(D.type==="m"){if(D.isEnd=!1,this._result.push(D),this._state=h.STATE_TAG,D.dataSize===0){var K=Object.assign({},D,{isEnd:!0});this._result.push(K),this._tag_stack.pop()}return!0}if(this._buffer.length<this._cursor+D.dataSize)return!1;var Y=this._buffer.slice(this._cursor,this._cursor+D.dataSize);switch(this._buffer=this._buffer.slice(this._cursor+D.dataSize),D.data=Y,D.type){case"u":D.value=Y.readUIntBE(0,Y.length);break;case"i":D.value=Y.readIntBE(0,Y.length);break;case"f":D.value=D.dataSize===4?Y.readFloatBE(0):D.dataSize===8?Y.readDoubleBE(0):(console.warn("cannot read "+D.dataSize+" octets float. failback to 0"),0);break;case"s":D.value=Y.toString("ascii");break;case"8":D.value=Y.toString("utf8");break;case"b":D.value=Y;break;case"d":D.value=g.convertEBMLDateToJSDate(new k.Int64BE(Y).toNumber());break}if(D.value===null)throw new Error("unknown tag type:"+D.type);for(this._result.push(D),this._total+=D.dataSize,this._state=h.STATE_TAG,this._cursor=0,this._tag_stack.pop();this._tag_stack.length>0;){var W=this._tag_stack[this._tag_stack.length-1];if(W.dataEnd<0)return this._tag_stack.pop(),!0;if(this._total<W.dataEnd)break;if(W.type!=="m")throw new Error("parent element is not master element");var K=Object.assign({},W,{isEnd:!0});this._result.push(K),this._tag_stack.pop()}return!0},y}();b.default=m},{"./tools":5,"int64-buffer":15,"matroska/lib/schema":17}],2:[function(p,d,b){Object.defineProperty(b,"__esModule",{value:!0});var g=p("./tools"),k=p("./tools"),C=p("matroska/lib/schema"),L=C.byEbmlID,B=function(){function h(){this._schema=L,this._buffers=[],this._stack=[]}return h.prototype.encode=function(m){var y=this;return g.concat(m.reduce(function(D,K){return D.concat(y.encodeChunk(K))},[])).buffer},h.prototype.encodeChunk=function(m){return m.type==="m"?m.isEnd?this.endTag(m):this.startTag(m):this.writeTag(m),this.flush()},h.prototype.flush=function(){var m=this._buffers;return this._buffers=[],m},h.prototype.getSchemaInfo=function(m){for(var y=Object.keys(this._schema).map(Number),D=0;D<y.length;D++){var K=y[D];if(this._schema[K].name===m)return new k.Buffer(K.toString(16),"hex")}return null},h.prototype.writeTag=function(m){var y=m.name,D=this.getSchemaInfo(y),K=m.data;if(D==null)throw new Error("No schema entry found for "+y);var Y=g.encodeTag(D,K);if(this._stack.length>0){var W=this._stack[this._stack.length-1];W.children.push({tagId:D,elm:m,children:[],data:Y});return}this._buffers=this._buffers.concat(Y)},h.prototype.startTag=function(m){var y=m.name,D=this.getSchemaInfo(y);if(D==null)throw new Error("No schema entry found for "+y);if(m.unknownSize){var K=g.encodeTag(D,new k.Buffer(0),m.unknownSize);this._buffers=this._buffers.concat(K);return}var Y={tagId:D,elm:m,children:[],data:null};this._stack.length>0&&this._stack[this._stack.length-1].children.push(Y),this._stack.push(Y)},h.prototype.endTag=function(m){m.name;var y=this._stack.pop();if(y==null)throw new Error("EBML structure is broken");if(y.elm.name!==m.name)throw new Error("EBML structure is broken");var D=y.children.reduce(function(Y,W){if(W.data===null)throw new Error("EBML structure is broken");return Y.concat(W.data)},[]),K=g.concat(D);y.elm.type==="m"?y.data=g.encodeTag(y.tagId,K,y.elm.unknownSize):y.data=g.encodeTag(y.tagId,K),this._stack.length<1&&(this._buffers=this._buffers.concat(y.data))},h}();b.default=B},{"./tools":5,"matroska/lib/schema":17}],3:[function(p,d,b){var g=this&&this.__extends||function(){var B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,m){h.__proto__=m}||function(h,m){for(var y in m)m.hasOwnProperty(y)&&(h[y]=m[y])};return function(h,m){B(h,m);function y(){this.constructor=h}h.prototype=m===null?Object.create(m):(y.prototype=m.prototype,new y)}}();Object.defineProperty(b,"__esModule",{value:!0});var k=p("events"),C=p("./tools"),L=function(B){g(h,B);function h(){var m=B.call(this)||this;return m.logGroup="",m.hasLoggingStarted=!1,m.metadataloaded=!1,m.chunks=[],m.stack=[],m.segmentOffset=0,m.last2SimpleBlockVideoTrackTimecode=[0,0],m.last2SimpleBlockAudioTrackTimecode=[0,0],m.lastClusterTimecode=0,m.lastClusterPosition=0,m.timecodeScale=1e6,m.metadataSize=0,m.metadatas=[],m.cues=[],m.firstVideoBlockRead=!1,m.firstAudioBlockRead=!1,m.currentTrack={TrackNumber:-1,TrackType:-1,DefaultDuration:null,CodecDelay:null},m.trackTypes=[],m.trackDefaultDuration=[],m.trackCodecDelay=[],m.trackInfo={type:"nothing"},m.ended=!1,m.logging=!1,m.use_duration_every_simpleblock=!1,m.use_webp=!1,m.use_segment_info=!0,m.drop_default_duration=!0,m}return h.prototype.stop=function(){for(this.ended=!0,this.emit_segment_info();this.stack.length;)this.stack.pop(),this.logging&&console.groupEnd();this.logging&&this.hasLoggingStarted&&this.logGroup&&console.groupEnd()},h.prototype.emit_segment_info=function(){var m=this.chunks;if(this.chunks=[],this.metadataloaded){if(!this.use_segment_info)return;var y=this.lastClusterTimecode,D=this.duration,K=this.timecodeScale;this.emit("cluster",{timecode:y,data:m}),this.emit("duration",{timecodeScale:K,duration:D})}else{this.metadataloaded=!0,this.metadatas=m;var Y=this.trackTypes.indexOf(1),W=this.trackTypes.indexOf(2);if(this.trackInfo=Y>=0&&W>=0?{type:"both",trackNumber:Y}:Y>=0?{type:"video",trackNumber:Y}:W>=0?{type:"audio",trackNumber:W}:{type:"nothing"},!this.use_segment_info)return;this.emit("metadata",{data:m,metadataSize:this.metadataSize})}},h.prototype.read=function(m){var y=this,D=!1;if(!this.ended){if(m.type==="m")if(m.isEnd)this.stack.pop();else{var K=this.stack[this.stack.length-1];if(K!=null&&K.level>=m.level){this.stack.pop(),this.logging&&console.groupEnd(),K.dataEnd=m.dataEnd,K.dataSize=m.dataEnd-K.dataStart,K.unknownSize=!1;var Y=Object.assign({},K,{name:K.name,type:K.type,isEnd:!0});this.chunks.push(Y)}this.stack.push(m)}if(m.type==="m"&&m.name=="Segment")this.segmentOffset!=0&&console.warn("Multiple segments detected!"),this.segmentOffset=m.dataStart,this.emit("segment_offset",this.segmentOffset);else if(m.type==="b"&&m.name==="SimpleBlock"){var W=C.ebmlBlock(m.data),ye=W.timecode,te=W.trackNumber,fe=W.frames;if(this.trackTypes[te]===1){if(!this.firstVideoBlockRead&&(this.firstVideoBlockRead=!0,this.trackInfo.type==="both"||this.trackInfo.type==="video")){var ue=this.lastClusterTimecode+ye;this.cues.push({CueTrack:te,CueClusterPosition:this.lastClusterPosition,CueTime:ue}),this.emit("cue_info",{CueTrack:te,CueClusterPosition:this.lastClusterPosition,CueTime:this.lastClusterTimecode}),this.emit("cue",{CueTrack:te,CueClusterPosition:this.lastClusterPosition,CueTime:ue})}this.last2SimpleBlockVideoTrackTimecode=[this.last2SimpleBlockVideoTrackTimecode[1],ye]}else if(this.trackTypes[te]===2){if(!this.firstAudioBlockRead&&(this.firstAudioBlockRead=!0,this.trackInfo.type==="audio")){var ue=this.lastClusterTimecode+ye;this.cues.push({CueTrack:te,CueClusterPosition:this.lastClusterPosition,CueTime:ue}),this.emit("cue_info",{CueTrack:te,CueClusterPosition:this.lastClusterPosition,CueTime:this.lastClusterTimecode}),this.emit("cue",{CueTrack:te,CueClusterPosition:this.lastClusterPosition,CueTime:ue})}this.last2SimpleBlockAudioTrackTimecode=[this.last2SimpleBlockAudioTrackTimecode[1],ye]}this.use_duration_every_simpleblock&&this.emit("duration",{timecodeScale:this.timecodeScale,duration:this.duration}),this.use_webp&&fe.forEach(function(de){var Me=de.slice(3,6).toString("hex");if(Me==="9d012a"){var De=C.VP8BitStreamToRiffWebPBuffer(de),Ie=new Blob([De],{type:"image/webp"}),Ee=y.duration;y.emit("webp",{currentTime:Ee,webp:Ie})}})}else m.type==="m"&&m.name==="Cluster"&&m.isEnd===!1?(this.firstVideoBlockRead=!1,this.firstAudioBlockRead=!1,this.emit_segment_info(),this.emit("cluster_ptr",m.tagStart),this.lastClusterPosition=m.tagStart):m.type==="u"&&m.name==="Timecode"?this.lastClusterTimecode=m.value:m.type==="u"&&m.name==="TimecodeScale"?this.timecodeScale=m.value:m.type==="m"&&m.name==="TrackEntry"?m.isEnd?(this.trackTypes[this.currentTrack.TrackNumber]=this.currentTrack.TrackType,this.trackDefaultDuration[this.currentTrack.TrackNumber]=this.currentTrack.DefaultDuration,this.trackCodecDelay[this.currentTrack.TrackNumber]=this.currentTrack.CodecDelay):this.currentTrack={TrackNumber:-1,TrackType:-1,DefaultDuration:null,CodecDelay:null}:m.type==="u"&&m.name==="TrackType"?this.currentTrack.TrackType=m.value:m.type==="u"&&m.name==="TrackNumber"?this.currentTrack.TrackNumber=m.value:m.type==="u"&&m.name==="CodecDelay"?this.currentTrack.CodecDelay=m.value:m.type==="u"&&m.name==="DefaultDuration"?this.drop_default_duration?(console.warn("DefaultDuration detected!, remove it"),D=!0):this.currentTrack.DefaultDuration=m.value:m.name==="unknown"&&console.warn(m);!this.metadataloaded&&m.dataEnd>0&&(this.metadataSize=m.dataEnd),D||this.chunks.push(m),this.logging&&this.put(m)}},Object.defineProperty(h.prototype,"duration",{get:function(){if(this.trackInfo.type==="nothing")return console.warn("no video, no audio track"),0;var m=0,y=0,D=0,K=this.trackDefaultDuration[this.trackInfo.trackNumber];if(typeof K=="number")m=K;else if(this.trackInfo.type==="both")if(this.last2SimpleBlockAudioTrackTimecode[1]>this.last2SimpleBlockVideoTrackTimecode[1]){m=(this.last2SimpleBlockAudioTrackTimecode[1]-this.last2SimpleBlockAudioTrackTimecode[0])*this.timecodeScale;var Y=this.trackCodecDelay[this.trackTypes.indexOf(2)];typeof Y=="number"&&(y=Y),D=this.last2SimpleBlockAudioTrackTimecode[1]}else{m=(this.last2SimpleBlockVideoTrackTimecode[1]-this.last2SimpleBlockVideoTrackTimecode[0])*this.timecodeScale;var Y=this.trackCodecDelay[this.trackTypes.indexOf(1)];typeof Y=="number"&&(y=Y),D=this.last2SimpleBlockVideoTrackTimecode[1]}else if(this.trackInfo.type==="video"){m=(this.last2SimpleBlockVideoTrackTimecode[1]-this.last2SimpleBlockVideoTrackTimecode[0])*this.timecodeScale;var Y=this.trackCodecDelay[this.trackInfo.trackNumber];typeof Y=="number"&&(y=Y),D=this.last2SimpleBlockVideoTrackTimecode[1]}else if(this.trackInfo.type==="audio"){m=(this.last2SimpleBlockAudioTrackTimecode[1]-this.last2SimpleBlockAudioTrackTimecode[0])*this.timecodeScale;var Y=this.trackCodecDelay[this.trackInfo.trackNumber];typeof Y=="number"&&(y=Y),D=this.last2SimpleBlockAudioTrackTimecode[1]}var W=(this.lastClusterTimecode+D)*this.timecodeScale+m-y,ye=W/this.timecodeScale;return Math.floor(ye)},enumerable:!0,configurable:!0}),h.prototype.addListener=function(m,y){return B.prototype.addListener.call(this,m,y)},h.prototype.put=function(m){this.hasLoggingStarted||(this.hasLoggingStarted=!0,this.logging&&this.logGroup&&console.groupCollapsed(this.logGroup)),m.type==="m"?m.isEnd?console.groupEnd():console.group(m.name+":"+m.tagStart):m.type==="b"?console.log(m.name,m.type):console.log(m.name,m.tagStart,m.type,m.value)},h}(k.EventEmitter);b.default=L},{"./tools":5,events:13}],4:[function(p,d,b){Object.defineProperty(b,"__esModule",{value:!0});var g=p("./EBMLDecoder");b.Decoder=g.default;var k=p("./EBMLEncoder");b.Encoder=k.default;var C=p("./EBMLReader");b.Reader=C.default;var L=p("./tools");b.tools=L;var B=p("../package.json").version;b.version=B},{"../package.json":18,"./EBMLDecoder":1,"./EBMLEncoder":2,"./EBMLReader":3,"./tools":5}],5:[function(p,d,b){Object.defineProperty(b,"__esModule",{value:!0});var g=p("int64-buffer"),k=p("./EBMLEncoder"),C=p("buffer/"),L=p("ebml/lib/ebml/tools"),B=p("ebml-block");b.Buffer=C.Buffer,b.readVint=L.readVint,b.writeVint=L.writeVint,b.ebmlBlock=B;function h($){return b.ebmlBlock(new b.Buffer($))}b.readBlock=h;function m($,X,G){return G===void 0&&(G=!1),Ee([$,G?new b.Buffer("01ffffffffffffff","hex"):b.writeVint(X.length),X])}b.encodeTag=m;function y($){return D($).reduce(function(X,G){var ae=b.ebmlBlock(G.data);return ae.frames.reduce(function(ge,we){var Be=K(we),Re=new Blob([Be],{type:"image/webp"});return ge.concat(Re)},X)},[])}b.WebPFrameFilter=y;function D($){return $.reduce(function(X,G){if(G.type!=="b"||G.name!=="SimpleBlock")return X;var ae=b.ebmlBlock(G.data),ge=ae.frames.some(function(we){var Be=we.slice(3,6).toString("hex");return Be==="9d012a"});return ge?X.concat(G):X},[])}b.WebPBlockFilter=D;function K($){var X=Y("VP8 ",$),G=Ee([new b.Buffer("WEBP","ascii"),X]);return Y("RIFF",G)}b.VP8BitStreamToRiffWebPBuffer=K;function Y($,X){var G=new b.Buffer(4);return G.writeUInt32LE(X.byteLength,0),Ee([new b.Buffer($.substr(0,4),"ascii"),G,X,new b.Buffer(X.byteLength%2===0?0:1)])}b.createRIFFChunk=Y;function W($,X,G){var ae=te("EBML",$),ge=ue(ae),we=ge+12,Be=$[$.length-1].dataEnd-we,Re=te("Info",$);ye("Duration",Re),Re.splice(1,0,{name:"Duration",type:"f",data:ce(X,8)});for(var $e=ue(Re),Pe=te("Tracks",$),Ue=ue(Pe),Ae=47,ve=[],He=5+G.length*15,Fe=[],nt=-1,oe=10,Ze=function(le){var qe=Ae,o=qe+$e,s=o+Ue,f=s+He,A=f-Be;if(ve=[],ve.push({name:"SeekHead",type:"m",isEnd:!1}),ve.push({name:"Seek",type:"m",isEnd:!1}),ve.push({name:"SeekID",type:"b",data:new b.Buffer([21,73,169,102])}),ve.push({name:"SeekPosition",type:"u",data:Xe(qe)}),ve.push({name:"Seek",type:"m",isEnd:!0}),ve.push({name:"Seek",type:"m",isEnd:!1}),ve.push({name:"SeekID",type:"b",data:new b.Buffer([22,84,174,107])}),ve.push({name:"SeekPosition",type:"u",data:Xe(o)}),ve.push({name:"Seek",type:"m",isEnd:!0}),ve.push({name:"Seek",type:"m",isEnd:!1}),ve.push({name:"SeekID",type:"b",data:new b.Buffer([28,83,187,107])}),ve.push({name:"SeekPosition",type:"u",data:Xe(s)}),ve.push({name:"Seek",type:"m",isEnd:!0}),ve.push({name:"SeekHead",type:"m",isEnd:!0}),Ae=ue(ve),Fe=[],Fe.push({name:"Cues",type:"m",isEnd:!1}),G.forEach(function(n){var i=n.CueTrack,c=n.CueClusterPosition,_=n.CueTime;Fe.push({name:"CuePoint",type:"m",isEnd:!1}),Fe.push({name:"CueTime",type:"u",data:Xe(_)}),Fe.push({name:"CueTrackPositions",type:"m",isEnd:!1}),Fe.push({name:"CueTrack",type:"u",data:Xe(i)}),c-=we,c+=A,Fe.push({name:"CueClusterPosition",type:"u",data:Xe(c)}),Fe.push({name:"CueTrackPositions",type:"m",isEnd:!0}),Fe.push({name:"CuePoint",type:"m",isEnd:!0})}),Fe.push({name:"Cues",type:"m",isEnd:!0}),He=ue(Fe),nt!==A){if(nt=A,le===oe-1)throw new Error("Failed to converge to a stable metadata size")}else return"break"},Qe=0;Qe<oe;Qe++){var ie=Ze(Qe);if(ie==="break")break}var he=[].concat.apply([],[ae,{name:"Segment",type:"m",isEnd:!1,unknownSize:!0},ve,Re,Pe,Fe]),pe=new k.default().encode(he);return pe}b.makeMetadataSeekable=W;function ye($,X){for(var G=-1,ae=0;ae<X.length;ae++){var ge=X[ae];if(ge.name===$)if(ge.type==="m")if(!ge.isEnd)G=ae;else{if(G==-1)throw new Error("Detected "+$+" closing element before finding the start");X.splice(G,ae-G+1);return}else{X.splice(ae,1);return}}}b.removeElement=ye;function te($,X){for(var G=[],ae=-1,ge=0;ge<X.length;ge++){var we=X[ge];if(we.name===$)if(we.type==="m")if(!we.isEnd)ae=ge;else{if(ae==-1)throw new Error("Detected "+$+" closing element before finding the start");G=X.slice(ae,ge+1);break}else{G.push(X[ge]);break}}return G}b.extractElement=te;function fe($,X){Array.isArray(X.cueInfos)&&!Array.isArray(X.cues)&&(console.warn("putRefinedMetaData: info.cueInfos property is deprecated. please use info.cues"),X.cues=X.cueInfos);for(var G=[],ae=[],ge=0;ge<$.length;ge++){var we=$[ge];if(we.type==="m"&&we.name==="Segment"){if(G=$.slice(0,ge),ae=$.slice(ge),we.unknownSize){ae.shift();break}throw new Error("this metadata is not streaming webm file")}}if(!(ae[ae.length-1].dataEnd>0))throw new Error("metadata dataEnd has wrong number");var Be=ae[ae.length-1].dataEnd,Re=G[G.length-1].dataEnd,$e=new k.default().encode(G).byteLength,Pe=$e-Re,Ue=Be-ae[0].tagStart;ae[0].tagStart-Re,ae[0].tagStart;var Ae=new b.Buffer([24,83,128,103]),ve=new b.Buffer("01ffffffffffffff","hex"),He=Ae.byteLength+ve.byteLength,Fe=Ue,nt;for(nt=1;nt<20;nt++){var oe=Re+He+Fe,Ze=oe-Be,Qe=Pe+Ze,ie=de(ae,Qe,X),he=new k.default().encode(ie).byteLength;if(he===Fe)return new k.default().encode([].concat(G,[{type:"m",name:"Segment",isEnd:!1,unknownSize:!0}],ie));Fe=he}throw new Error("unable to refine metadata, stable size could not be found in "+nt+" iterations!")}b.putRefinedMetaData=fe;function ue($){var X=new k.default;return $.reduce(function(G,ae){return G.concat(X.encode([ae]))},[]).reduce(function(G,ae){return G+ae.byteLength},0)}function de($,X,G){var ae=G.duration,ge=G.clusterPtrs,we=G.cues,Be=$.slice(0);if(typeof ae=="number"){var Re=!1;Be.forEach(function(Pe){Pe.type==="f"&&Pe.name==="Duration"&&(Re=!0,Pe.data=ce(ae,8))}),Re||Ie(Be,"Info",[{name:"Duration",type:"f",data:ce(ae,8)}])}Array.isArray(we)&&Ie(Be,"Cues",De(we,X));var $e=[];return Array.isArray(ge)&&(console.warn("append cluster pointers to seekhead is deprecated. please use cues"),$e=Me(ge,X)),Ie(Be,"SeekHead",$e,!0),Be}function Me($,X){var G=[];return $.forEach(function(ae){G.push({name:"Seek",type:"m",isEnd:!1}),G.push({name:"SeekID",type:"b",data:new b.Buffer([31,67,182,117])}),G.push({name:"SeekPosition",type:"u",data:Xe(ae+X)}),G.push({name:"Seek",type:"m",isEnd:!0})}),G}function De($,X){var G=[];return $.forEach(function(ae){var ge=ae.CueTrack,we=ae.CueClusterPosition,Be=ae.CueTime;G.push({name:"CuePoint",type:"m",isEnd:!1}),G.push({name:"CueTime",type:"u",data:Xe(Be)}),G.push({name:"CueTrackPositions",type:"m",isEnd:!1}),G.push({name:"CueTrack",type:"u",data:Xe(ge)}),G.push({name:"CueClusterPosition",type:"u",data:Xe(we+X)}),G.push({name:"CueTrackPositions",type:"m",isEnd:!0}),G.push({name:"CuePoint",type:"m",isEnd:!0})}),G}function Ie($,X,G,ae){ae===void 0&&(ae=!1);for(var ge=-1,we=0;we<$.length;we++){var Be=$[we];if(Be.type==="m"&&Be.name===X&&Be.isEnd===!1){ge=we;break}}ge>=0?Array.prototype.splice.apply($,[ge+1,0].concat(G)):ae?[].concat([{name:X,type:"m",isEnd:!1}],G,[{name:X,type:"m",isEnd:!0}]).reverse().forEach(function(Re){$.unshift(Re)}):($.push({name:X,type:"m",isEnd:!1}),G.forEach(function(Re){$.push(Re)}),$.push({name:X,type:"m",isEnd:!0}))}function Ee($){for(var X=0,G=0;X<$.length;++X)G+=$[X].length;var ae=b.Buffer.allocUnsafe(G),ge=0;for(X=0;X<$.length;++X){var we=$[X];we.copy(ae,ge),ge+=we.length}return ae}b.concat=Ee;function Ye($){var X=new b.Buffer(0);if($.type==="m")return $;switch($.type){case"u":X=Xe($.value);break;case"i":X=Se($.value);break;case"f":X=ce($.value);break;case"s":X=new b.Buffer($.value,"ascii");break;case"8":X=new b.Buffer($.value,"utf8");break;case"b":X=$.value;break;case"d":X=new g.Int64BE($.value.getTime().toString()).toBuffer();break}return Object.assign({},$,{data:X})}b.encodeValueToBuffer=Ye;function Xe($){for(var X=1;$>=Math.pow(2,8*X);X++);if(X>=7)return console.warn("7bit or more bigger uint not supported."),new g.Uint64BE($).toBuffer();var G=new b.Buffer(X);return G.writeUIntBE($,0,X),G}b.createUIntBuffer=Xe;function Se($){for(var X=1;$>=Math.pow(2,8*X);X++);if(X>=7)return console.warn("7bit or more bigger uint not supported."),new g.Int64BE($).toBuffer();var G=new b.Buffer(X);return G.writeIntBE($,0,X),G}b.createIntBuffer=Se;function ce($,X){if(X===void 0&&(X=8),X===8){var G=new b.Buffer(8);return G.writeDoubleBE($,0),G}else if(X===4){var G=new b.Buffer(4);return G.writeFloatBE($,0),G}else throw new Error("float type bits must 4bytes or 8bytes")}b.createFloatBuffer=ce;function be($){return $ instanceof Date?$:new Date(new Date("2001-01-01T00:00:00.000Z").getTime()+Number($)/1e3/1e3)}b.convertEBMLDateToJSDate=be},{"./EBMLEncoder":2,"buffer/":8,"ebml-block":9,"ebml/lib/ebml/tools":12,"int64-buffer":15}],6:[function(p,d,b){b.byteLength=y,b.toByteArray=K,b.fromByteArray=ye;for(var g=[],k=[],C=typeof Uint8Array<"u"?Uint8Array:Array,L="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",B=0,h=L.length;B<h;++B)g[B]=L[B],k[L.charCodeAt(B)]=B;k[45]=62,k[95]=63;function m(te){var fe=te.length;if(fe%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var ue=te.indexOf("=");ue===-1&&(ue=fe);var de=ue===fe?0:4-ue%4;return[ue,de]}function y(te){var fe=m(te),ue=fe[0],de=fe[1];return(ue+de)*3/4-de}function D(te,fe,ue){return(fe+ue)*3/4-ue}function K(te){for(var fe,ue=m(te),de=ue[0],Me=ue[1],De=new C(D(te,de,Me)),Ie=0,Ee=Me>0?de-4:de,Ye=0;Ye<Ee;Ye+=4)fe=k[te.charCodeAt(Ye)]<<18|k[te.charCodeAt(Ye+1)]<<12|k[te.charCodeAt(Ye+2)]<<6|k[te.charCodeAt(Ye+3)],De[Ie++]=fe>>16&255,De[Ie++]=fe>>8&255,De[Ie++]=fe&255;return Me===2&&(fe=k[te.charCodeAt(Ye)]<<2|k[te.charCodeAt(Ye+1)]>>4,De[Ie++]=fe&255),Me===1&&(fe=k[te.charCodeAt(Ye)]<<10|k[te.charCodeAt(Ye+1)]<<4|k[te.charCodeAt(Ye+2)]>>2,De[Ie++]=fe>>8&255,De[Ie++]=fe&255),De}function Y(te){return g[te>>18&63]+g[te>>12&63]+g[te>>6&63]+g[te&63]}function W(te,fe,ue){for(var de,Me=[],De=fe;De<ue;De+=3)de=(te[De]<<16&16711680)+(te[De+1]<<8&65280)+(te[De+2]&255),Me.push(Y(de));return Me.join("")}function ye(te){for(var fe,ue=te.length,de=ue%3,Me=[],De=16383,Ie=0,Ee=ue-de;Ie<Ee;Ie+=De)Me.push(W(te,Ie,Ie+De>Ee?Ee:Ie+De));return de===1?(fe=te[ue-1],Me.push(g[fe>>2]+g[fe<<4&63]+"==")):de===2&&(fe=(te[ue-2]<<8)+te[ue-1],Me.push(g[fe>>10]+g[fe>>4&63]+g[fe<<2&63]+"=")),Me.join("")}},{}],7:[function(p,d,b){(function(g){var k=p("base64-js"),C=p("ieee754"),L=p("isarray");b.Buffer=y,b.SlowBuffer=Me,b.INSPECT_MAX_BYTES=50,y.TYPED_ARRAY_SUPPORT=g.TYPED_ARRAY_SUPPORT!==void 0?g.TYPED_ARRAY_SUPPORT:B(),b.kMaxLength=h();function B(){try{var n=new Uint8Array(1);return n.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},n.foo()===42&&typeof n.subarray=="function"&&n.subarray(1,1).byteLength===0}catch{return!1}}function h(){return y.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function m(n,i){if(h()<i)throw new RangeError("Invalid typed array length");return y.TYPED_ARRAY_SUPPORT?(n=new Uint8Array(i),n.__proto__=y.prototype):(n===null&&(n=new y(i)),n.length=i),n}function y(n,i,c){if(!y.TYPED_ARRAY_SUPPORT&&!(this instanceof y))return new y(n,i,c);if(typeof n=="number"){if(typeof i=="string")throw new Error("If encoding is specified then the first argument must be a string");return W(this,n)}return D(this,n,i,c)}y.poolSize=8192,y._augment=function(n){return n.__proto__=y.prototype,n};function D(n,i,c,_){if(typeof i=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&i instanceof ArrayBuffer?fe(n,i,c,_):typeof i=="string"?ye(n,i,c):ue(n,i)}y.from=function(n,i,c){return D(null,n,i,c)},y.TYPED_ARRAY_SUPPORT&&(y.prototype.__proto__=Uint8Array.prototype,y.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&y[Symbol.species]===y&&Object.defineProperty(y,Symbol.species,{value:null,configurable:!0}));function K(n){if(typeof n!="number")throw new TypeError('"size" argument must be a number');if(n<0)throw new RangeError('"size" argument must not be negative')}function Y(n,i,c,_){return K(i),i<=0?m(n,i):c!==void 0?typeof _=="string"?m(n,i).fill(c,_):m(n,i).fill(c):m(n,i)}y.alloc=function(n,i,c){return Y(null,n,i,c)};function W(n,i){if(K(i),n=m(n,i<0?0:de(i)|0),!y.TYPED_ARRAY_SUPPORT)for(var c=0;c<i;++c)n[c]=0;return n}y.allocUnsafe=function(n){return W(null,n)},y.allocUnsafeSlow=function(n){return W(null,n)};function ye(n,i,c){if((typeof c!="string"||c==="")&&(c="utf8"),!y.isEncoding(c))throw new TypeError('"encoding" must be a valid string encoding');var _=De(i,c)|0;n=m(n,_);var j=n.write(i,c);return j!==_&&(n=n.slice(0,j)),n}function te(n,i){var c=i.length<0?0:de(i.length)|0;n=m(n,c);for(var _=0;_<c;_+=1)n[_]=i[_]&255;return n}function fe(n,i,c,_){if(i.byteLength,c<0||i.byteLength<c)throw new RangeError("'offset' is out of bounds");if(i.byteLength<c+(_||0))throw new RangeError("'length' is out of bounds");return c===void 0&&_===void 0?i=new Uint8Array(i):_===void 0?i=new Uint8Array(i,c):i=new Uint8Array(i,c,_),y.TYPED_ARRAY_SUPPORT?(n=i,n.__proto__=y.prototype):n=te(n,i),n}function ue(n,i){if(y.isBuffer(i)){var c=de(i.length)|0;return n=m(n,c),n.length===0||i.copy(n,0,0,c),n}if(i){if(typeof ArrayBuffer<"u"&&i.buffer instanceof ArrayBuffer||"length"in i)return typeof i.length!="number"||A(i.length)?m(n,0):te(n,i);if(i.type==="Buffer"&&L(i.data))return te(n,i.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function de(n){if(n>=h())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+h().toString(16)+" bytes");return n|0}function Me(n){return+n!=n&&(n=0),y.alloc(+n)}y.isBuffer=function(n){return!!(n!=null&&n._isBuffer)},y.compare=function(n,i){if(!y.isBuffer(n)||!y.isBuffer(i))throw new TypeError("Arguments must be Buffers");if(n===i)return 0;for(var c=n.length,_=i.length,j=0,M=Math.min(c,_);j<M;++j)if(n[j]!==i[j]){c=n[j],_=i[j];break}return c<_?-1:_<c?1:0},y.isEncoding=function(n){switch(String(n).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},y.concat=function(n,i){if(!L(n))throw new TypeError('"list" argument must be an Array of Buffers');if(n.length===0)return y.alloc(0);var c;if(i===void 0)for(i=0,c=0;c<n.length;++c)i+=n[c].length;var _=y.allocUnsafe(i),j=0;for(c=0;c<n.length;++c){var M=n[c];if(!y.isBuffer(M))throw new TypeError('"list" argument must be an Array of Buffers');M.copy(_,j),j+=M.length}return _};function De(n,i){if(y.isBuffer(n))return n.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(n)||n instanceof ArrayBuffer))return n.byteLength;typeof n!="string"&&(n=""+n);var c=n.length;if(c===0)return 0;for(var _=!1;;)switch(i){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":case void 0:return le(n).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return c*2;case"hex":return c>>>1;case"base64":return s(n).length;default:if(_)return le(n).length;i=(""+i).toLowerCase(),_=!0}}y.byteLength=De;function Ie(n,i,c){var _=!1;if((i===void 0||i<0)&&(i=0),i>this.length||((c===void 0||c>this.length)&&(c=this.length),c<=0)||(c>>>=0,i>>>=0,c<=i))return"";for(n||(n="utf8");;)switch(n){case"hex":return Pe(this,i,c);case"utf8":case"utf-8":return ge(this,i,c);case"ascii":return Re(this,i,c);case"latin1":case"binary":return $e(this,i,c);case"base64":return ae(this,i,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ue(this,i,c);default:if(_)throw new TypeError("Unknown encoding: "+n);n=(n+"").toLowerCase(),_=!0}}y.prototype._isBuffer=!0;function Ee(n,i,c){var _=n[i];n[i]=n[c],n[c]=_}y.prototype.swap16=function(){var n=this.length;if(n%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<n;i+=2)Ee(this,i,i+1);return this},y.prototype.swap32=function(){var n=this.length;if(n%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<n;i+=4)Ee(this,i,i+3),Ee(this,i+1,i+2);return this},y.prototype.swap64=function(){var n=this.length;if(n%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<n;i+=8)Ee(this,i,i+7),Ee(this,i+1,i+6),Ee(this,i+2,i+5),Ee(this,i+3,i+4);return this},y.prototype.toString=function(){var n=this.length|0;return n===0?"":arguments.length===0?ge(this,0,n):Ie.apply(this,arguments)},y.prototype.equals=function(n){if(!y.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n?!0:y.compare(this,n)===0},y.prototype.inspect=function(){var n="",i=b.INSPECT_MAX_BYTES;return this.length>0&&(n=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(n+=" ... ")),"<Buffer "+n+">"},y.prototype.compare=function(n,i,c,_,j){if(!y.isBuffer(n))throw new TypeError("Argument must be a Buffer");if(i===void 0&&(i=0),c===void 0&&(c=n?n.length:0),_===void 0&&(_=0),j===void 0&&(j=this.length),i<0||c>n.length||_<0||j>this.length)throw new RangeError("out of range index");if(_>=j&&i>=c)return 0;if(_>=j)return-1;if(i>=c)return 1;if(i>>>=0,c>>>=0,_>>>=0,j>>>=0,this===n)return 0;for(var M=j-_,Q=c-i,me=Math.min(M,Q),Ve=this.slice(_,j),Oe=n.slice(i,c),Le=0;Le<me;++Le)if(Ve[Le]!==Oe[Le]){M=Ve[Le],Q=Oe[Le];break}return M<Q?-1:Q<M?1:0};function Ye(n,i,c,_,j){if(n.length===0)return-1;if(typeof c=="string"?(_=c,c=0):c>2147483647?c=2147483647:c<-2147483648&&(c=-2147483648),c=+c,isNaN(c)&&(c=j?0:n.length-1),c<0&&(c=n.length+c),c>=n.length){if(j)return-1;c=n.length-1}else if(c<0)if(j)c=0;else return-1;if(typeof i=="string"&&(i=y.from(i,_)),y.isBuffer(i))return i.length===0?-1:Xe(n,i,c,_,j);if(typeof i=="number")return i=i&255,y.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?j?Uint8Array.prototype.indexOf.call(n,i,c):Uint8Array.prototype.lastIndexOf.call(n,i,c):Xe(n,[i],c,_,j);throw new TypeError("val must be string, number or Buffer")}function Xe(n,i,c,_,j){var M=1,Q=n.length,me=i.length;if(_!==void 0&&(_=String(_).toLowerCase(),_==="ucs2"||_==="ucs-2"||_==="utf16le"||_==="utf-16le")){if(n.length<2||i.length<2)return-1;M=2,Q/=2,me/=2,c/=2}function Ve(ct,se){return M===1?ct[se]:ct.readUInt16BE(se*M)}var Oe;if(j){var Le=-1;for(Oe=c;Oe<Q;Oe++)if(Ve(n,Oe)===Ve(i,Le===-1?0:Oe-Le)){if(Le===-1&&(Le=Oe),Oe-Le+1===me)return Le*M}else Le!==-1&&(Oe-=Oe-Le),Le=-1}else for(c+me>Q&&(c=Q-me),Oe=c;Oe>=0;Oe--){for(var Je=!0,gt=0;gt<me;gt++)if(Ve(n,Oe+gt)!==Ve(i,gt)){Je=!1;break}if(Je)return Oe}return-1}y.prototype.includes=function(n,i,c){return this.indexOf(n,i,c)!==-1},y.prototype.indexOf=function(n,i,c){return Ye(this,n,i,c,!0)},y.prototype.lastIndexOf=function(n,i,c){return Ye(this,n,i,c,!1)};function Se(n,i,c,_){c=Number(c)||0;var j=n.length-c;_?(_=Number(_),_>j&&(_=j)):_=j;var M=i.length;if(M%2!==0)throw new TypeError("Invalid hex string");_>M/2&&(_=M/2);for(var Q=0;Q<_;++Q){var me=parseInt(i.substr(Q*2,2),16);if(isNaN(me))return Q;n[c+Q]=me}return Q}function ce(n,i,c,_){return f(le(i,n.length-c),n,c,_)}function be(n,i,c,_){return f(qe(i),n,c,_)}function $(n,i,c,_){return be(n,i,c,_)}function X(n,i,c,_){return f(s(i),n,c,_)}function G(n,i,c,_){return f(o(i,n.length-c),n,c,_)}y.prototype.write=function(n,i,c,_){if(i===void 0)_="utf8",c=this.length,i=0;else if(c===void 0&&typeof i=="string")_=i,c=this.length,i=0;else if(isFinite(i))i=i|0,isFinite(c)?(c=c|0,_===void 0&&(_="utf8")):(_=c,c=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var j=this.length-i;if((c===void 0||c>j)&&(c=j),n.length>0&&(c<0||i<0)||i>this.length)throw new RangeError("Attempt to write outside buffer bounds");_||(_="utf8");for(var M=!1;;)switch(_){case"hex":return Se(this,n,i,c);case"utf8":case"utf-8":return ce(this,n,i,c);case"ascii":return be(this,n,i,c);case"latin1":case"binary":return $(this,n,i,c);case"base64":return X(this,n,i,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,n,i,c);default:if(M)throw new TypeError("Unknown encoding: "+_);_=(""+_).toLowerCase(),M=!0}},y.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ae(n,i,c){return i===0&&c===n.length?k.fromByteArray(n):k.fromByteArray(n.slice(i,c))}function ge(n,i,c){c=Math.min(n.length,c);for(var _=[],j=i;j<c;){var M=n[j],Q=null,me=M>239?4:M>223?3:M>191?2:1;if(j+me<=c){var Ve,Oe,Le,Je;switch(me){case 1:M<128&&(Q=M);break;case 2:Ve=n[j+1],(Ve&192)===128&&(Je=(M&31)<<6|Ve&63,Je>127&&(Q=Je));break;case 3:Ve=n[j+1],Oe=n[j+2],(Ve&192)===128&&(Oe&192)===128&&(Je=(M&15)<<12|(Ve&63)<<6|Oe&63,Je>2047&&(Je<55296||Je>57343)&&(Q=Je));break;case 4:Ve=n[j+1],Oe=n[j+2],Le=n[j+3],(Ve&192)===128&&(Oe&192)===128&&(Le&192)===128&&(Je=(M&15)<<18|(Ve&63)<<12|(Oe&63)<<6|Le&63,Je>65535&&Je<1114112&&(Q=Je))}}Q===null?(Q=65533,me=1):Q>65535&&(Q-=65536,_.push(Q>>>10&1023|55296),Q=56320|Q&1023),_.push(Q),j+=me}return Be(_)}var we=4096;function Be(n){var i=n.length;if(i<=we)return String.fromCharCode.apply(String,n);for(var c="",_=0;_<i;)c+=String.fromCharCode.apply(String,n.slice(_,_+=we));return c}function Re(n,i,c){var _="";c=Math.min(n.length,c);for(var j=i;j<c;++j)_+=String.fromCharCode(n[j]&127);return _}function $e(n,i,c){var _="";c=Math.min(n.length,c);for(var j=i;j<c;++j)_+=String.fromCharCode(n[j]);return _}function Pe(n,i,c){var _=n.length;(!i||i<0)&&(i=0),(!c||c<0||c>_)&&(c=_);for(var j="",M=i;M<c;++M)j+=pe(n[M]);return j}function Ue(n,i,c){for(var _=n.slice(i,c),j="",M=0;M<_.length;M+=2)j+=String.fromCharCode(_[M]+_[M+1]*256);return j}y.prototype.slice=function(n,i){var c=this.length;n=~~n,i=i===void 0?c:~~i,n<0?(n+=c,n<0&&(n=0)):n>c&&(n=c),i<0?(i+=c,i<0&&(i=0)):i>c&&(i=c),i<n&&(i=n);var _;if(y.TYPED_ARRAY_SUPPORT)_=this.subarray(n,i),_.__proto__=y.prototype;else{var j=i-n;_=new y(j,void 0);for(var M=0;M<j;++M)_[M]=this[M+n]}return _};function Ae(n,i,c){if(n%1!==0||n<0)throw new RangeError("offset is not uint");if(n+i>c)throw new RangeError("Trying to access beyond buffer length")}y.prototype.readUIntLE=function(n,i,c){n=n|0,i=i|0,c||Ae(n,i,this.length);for(var _=this[n],j=1,M=0;++M<i&&(j*=256);)_+=this[n+M]*j;return _},y.prototype.readUIntBE=function(n,i,c){n=n|0,i=i|0,c||Ae(n,i,this.length);for(var _=this[n+--i],j=1;i>0&&(j*=256);)_+=this[n+--i]*j;return _},y.prototype.readUInt8=function(n,i){return i||Ae(n,1,this.length),this[n]},y.prototype.readUInt16LE=function(n,i){return i||Ae(n,2,this.length),this[n]|this[n+1]<<8},y.prototype.readUInt16BE=function(n,i){return i||Ae(n,2,this.length),this[n]<<8|this[n+1]},y.prototype.readUInt32LE=function(n,i){return i||Ae(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+this[n+3]*16777216},y.prototype.readUInt32BE=function(n,i){return i||Ae(n,4,this.length),this[n]*16777216+(this[n+1]<<16|this[n+2]<<8|this[n+3])},y.prototype.readIntLE=function(n,i,c){n=n|0,i=i|0,c||Ae(n,i,this.length);for(var _=this[n],j=1,M=0;++M<i&&(j*=256);)_+=this[n+M]*j;return j*=128,_>=j&&(_-=Math.pow(2,8*i)),_},y.prototype.readIntBE=function(n,i,c){n=n|0,i=i|0,c||Ae(n,i,this.length);for(var _=i,j=1,M=this[n+--_];_>0&&(j*=256);)M+=this[n+--_]*j;return j*=128,M>=j&&(M-=Math.pow(2,8*i)),M},y.prototype.readInt8=function(n,i){return i||Ae(n,1,this.length),this[n]&128?(255-this[n]+1)*-1:this[n]},y.prototype.readInt16LE=function(n,i){i||Ae(n,2,this.length);var c=this[n]|this[n+1]<<8;return c&32768?c|4294901760:c},y.prototype.readInt16BE=function(n,i){i||Ae(n,2,this.length);var c=this[n+1]|this[n]<<8;return c&32768?c|4294901760:c},y.prototype.readInt32LE=function(n,i){return i||Ae(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24},y.prototype.readInt32BE=function(n,i){return i||Ae(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]},y.prototype.readFloatLE=function(n,i){return i||Ae(n,4,this.length),C.read(this,n,!0,23,4)},y.prototype.readFloatBE=function(n,i){return i||Ae(n,4,this.length),C.read(this,n,!1,23,4)},y.prototype.readDoubleLE=function(n,i){return i||Ae(n,8,this.length),C.read(this,n,!0,52,8)},y.prototype.readDoubleBE=function(n,i){return i||Ae(n,8,this.length),C.read(this,n,!1,52,8)};function ve(n,i,c,_,j,M){if(!y.isBuffer(n))throw new TypeError('"buffer" argument must be a Buffer instance');if(i>j||i<M)throw new RangeError('"value" argument is out of bounds');if(c+_>n.length)throw new RangeError("Index out of range")}y.prototype.writeUIntLE=function(n,i,c,_){if(n=+n,i=i|0,c=c|0,!_){var j=Math.pow(2,8*c)-1;ve(this,n,i,c,j,0)}var M=1,Q=0;for(this[i]=n&255;++Q<c&&(M*=256);)this[i+Q]=n/M&255;return i+c},y.prototype.writeUIntBE=function(n,i,c,_){if(n=+n,i=i|0,c=c|0,!_){var j=Math.pow(2,8*c)-1;ve(this,n,i,c,j,0)}var M=c-1,Q=1;for(this[i+M]=n&255;--M>=0&&(Q*=256);)this[i+M]=n/Q&255;return i+c},y.prototype.writeUInt8=function(n,i,c){return n=+n,i=i|0,c||ve(this,n,i,1,255,0),y.TYPED_ARRAY_SUPPORT||(n=Math.floor(n)),this[i]=n&255,i+1};function He(n,i,c,_){i<0&&(i=65535+i+1);for(var j=0,M=Math.min(n.length-c,2);j<M;++j)n[c+j]=(i&255<<8*(_?j:1-j))>>>(_?j:1-j)*8}y.prototype.writeUInt16LE=function(n,i,c){return n=+n,i=i|0,c||ve(this,n,i,2,65535,0),y.TYPED_ARRAY_SUPPORT?(this[i]=n&255,this[i+1]=n>>>8):He(this,n,i,!0),i+2},y.prototype.writeUInt16BE=function(n,i,c){return n=+n,i=i|0,c||ve(this,n,i,2,65535,0),y.TYPED_ARRAY_SUPPORT?(this[i]=n>>>8,this[i+1]=n&255):He(this,n,i,!1),i+2};function Fe(n,i,c,_){i<0&&(i=4294967295+i+1);for(var j=0,M=Math.min(n.length-c,4);j<M;++j)n[c+j]=i>>>(_?j:3-j)*8&255}y.prototype.writeUInt32LE=function(n,i,c){return n=+n,i=i|0,c||ve(this,n,i,4,4294967295,0),y.TYPED_ARRAY_SUPPORT?(this[i+3]=n>>>24,this[i+2]=n>>>16,this[i+1]=n>>>8,this[i]=n&255):Fe(this,n,i,!0),i+4},y.prototype.writeUInt32BE=function(n,i,c){return n=+n,i=i|0,c||ve(this,n,i,4,4294967295,0),y.TYPED_ARRAY_SUPPORT?(this[i]=n>>>24,this[i+1]=n>>>16,this[i+2]=n>>>8,this[i+3]=n&255):Fe(this,n,i,!1),i+4},y.prototype.writeIntLE=function(n,i,c,_){if(n=+n,i=i|0,!_){var j=Math.pow(2,8*c-1);ve(this,n,i,c,j-1,-j)}var M=0,Q=1,me=0;for(this[i]=n&255;++M<c&&(Q*=256);)n<0&&me===0&&this[i+M-1]!==0&&(me=1),this[i+M]=(n/Q>>0)-me&255;return i+c},y.prototype.writeIntBE=function(n,i,c,_){if(n=+n,i=i|0,!_){var j=Math.pow(2,8*c-1);ve(this,n,i,c,j-1,-j)}var M=c-1,Q=1,me=0;for(this[i+M]=n&255;--M>=0&&(Q*=256);)n<0&&me===0&&this[i+M+1]!==0&&(me=1),this[i+M]=(n/Q>>0)-me&255;return i+c},y.prototype.writeInt8=function(n,i,c){return n=+n,i=i|0,c||ve(this,n,i,1,127,-128),y.TYPED_ARRAY_SUPPORT||(n=Math.floor(n)),n<0&&(n=255+n+1),this[i]=n&255,i+1},y.prototype.writeInt16LE=function(n,i,c){return n=+n,i=i|0,c||ve(this,n,i,2,32767,-32768),y.TYPED_ARRAY_SUPPORT?(this[i]=n&255,this[i+1]=n>>>8):He(this,n,i,!0),i+2},y.prototype.writeInt16BE=function(n,i,c){return n=+n,i=i|0,c||ve(this,n,i,2,32767,-32768),y.TYPED_ARRAY_SUPPORT?(this[i]=n>>>8,this[i+1]=n&255):He(this,n,i,!1),i+2},y.prototype.writeInt32LE=function(n,i,c){return n=+n,i=i|0,c||ve(this,n,i,4,2147483647,-2147483648),y.TYPED_ARRAY_SUPPORT?(this[i]=n&255,this[i+1]=n>>>8,this[i+2]=n>>>16,this[i+3]=n>>>24):Fe(this,n,i,!0),i+4},y.prototype.writeInt32BE=function(n,i,c){return n=+n,i=i|0,c||ve(this,n,i,4,2147483647,-2147483648),n<0&&(n=4294967295+n+1),y.TYPED_ARRAY_SUPPORT?(this[i]=n>>>24,this[i+1]=n>>>16,this[i+2]=n>>>8,this[i+3]=n&255):Fe(this,n,i,!1),i+4};function nt(n,i,c,_,j,M){if(c+_>n.length)throw new RangeError("Index out of range");if(c<0)throw new RangeError("Index out of range")}function oe(n,i,c,_,j){return j||nt(n,i,c,4),C.write(n,i,c,_,23,4),c+4}y.prototype.writeFloatLE=function(n,i,c){return oe(this,n,i,!0,c)},y.prototype.writeFloatBE=function(n,i,c){return oe(this,n,i,!1,c)};function Ze(n,i,c,_,j){return j||nt(n,i,c,8),C.write(n,i,c,_,52,8),c+8}y.prototype.writeDoubleLE=function(n,i,c){return Ze(this,n,i,!0,c)},y.prototype.writeDoubleBE=function(n,i,c){return Ze(this,n,i,!1,c)},y.prototype.copy=function(n,i,c,_){if(c||(c=0),!_&&_!==0&&(_=this.length),i>=n.length&&(i=n.length),i||(i=0),_>0&&_<c&&(_=c),_===c||n.length===0||this.length===0)return 0;if(i<0)throw new RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw new RangeError("sourceStart out of bounds");if(_<0)throw new RangeError("sourceEnd out of bounds");_>this.length&&(_=this.length),n.length-i<_-c&&(_=n.length-i+c);var j=_-c,M;if(this===n&&c<i&&i<_)for(M=j-1;M>=0;--M)n[M+i]=this[M+c];else if(j<1e3||!y.TYPED_ARRAY_SUPPORT)for(M=0;M<j;++M)n[M+i]=this[M+c];else Uint8Array.prototype.set.call(n,this.subarray(c,c+j),i);return j},y.prototype.fill=function(n,i,c,_){if(typeof n=="string"){if(typeof i=="string"?(_=i,i=0,c=this.length):typeof c=="string"&&(_=c,c=this.length),n.length===1){var j=n.charCodeAt(0);j<256&&(n=j)}if(_!==void 0&&typeof _!="string")throw new TypeError("encoding must be a string");if(typeof _=="string"&&!y.isEncoding(_))throw new TypeError("Unknown encoding: "+_)}else typeof n=="number"&&(n=n&255);if(i<0||this.length<i||this.length<c)throw new RangeError("Out of range index");if(c<=i)return this;i=i>>>0,c=c===void 0?this.length:c>>>0,n||(n=0);var M;if(typeof n=="number")for(M=i;M<c;++M)this[M]=n;else{var Q=y.isBuffer(n)?n:le(new y(n,_).toString()),me=Q.length;for(M=0;M<c-i;++M)this[M+i]=Q[M%me]}return this};var Qe=/[^+\/0-9A-Za-z-_]/g;function ie(n){if(n=he(n).replace(Qe,""),n.length<2)return"";for(;n.length%4!==0;)n=n+"=";return n}function he(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function pe(n){return n<16?"0"+n.toString(16):n.toString(16)}function le(n,i){i=i||1/0;for(var c,_=n.length,j=null,M=[],Q=0;Q<_;++Q){if(c=n.charCodeAt(Q),c>55295&&c<57344){if(!j){if(c>56319){(i-=3)>-1&&M.push(239,191,189);continue}else if(Q+1===_){(i-=3)>-1&&M.push(239,191,189);continue}j=c;continue}if(c<56320){(i-=3)>-1&&M.push(239,191,189),j=c;continue}c=(j-55296<<10|c-56320)+65536}else j&&(i-=3)>-1&&M.push(239,191,189);if(j=null,c<128){if((i-=1)<0)break;M.push(c)}else if(c<2048){if((i-=2)<0)break;M.push(c>>6|192,c&63|128)}else if(c<65536){if((i-=3)<0)break;M.push(c>>12|224,c>>6&63|128,c&63|128)}else if(c<1114112){if((i-=4)<0)break;M.push(c>>18|240,c>>12&63|128,c>>6&63|128,c&63|128)}else throw new Error("Invalid code point")}return M}function qe(n){for(var i=[],c=0;c<n.length;++c)i.push(n.charCodeAt(c)&255);return i}function o(n,i){for(var c,_,j,M=[],Q=0;Q<n.length&&!((i-=2)<0);++Q)c=n.charCodeAt(Q),_=c>>8,j=c%256,M.push(j),M.push(_);return M}function s(n){return k.toByteArray(ie(n))}function f(n,i,c,_){for(var j=0;j<_&&!(j+c>=i.length||j>=n.length);++j)i[j+c]=n[j];return j}function A(n){return n!==n}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"base64-js":6,ieee754:14,isarray:16}],8:[function(p,d,b){var g=p("base64-js"),k=p("ieee754");b.Buffer=h,b.SlowBuffer=ue,b.INSPECT_MAX_BYTES=50;var C=2147483647;b.kMaxLength=C,h.TYPED_ARRAY_SUPPORT=L(),!h.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function L(){try{var o=new Uint8Array(1);return o.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},o.foo()===42}catch{return!1}}Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.buffer}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.byteOffset}});function B(o){if(o>C)throw new RangeError('The value "'+o+'" is invalid for option "size"');var s=new Uint8Array(o);return s.__proto__=h.prototype,s}function h(o,s,f){if(typeof o=="number"){if(typeof s=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return K(o)}return m(o,s,f)}typeof Symbol<"u"&&Symbol.species!=null&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),h.poolSize=8192;function m(o,s,f){if(typeof o=="string")return Y(o,s);if(ArrayBuffer.isView(o))return W(o);if(o==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof o);if(le(o,ArrayBuffer)||o&&le(o.buffer,ArrayBuffer))return ye(o,s,f);if(typeof o=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var A=o.valueOf&&o.valueOf();if(A!=null&&A!==o)return h.from(A,s,f);var n=te(o);if(n)return n;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof o[Symbol.toPrimitive]=="function")return h.from(o[Symbol.toPrimitive]("string"),s,f);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof o)}h.from=function(o,s,f){return m(o,s,f)},h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array;function y(o){if(typeof o!="number")throw new TypeError('"size" argument must be of type number');if(o<0)throw new RangeError('The value "'+o+'" is invalid for option "size"')}function D(o,s,f){return y(o),o<=0?B(o):s!==void 0?typeof f=="string"?B(o).fill(s,f):B(o).fill(s):B(o)}h.alloc=function(o,s,f){return D(o,s,f)};function K(o){return y(o),B(o<0?0:fe(o)|0)}h.allocUnsafe=function(o){return K(o)},h.allocUnsafeSlow=function(o){return K(o)};function Y(o,s){if((typeof s!="string"||s==="")&&(s="utf8"),!h.isEncoding(s))throw new TypeError("Unknown encoding: "+s);var f=de(o,s)|0,A=B(f),n=A.write(o,s);return n!==f&&(A=A.slice(0,n)),A}function W(o){for(var s=o.length<0?0:fe(o.length)|0,f=B(s),A=0;A<s;A+=1)f[A]=o[A]&255;return f}function ye(o,s,f){if(s<0||o.byteLength<s)throw new RangeError('"offset" is outside of buffer bounds');if(o.byteLength<s+(f||0))throw new RangeError('"length" is outside of buffer bounds');var A;return s===void 0&&f===void 0?A=new Uint8Array(o):f===void 0?A=new Uint8Array(o,s):A=new Uint8Array(o,s,f),A.__proto__=h.prototype,A}function te(o){if(h.isBuffer(o)){var s=fe(o.length)|0,f=B(s);return f.length===0||o.copy(f,0,0,s),f}if(o.length!==void 0)return typeof o.length!="number"||qe(o.length)?B(0):W(o);if(o.type==="Buffer"&&Array.isArray(o.data))return W(o.data)}function fe(o){if(o>=C)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+C.toString(16)+" bytes");return o|0}function ue(o){return+o!=o&&(o=0),h.alloc(+o)}h.isBuffer=function(o){return o!=null&&o._isBuffer===!0&&o!==h.prototype},h.compare=function(o,s){if(le(o,Uint8Array)&&(o=h.from(o,o.offset,o.byteLength)),le(s,Uint8Array)&&(s=h.from(s,s.offset,s.byteLength)),!h.isBuffer(o)||!h.isBuffer(s))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(o===s)return 0;for(var f=o.length,A=s.length,n=0,i=Math.min(f,A);n<i;++n)if(o[n]!==s[n]){f=o[n],A=s[n];break}return f<A?-1:A<f?1:0},h.isEncoding=function(o){switch(String(o).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(o,s){if(!Array.isArray(o))throw new TypeError('"list" argument must be an Array of Buffers');if(o.length===0)return h.alloc(0);var f;if(s===void 0)for(s=0,f=0;f<o.length;++f)s+=o[f].length;var A=h.allocUnsafe(s),n=0;for(f=0;f<o.length;++f){var i=o[f];if(le(i,Uint8Array)&&(i=h.from(i)),!h.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(A,n),n+=i.length}return A};function de(o,s){if(h.isBuffer(o))return o.length;if(ArrayBuffer.isView(o)||le(o,ArrayBuffer))return o.byteLength;if(typeof o!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof o);var f=o.length,A=arguments.length>2&&arguments[2]===!0;if(!A&&f===0)return 0;for(var n=!1;;)switch(s){case"ascii":case"latin1":case"binary":return f;case"utf8":case"utf-8":return Ze(o).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return f*2;case"hex":return f>>>1;case"base64":return he(o).length;default:if(n)return A?-1:Ze(o).length;s=(""+s).toLowerCase(),n=!0}}h.byteLength=de;function Me(o,s,f){var A=!1;if((s===void 0||s<0)&&(s=0),s>this.length||((f===void 0||f>this.length)&&(f=this.length),f<=0)||(f>>>=0,s>>>=0,f<=s))return"";for(o||(o="utf8");;)switch(o){case"hex":return Re(this,s,f);case"utf8":case"utf-8":return G(this,s,f);case"ascii":return we(this,s,f);case"latin1":case"binary":return Be(this,s,f);case"base64":return X(this,s,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $e(this,s,f);default:if(A)throw new TypeError("Unknown encoding: "+o);o=(o+"").toLowerCase(),A=!0}}h.prototype._isBuffer=!0;function De(o,s,f){var A=o[s];o[s]=o[f],o[f]=A}h.prototype.swap16=function(){var o=this.length;if(o%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var s=0;s<o;s+=2)De(this,s,s+1);return this},h.prototype.swap32=function(){var o=this.length;if(o%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var s=0;s<o;s+=4)De(this,s,s+3),De(this,s+1,s+2);return this},h.prototype.swap64=function(){var o=this.length;if(o%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var s=0;s<o;s+=8)De(this,s,s+7),De(this,s+1,s+6),De(this,s+2,s+5),De(this,s+3,s+4);return this},h.prototype.toString=function(){var o=this.length;return o===0?"":arguments.length===0?G(this,0,o):Me.apply(this,arguments)},h.prototype.toLocaleString=h.prototype.toString,h.prototype.equals=function(o){if(!h.isBuffer(o))throw new TypeError("Argument must be a Buffer");return this===o?!0:h.compare(this,o)===0},h.prototype.inspect=function(){var o="",s=b.INSPECT_MAX_BYTES;return o=this.toString("hex",0,s).replace(/(.{2})/g,"$1 ").trim(),this.length>s&&(o+=" ... "),"<Buffer "+o+">"},h.prototype.compare=function(o,s,f,A,n){if(le(o,Uint8Array)&&(o=h.from(o,o.offset,o.byteLength)),!h.isBuffer(o))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof o);if(s===void 0&&(s=0),f===void 0&&(f=o?o.length:0),A===void 0&&(A=0),n===void 0&&(n=this.length),s<0||f>o.length||A<0||n>this.length)throw new RangeError("out of range index");if(A>=n&&s>=f)return 0;if(A>=n)return-1;if(s>=f)return 1;if(s>>>=0,f>>>=0,A>>>=0,n>>>=0,this===o)return 0;for(var i=n-A,c=f-s,_=Math.min(i,c),j=this.slice(A,n),M=o.slice(s,f),Q=0;Q<_;++Q)if(j[Q]!==M[Q]){i=j[Q],c=M[Q];break}return i<c?-1:c<i?1:0};function Ie(o,s,f,A,n){if(o.length===0)return-1;if(typeof f=="string"?(A=f,f=0):f>2147483647?f=2147483647:f<-2147483648&&(f=-2147483648),f=+f,qe(f)&&(f=n?0:o.length-1),f<0&&(f=o.length+f),f>=o.length){if(n)return-1;f=o.length-1}else if(f<0)if(n)f=0;else return-1;if(typeof s=="string"&&(s=h.from(s,A)),h.isBuffer(s))return s.length===0?-1:Ee(o,s,f,A,n);if(typeof s=="number")return s=s&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(o,s,f):Uint8Array.prototype.lastIndexOf.call(o,s,f):Ee(o,[s],f,A,n);throw new TypeError("val must be string, number or Buffer")}function Ee(o,s,f,A,n){var i=1,c=o.length,_=s.length;if(A!==void 0&&(A=String(A).toLowerCase(),A==="ucs2"||A==="ucs-2"||A==="utf16le"||A==="utf-16le")){if(o.length<2||s.length<2)return-1;i=2,c/=2,_/=2,f/=2}function j(Oe,Le){return i===1?Oe[Le]:Oe.readUInt16BE(Le*i)}var M;if(n){var Q=-1;for(M=f;M<c;M++)if(j(o,M)===j(s,Q===-1?0:M-Q)){if(Q===-1&&(Q=M),M-Q+1===_)return Q*i}else Q!==-1&&(M-=M-Q),Q=-1}else for(f+_>c&&(f=c-_),M=f;M>=0;M--){for(var me=!0,Ve=0;Ve<_;Ve++)if(j(o,M+Ve)!==j(s,Ve)){me=!1;break}if(me)return M}return-1}h.prototype.includes=function(o,s,f){return this.indexOf(o,s,f)!==-1},h.prototype.indexOf=function(o,s,f){return Ie(this,o,s,f,!0)},h.prototype.lastIndexOf=function(o,s,f){return Ie(this,o,s,f,!1)};function Ye(o,s,f,A){f=Number(f)||0;var n=o.length-f;A?(A=Number(A),A>n&&(A=n)):A=n;var i=s.length;A>i/2&&(A=i/2);for(var c=0;c<A;++c){var _=parseInt(s.substr(c*2,2),16);if(qe(_))return c;o[f+c]=_}return c}function Xe(o,s,f,A){return pe(Ze(s,o.length-f),o,f,A)}function Se(o,s,f,A){return pe(Qe(s),o,f,A)}function ce(o,s,f,A){return Se(o,s,f,A)}function be(o,s,f,A){return pe(he(s),o,f,A)}function $(o,s,f,A){return pe(ie(s,o.length-f),o,f,A)}h.prototype.write=function(o,s,f,A){if(s===void 0)A="utf8",f=this.length,s=0;else if(f===void 0&&typeof s=="string")A=s,f=this.length,s=0;else if(isFinite(s))s=s>>>0,isFinite(f)?(f=f>>>0,A===void 0&&(A="utf8")):(A=f,f=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var n=this.length-s;if((f===void 0||f>n)&&(f=n),o.length>0&&(f<0||s<0)||s>this.length)throw new RangeError("Attempt to write outside buffer bounds");A||(A="utf8");for(var i=!1;;)switch(A){case"hex":return Ye(this,o,s,f);case"utf8":case"utf-8":return Xe(this,o,s,f);case"ascii":return Se(this,o,s,f);case"latin1":case"binary":return ce(this,o,s,f);case"base64":return be(this,o,s,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $(this,o,s,f);default:if(i)throw new TypeError("Unknown encoding: "+A);A=(""+A).toLowerCase(),i=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function X(o,s,f){return s===0&&f===o.length?g.fromByteArray(o):g.fromByteArray(o.slice(s,f))}function G(o,s,f){f=Math.min(o.length,f);for(var A=[],n=s;n<f;){var i=o[n],c=null,_=i>239?4:i>223?3:i>191?2:1;if(n+_<=f){var j,M,Q,me;switch(_){case 1:i<128&&(c=i);break;case 2:j=o[n+1],(j&192)===128&&(me=(i&31)<<6|j&63,me>127&&(c=me));break;case 3:j=o[n+1],M=o[n+2],(j&192)===128&&(M&192)===128&&(me=(i&15)<<12|(j&63)<<6|M&63,me>2047&&(me<55296||me>57343)&&(c=me));break;case 4:j=o[n+1],M=o[n+2],Q=o[n+3],(j&192)===128&&(M&192)===128&&(Q&192)===128&&(me=(i&15)<<18|(j&63)<<12|(M&63)<<6|Q&63,me>65535&&me<1114112&&(c=me))}}c===null?(c=65533,_=1):c>65535&&(c-=65536,A.push(c>>>10&1023|55296),c=56320|c&1023),A.push(c),n+=_}return ge(A)}var ae=4096;function ge(o){var s=o.length;if(s<=ae)return String.fromCharCode.apply(String,o);for(var f="",A=0;A<s;)f+=String.fromCharCode.apply(String,o.slice(A,A+=ae));return f}function we(o,s,f){var A="";f=Math.min(o.length,f);for(var n=s;n<f;++n)A+=String.fromCharCode(o[n]&127);return A}function Be(o,s,f){var A="";f=Math.min(o.length,f);for(var n=s;n<f;++n)A+=String.fromCharCode(o[n]);return A}function Re(o,s,f){var A=o.length;(!s||s<0)&&(s=0),(!f||f<0||f>A)&&(f=A);for(var n="",i=s;i<f;++i)n+=oe(o[i]);return n}function $e(o,s,f){for(var A=o.slice(s,f),n="",i=0;i<A.length;i+=2)n+=String.fromCharCode(A[i]+A[i+1]*256);return n}h.prototype.slice=function(o,s){var f=this.length;o=~~o,s=s===void 0?f:~~s,o<0?(o+=f,o<0&&(o=0)):o>f&&(o=f),s<0?(s+=f,s<0&&(s=0)):s>f&&(s=f),s<o&&(s=o);var A=this.subarray(o,s);return A.__proto__=h.prototype,A};function Pe(o,s,f){if(o%1!==0||o<0)throw new RangeError("offset is not uint");if(o+s>f)throw new RangeError("Trying to access beyond buffer length")}h.prototype.readUIntLE=function(o,s,f){o=o>>>0,s=s>>>0,f||Pe(o,s,this.length);for(var A=this[o],n=1,i=0;++i<s&&(n*=256);)A+=this[o+i]*n;return A},h.prototype.readUIntBE=function(o,s,f){o=o>>>0,s=s>>>0,f||Pe(o,s,this.length);for(var A=this[o+--s],n=1;s>0&&(n*=256);)A+=this[o+--s]*n;return A},h.prototype.readUInt8=function(o,s){return o=o>>>0,s||Pe(o,1,this.length),this[o]},h.prototype.readUInt16LE=function(o,s){return o=o>>>0,s||Pe(o,2,this.length),this[o]|this[o+1]<<8},h.prototype.readUInt16BE=function(o,s){return o=o>>>0,s||Pe(o,2,this.length),this[o]<<8|this[o+1]},h.prototype.readUInt32LE=function(o,s){return o=o>>>0,s||Pe(o,4,this.length),(this[o]|this[o+1]<<8|this[o+2]<<16)+this[o+3]*16777216},h.prototype.readUInt32BE=function(o,s){return o=o>>>0,s||Pe(o,4,this.length),this[o]*16777216+(this[o+1]<<16|this[o+2]<<8|this[o+3])},h.prototype.readIntLE=function(o,s,f){o=o>>>0,s=s>>>0,f||Pe(o,s,this.length);for(var A=this[o],n=1,i=0;++i<s&&(n*=256);)A+=this[o+i]*n;return n*=128,A>=n&&(A-=Math.pow(2,8*s)),A},h.prototype.readIntBE=function(o,s,f){o=o>>>0,s=s>>>0,f||Pe(o,s,this.length);for(var A=s,n=1,i=this[o+--A];A>0&&(n*=256);)i+=this[o+--A]*n;return n*=128,i>=n&&(i-=Math.pow(2,8*s)),i},h.prototype.readInt8=function(o,s){return o=o>>>0,s||Pe(o,1,this.length),this[o]&128?(255-this[o]+1)*-1:this[o]},h.prototype.readInt16LE=function(o,s){o=o>>>0,s||Pe(o,2,this.length);var f=this[o]|this[o+1]<<8;return f&32768?f|4294901760:f},h.prototype.readInt16BE=function(o,s){o=o>>>0,s||Pe(o,2,this.length);var f=this[o+1]|this[o]<<8;return f&32768?f|4294901760:f},h.prototype.readInt32LE=function(o,s){return o=o>>>0,s||Pe(o,4,this.length),this[o]|this[o+1]<<8|this[o+2]<<16|this[o+3]<<24},h.prototype.readInt32BE=function(o,s){return o=o>>>0,s||Pe(o,4,this.length),this[o]<<24|this[o+1]<<16|this[o+2]<<8|this[o+3]},h.prototype.readFloatLE=function(o,s){return o=o>>>0,s||Pe(o,4,this.length),k.read(this,o,!0,23,4)},h.prototype.readFloatBE=function(o,s){return o=o>>>0,s||Pe(o,4,this.length),k.read(this,o,!1,23,4)},h.prototype.readDoubleLE=function(o,s){return o=o>>>0,s||Pe(o,8,this.length),k.read(this,o,!0,52,8)},h.prototype.readDoubleBE=function(o,s){return o=o>>>0,s||Pe(o,8,this.length),k.read(this,o,!1,52,8)};function Ue(o,s,f,A,n,i){if(!h.isBuffer(o))throw new TypeError('"buffer" argument must be a Buffer instance');if(s>n||s<i)throw new RangeError('"value" argument is out of bounds');if(f+A>o.length)throw new RangeError("Index out of range")}h.prototype.writeUIntLE=function(o,s,f,A){if(o=+o,s=s>>>0,f=f>>>0,!A){var n=Math.pow(2,8*f)-1;Ue(this,o,s,f,n,0)}var i=1,c=0;for(this[s]=o&255;++c<f&&(i*=256);)this[s+c]=o/i&255;return s+f},h.prototype.writeUIntBE=function(o,s,f,A){if(o=+o,s=s>>>0,f=f>>>0,!A){var n=Math.pow(2,8*f)-1;Ue(this,o,s,f,n,0)}var i=f-1,c=1;for(this[s+i]=o&255;--i>=0&&(c*=256);)this[s+i]=o/c&255;return s+f},h.prototype.writeUInt8=function(o,s,f){return o=+o,s=s>>>0,f||Ue(this,o,s,1,255,0),this[s]=o&255,s+1},h.prototype.writeUInt16LE=function(o,s,f){return o=+o,s=s>>>0,f||Ue(this,o,s,2,65535,0),this[s]=o&255,this[s+1]=o>>>8,s+2},h.prototype.writeUInt16BE=function(o,s,f){return o=+o,s=s>>>0,f||Ue(this,o,s,2,65535,0),this[s]=o>>>8,this[s+1]=o&255,s+2},h.prototype.writeUInt32LE=function(o,s,f){return o=+o,s=s>>>0,f||Ue(this,o,s,4,4294967295,0),this[s+3]=o>>>24,this[s+2]=o>>>16,this[s+1]=o>>>8,this[s]=o&255,s+4},h.prototype.writeUInt32BE=function(o,s,f){return o=+o,s=s>>>0,f||Ue(this,o,s,4,4294967295,0),this[s]=o>>>24,this[s+1]=o>>>16,this[s+2]=o>>>8,this[s+3]=o&255,s+4},h.prototype.writeIntLE=function(o,s,f,A){if(o=+o,s=s>>>0,!A){var n=Math.pow(2,8*f-1);Ue(this,o,s,f,n-1,-n)}var i=0,c=1,_=0;for(this[s]=o&255;++i<f&&(c*=256);)o<0&&_===0&&this[s+i-1]!==0&&(_=1),this[s+i]=(o/c>>0)-_&255;return s+f},h.prototype.writeIntBE=function(o,s,f,A){if(o=+o,s=s>>>0,!A){var n=Math.pow(2,8*f-1);Ue(this,o,s,f,n-1,-n)}var i=f-1,c=1,_=0;for(this[s+i]=o&255;--i>=0&&(c*=256);)o<0&&_===0&&this[s+i+1]!==0&&(_=1),this[s+i]=(o/c>>0)-_&255;return s+f},h.prototype.writeInt8=function(o,s,f){return o=+o,s=s>>>0,f||Ue(this,o,s,1,127,-128),o<0&&(o=255+o+1),this[s]=o&255,s+1},h.prototype.writeInt16LE=function(o,s,f){return o=+o,s=s>>>0,f||Ue(this,o,s,2,32767,-32768),this[s]=o&255,this[s+1]=o>>>8,s+2},h.prototype.writeInt16BE=function(o,s,f){return o=+o,s=s>>>0,f||Ue(this,o,s,2,32767,-32768),this[s]=o>>>8,this[s+1]=o&255,s+2},h.prototype.writeInt32LE=function(o,s,f){return o=+o,s=s>>>0,f||Ue(this,o,s,4,2147483647,-2147483648),this[s]=o&255,this[s+1]=o>>>8,this[s+2]=o>>>16,this[s+3]=o>>>24,s+4},h.prototype.writeInt32BE=function(o,s,f){return o=+o,s=s>>>0,f||Ue(this,o,s,4,2147483647,-2147483648),o<0&&(o=4294967295+o+1),this[s]=o>>>24,this[s+1]=o>>>16,this[s+2]=o>>>8,this[s+3]=o&255,s+4};function Ae(o,s,f,A,n,i){if(f+A>o.length)throw new RangeError("Index out of range");if(f<0)throw new RangeError("Index out of range")}function ve(o,s,f,A,n){return s=+s,f=f>>>0,n||Ae(o,s,f,4),k.write(o,s,f,A,23,4),f+4}h.prototype.writeFloatLE=function(o,s,f){return ve(this,o,s,!0,f)},h.prototype.writeFloatBE=function(o,s,f){return ve(this,o,s,!1,f)};function He(o,s,f,A,n){return s=+s,f=f>>>0,n||Ae(o,s,f,8),k.write(o,s,f,A,52,8),f+8}h.prototype.writeDoubleLE=function(o,s,f){return He(this,o,s,!0,f)},h.prototype.writeDoubleBE=function(o,s,f){return He(this,o,s,!1,f)},h.prototype.copy=function(o,s,f,A){if(!h.isBuffer(o))throw new TypeError("argument should be a Buffer");if(f||(f=0),!A&&A!==0&&(A=this.length),s>=o.length&&(s=o.length),s||(s=0),A>0&&A<f&&(A=f),A===f||o.length===0||this.length===0)return 0;if(s<0)throw new RangeError("targetStart out of bounds");if(f<0||f>=this.length)throw new RangeError("Index out of range");if(A<0)throw new RangeError("sourceEnd out of bounds");A>this.length&&(A=this.length),o.length-s<A-f&&(A=o.length-s+f);var n=A-f;if(this===o&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(s,f,A);else if(this===o&&f<s&&s<A)for(var i=n-1;i>=0;--i)o[i+s]=this[i+f];else Uint8Array.prototype.set.call(o,this.subarray(f,A),s);return n},h.prototype.fill=function(o,s,f,A){if(typeof o=="string"){if(typeof s=="string"?(A=s,s=0,f=this.length):typeof f=="string"&&(A=f,f=this.length),A!==void 0&&typeof A!="string")throw new TypeError("encoding must be a string");if(typeof A=="string"&&!h.isEncoding(A))throw new TypeError("Unknown encoding: "+A);if(o.length===1){var n=o.charCodeAt(0);(A==="utf8"&&n<128||A==="latin1")&&(o=n)}}else typeof o=="number"&&(o=o&255);if(s<0||this.length<s||this.length<f)throw new RangeError("Out of range index");if(f<=s)return this;s=s>>>0,f=f===void 0?this.length:f>>>0,o||(o=0);var i;if(typeof o=="number")for(i=s;i<f;++i)this[i]=o;else{var c=h.isBuffer(o)?o:h.from(o,A),_=c.length;if(_===0)throw new TypeError('The value "'+o+'" is invalid for argument "value"');for(i=0;i<f-s;++i)this[i+s]=c[i%_]}return this};var Fe=/[^+/0-9A-Za-z-_]/g;function nt(o){if(o=o.split("=")[0],o=o.trim().replace(Fe,""),o.length<2)return"";for(;o.length%4!==0;)o=o+"=";return o}function oe(o){return o<16?"0"+o.toString(16):o.toString(16)}function Ze(o,s){s=s||1/0;for(var f,A=o.length,n=null,i=[],c=0;c<A;++c){if(f=o.charCodeAt(c),f>55295&&f<57344){if(!n){if(f>56319){(s-=3)>-1&&i.push(239,191,189);continue}else if(c+1===A){(s-=3)>-1&&i.push(239,191,189);continue}n=f;continue}if(f<56320){(s-=3)>-1&&i.push(239,191,189),n=f;continue}f=(n-55296<<10|f-56320)+65536}else n&&(s-=3)>-1&&i.push(239,191,189);if(n=null,f<128){if((s-=1)<0)break;i.push(f)}else if(f<2048){if((s-=2)<0)break;i.push(f>>6|192,f&63|128)}else if(f<65536){if((s-=3)<0)break;i.push(f>>12|224,f>>6&63|128,f&63|128)}else if(f<1114112){if((s-=4)<0)break;i.push(f>>18|240,f>>12&63|128,f>>6&63|128,f&63|128)}else throw new Error("Invalid code point")}return i}function Qe(o){for(var s=[],f=0;f<o.length;++f)s.push(o.charCodeAt(f)&255);return s}function ie(o,s){for(var f,A,n,i=[],c=0;c<o.length&&!((s-=2)<0);++c)f=o.charCodeAt(c),A=f>>8,n=f%256,i.push(n),i.push(A);return i}function he(o){return g.toByteArray(nt(o))}function pe(o,s,f,A){for(var n=0;n<A&&!(n+f>=s.length||n>=o.length);++n)s[n+f]=o[n];return n}function le(o,s){return o instanceof s||o!=null&&o.constructor!=null&&o.constructor.name!=null&&o.constructor.name===s.name}function qe(o){return o!==o}},{"base64-js":6,ieee754:14}],9:[function(p,d,b){var g=p("./lib/buffer-reader"),k=1,C=3,L=2;d.exports=function(h){var m={},y=new g(h);m.trackNumber=y.nextUIntV(),m.timecode=y.nextInt16BE();var D=y.nextUInt8();m.invisible=!!(D&8),m.keyframe=!!(D&128),m.discardable=!!(D&1);var K=(D&6)>>1;return m.frames=B(y,K),m};function B(h,m){if(!m)return[h.nextBuffer()];var y,D,K=[],Y=h.nextUInt8()+1;if(m===L){if(h.length%Y!==0)throw new Error("Fixed-Size Lacing Error");for(D=h.length/Y,y=0;y<Y;y++)K.push(h.nextBuffer(D));return K}var W=[];if(m===k)for(y=0;y<Y-1;y++){var ye;D=0;do ye=h.nextUInt8(),D+=ye;while(ye===255);W.push(D)}else if(m===C)for(D=h.nextUIntV(),W.push(D),y=1;y<Y-1;y++)D+=h.nextIntV(),W.push(D);for(y=0;y<Y-1;y++)K.push(h.nextBuffer(W[y]));return K.push(h.nextBuffer()),K}},{"./lib/buffer-reader":10}],10:[function(p,d,b){var g=p("./vint");function k(C){this.buffer=C,this.offset=0}k.prototype.nextInt16BE=function(){var C=this.buffer.readInt16BE(this.offset);return this.offset+=2,C},k.prototype.nextUInt8=function(){var C=this.buffer.readUInt8(this.offset);return this.offset+=1,C},k.prototype.nextUIntV=function(){var C=g(this.buffer,this.offset);return this.offset+=C.length,C.value},k.prototype.nextIntV=function(){var C=g(this.buffer,this.offset,!0);return this.offset+=C.length,C.value},k.prototype.nextBuffer=function(C){var L=C?this.buffer.slice(this.offset,this.offset+C):this.buffer.slice(this.offset);return this.offset+=C||this.length,L},Object.defineProperty(k.prototype,"length",{get:function(){return this.buffer.length-this.offset}}),d.exports=k},{"./vint":11}],11:[function(p,d,b){d.exports=function(g,k,C){k=k||0;for(var L=1;L<=8&&!(g[k]>=Math.pow(2,8-L));L++);if(L>8)throw new Error("Unrepresentable length: "+L+" "+g.toString("hex",k,k+L));if(k+L>g.length)return null;var B,h=g[k]&(1<<8-L)-1;for(B=1;B<L;B++){if(B===7&&h>=Math.pow(2,45)&&g[k+7]>0)return{length:L,value:-1};h*=Math.pow(2,8),h+=g[k+B]}return C&&(h-=Math.pow(2,L*7-1)-1),{length:L,value:h}}},{}],12:[function(p,d,b){(function(g){var k={readVint:function(C,L){L=L||0;for(var B=1;B<=8&&!(C[L]>=Math.pow(2,8-B));B++);if(B>8)throw new Error("Unrepresentable length: "+B+" "+C.toString("hex",L,L+B));if(L+B>C.length)return null;for(var h=C[L]&(1<<8-B)-1,m=1;m<B;m++){if(m===7&&h>=Math.pow(2,45)&&C[L+7]>0)return{length:B,value:-1};h*=Math.pow(2,8),h+=C[L+m]}return{length:B,value:h}},writeVint:function(C){if(C<0||C>Math.pow(2,53))throw new Error("Unrepresentable value: "+C);for(var L=1;L<=8&&!(C<Math.pow(2,7*L)-1);L++);for(var B=new g(L),h=1;h<=L;h++){var m=C&255;B[L-h]=m,C-=m,C/=Math.pow(2,8)}return B[0]=B[0]|1<<8-L,B}};d.exports=k}).call(this,p("buffer").Buffer)},{buffer:7}],13:[function(p,d,b){function g(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}d.exports=g,g.EventEmitter=g,g.prototype._events=void 0,g.prototype._maxListeners=void 0,g.defaultMaxListeners=10,g.prototype.setMaxListeners=function(h){if(!C(h)||h<0||isNaN(h))throw TypeError("n must be a positive number");return this._maxListeners=h,this},g.prototype.emit=function(h){var m,y,D,K,Y,W;if(this._events||(this._events={}),h==="error"&&(!this._events.error||L(this._events.error)&&!this._events.error.length)){if(m=arguments[1],m instanceof Error)throw m;var ye=new Error('Uncaught, unspecified "error" event. ('+m+")");throw ye.context=m,ye}if(y=this._events[h],B(y))return!1;if(k(y))switch(arguments.length){case 1:y.call(this);break;case 2:y.call(this,arguments[1]);break;case 3:y.call(this,arguments[1],arguments[2]);break;default:K=Array.prototype.slice.call(arguments,1),y.apply(this,K)}else if(L(y))for(K=Array.prototype.slice.call(arguments,1),W=y.slice(),D=W.length,Y=0;Y<D;Y++)W[Y].apply(this,K);return!0},g.prototype.addListener=function(h,m){var y;if(!k(m))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",h,k(m.listener)?m.listener:m),this._events[h]?L(this._events[h])?this._events[h].push(m):this._events[h]=[this._events[h],m]:this._events[h]=m,L(this._events[h])&&!this._events[h].warned&&(B(this._maxListeners)?y=g.defaultMaxListeners:y=this._maxListeners,y&&y>0&&this._events[h].length>y&&(this._events[h].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[h].length),typeof console.trace=="function"&&console.trace())),this},g.prototype.on=g.prototype.addListener,g.prototype.once=function(h,m){if(!k(m))throw TypeError("listener must be a function");var y=!1;function D(){this.removeListener(h,D),y||(y=!0,m.apply(this,arguments))}return D.listener=m,this.on(h,D),this},g.prototype.removeListener=function(h,m){var y,D,K,Y;if(!k(m))throw TypeError("listener must be a function");if(!this._events||!this._events[h])return this;if(y=this._events[h],K=y.length,D=-1,y===m||k(y.listener)&&y.listener===m)delete this._events[h],this._events.removeListener&&this.emit("removeListener",h,m);else if(L(y)){for(Y=K;Y-- >0;)if(y[Y]===m||y[Y].listener&&y[Y].listener===m){D=Y;break}if(D<0)return this;y.length===1?(y.length=0,delete this._events[h]):y.splice(D,1),this._events.removeListener&&this.emit("removeListener",h,m)}return this},g.prototype.removeAllListeners=function(h){var m,y;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[h]&&delete this._events[h],this;if(arguments.length===0){for(m in this._events)m!=="removeListener"&&this.removeAllListeners(m);return this.removeAllListeners("removeListener"),this._events={},this}if(y=this._events[h],k(y))this.removeListener(h,y);else if(y)for(;y.length;)this.removeListener(h,y[y.length-1]);return delete this._events[h],this},g.prototype.listeners=function(h){var m;return!this._events||!this._events[h]?m=[]:k(this._events[h])?m=[this._events[h]]:m=this._events[h].slice(),m},g.prototype.listenerCount=function(h){if(this._events){var m=this._events[h];if(k(m))return 1;if(m)return m.length}return 0},g.listenerCount=function(h,m){return h.listenerCount(m)};function k(h){return typeof h=="function"}function C(h){return typeof h=="number"}function L(h){return typeof h=="object"&&h!==null}function B(h){return h===void 0}},{}],14:[function(p,d,b){b.read=function(g,k,C,L,B){var h,m,y=B*8-L-1,D=(1<<y)-1,K=D>>1,Y=-7,W=C?B-1:0,ye=C?-1:1,te=g[k+W];for(W+=ye,h=te&(1<<-Y)-1,te>>=-Y,Y+=y;Y>0;h=h*256+g[k+W],W+=ye,Y-=8);for(m=h&(1<<-Y)-1,h>>=-Y,Y+=L;Y>0;m=m*256+g[k+W],W+=ye,Y-=8);if(h===0)h=1-K;else{if(h===D)return m?NaN:(te?-1:1)*(1/0);m=m+Math.pow(2,L),h=h-K}return(te?-1:1)*m*Math.pow(2,h-L)},b.write=function(g,k,C,L,B,h){var m,y,D,K=h*8-B-1,Y=(1<<K)-1,W=Y>>1,ye=B===23?Math.pow(2,-24)-Math.pow(2,-77):0,te=L?0:h-1,fe=L?1:-1,ue=k<0||k===0&&1/k<0?1:0;for(k=Math.abs(k),isNaN(k)||k===1/0?(y=isNaN(k)?1:0,m=Y):(m=Math.floor(Math.log(k)/Math.LN2),k*(D=Math.pow(2,-m))<1&&(m--,D*=2),m+W>=1?k+=ye/D:k+=ye*Math.pow(2,1-W),k*D>=2&&(m++,D/=2),m+W>=Y?(y=0,m=Y):m+W>=1?(y=(k*D-1)*Math.pow(2,B),m=m+W):(y=k*Math.pow(2,W-1)*Math.pow(2,B),m=0));B>=8;g[C+te]=y&255,te+=fe,y/=256,B-=8);for(m=m<<B|y,K+=B;K>0;g[C+te]=m&255,te+=fe,m/=256,K-=8);g[C+te-fe]|=ue*128}},{}],15:[function(p,d,b){(function(g){(function(k){var C="undefined",L=C!==typeof g&&g,B=C!==typeof Uint8Array&&Uint8Array,h=C!==typeof ArrayBuffer&&ArrayBuffer,m=[0,0,0,0,0,0,0,0],y=Array.isArray||Xe,D=4294967296,K=16777216,Y;W("Uint64BE",!0,!0),W("Int64BE",!0,!1),W("Uint64LE",!1,!0),W("Int64LE",!1,!1);function W(Se,ce,be){var $=ce?0:4,X=ce?4:0,G=ce?0:3,ae=ce?1:2,ge=ce?2:1,we=ce?3:0,Be=ce?De:Ee,Re=ce?Ie:Ye,$e=Ae.prototype,Pe="is"+Se,Ue="_"+Pe;return $e.buffer=void 0,$e.offset=0,$e[Ue]=!0,$e.toNumber=nt,$e.toString=oe,$e.toJSON=nt,$e.toArray=ye,L&&($e.toBuffer=te),B&&($e.toArrayBuffer=fe),Ae[Pe]=ve,k[Se]=Ae,Ae;function Ae(ie,he,pe,le){return this instanceof Ae?He(this,ie,he,pe,le):new Ae(ie,he,pe,le)}function ve(ie){return!!(ie&&ie[Ue])}function He(ie,he,pe,le,qe){if(B&&h&&(he instanceof h&&(he=new B(he)),le instanceof h&&(le=new B(le))),!he&&!pe&&!le&&!Y){ie.buffer=Me(m,0);return}if(!ue(he,pe)){var o=Y||Array;qe=pe,le=he,pe=0,he=new o(8)}ie.buffer=he,ie.offset=pe|=0,C!==typeof le&&(typeof le=="string"?Fe(he,pe,le,qe||10):ue(le,qe)?de(he,pe,le,qe):typeof qe=="number"?(Ze(he,pe+$,le),Ze(he,pe+X,qe)):le>0?Be(he,pe,le):le<0?Re(he,pe,le):de(he,pe,m,0))}function Fe(ie,he,pe,le){var qe=0,o=pe.length,s=0,f=0;pe[0]==="-"&&qe++;for(var A=qe;qe<o;){var n=parseInt(pe[qe++],le);if(!(n>=0))break;f=f*le+n,s=s*le+Math.floor(f/D),f%=D}A&&(s=~s,f?f=D-f:s++),Ze(ie,he+$,s),Ze(ie,he+X,f)}function nt(){var ie=this.buffer,he=this.offset,pe=Qe(ie,he+$),le=Qe(ie,he+X);return be||(pe|=0),pe?pe*D+le:le}function oe(ie){var he=this.buffer,pe=this.offset,le=Qe(he,pe+$),qe=Qe(he,pe+X),o="",s=!be&&le&2147483648;for(s&&(le=~le,qe=D-qe),ie=ie||10;;){var f=le%ie*D+qe;if(le=Math.floor(le/ie),qe=Math.floor(f/ie),o=(f%ie).toString(ie)+o,!le&&!qe)break}return s&&(o="-"+o),o}function Ze(ie,he,pe){ie[he+we]=pe&255,pe=pe>>8,ie[he+ge]=pe&255,pe=pe>>8,ie[he+ae]=pe&255,pe=pe>>8,ie[he+G]=pe&255}function Qe(ie,he){return ie[he+G]*K+(ie[he+ae]<<16)+(ie[he+ge]<<8)+ie[he+we]}}function ye(Se){var ce=this.buffer,be=this.offset;return Y=null,Se!==!1&&be===0&&ce.length===8&&y(ce)?ce:Me(ce,be)}function te(Se){var ce=this.buffer,be=this.offset;if(Y=L,Se!==!1&&be===0&&ce.length===8&&g.isBuffer(ce))return ce;var $=new L(8);return de($,0,ce,be),$}function fe(Se){var ce=this.buffer,be=this.offset,$=ce.buffer;if(Y=B,Se!==!1&&be===0&&$ instanceof h&&$.byteLength===8)return $;var X=new B(8);return de(X,0,ce,be),X.buffer}function ue(Se,ce){var be=Se&&Se.length;return ce|=0,be&&ce+8<=be&&typeof Se[ce]!="string"}function de(Se,ce,be,$){ce|=0,$|=0;for(var X=0;X<8;X++)Se[ce++]=be[$++]&255}function Me(Se,ce){return Array.prototype.slice.call(Se,ce,ce+8)}function De(Se,ce,be){for(var $=ce+8;$>ce;)Se[--$]=be&255,be/=256}function Ie(Se,ce,be){var $=ce+8;for(be++;$>ce;)Se[--$]=-be&255^255,be/=256}function Ee(Se,ce,be){for(var $=ce+8;ce<$;)Se[ce++]=be&255,be/=256}function Ye(Se,ce,be){var $=ce+8;for(be++;ce<$;)Se[ce++]=-be&255^255,be/=256}function Xe(Se){return!!Se&&Object.prototype.toString.call(Se)=="[object Array]"}})(typeof b=="object"&&typeof b.nodeName!="string"?b:this||{})}).call(this,p("buffer").Buffer)},{buffer:7}],16:[function(p,d,b){var g={}.toString;d.exports=Array.isArray||function(k){return g.call(k)=="[object Array]"}},{}],17:[function(p,d,b){var g={128:{name:"ChapterDisplay",level:4,type:"m",multiple:!0,minver:1,webm:!0,description:"Contains all possible strings to use for the chapter display."},131:{name:"TrackType",level:3,type:"u",mandatory:!0,minver:1,range:"1-254",description:"A set of track types coded on 8 bits (1: video, 2: audio, 3: complex, 0x10: logo, 0x11: subtitle, 0x12: buttons, 0x20: control)."},133:{name:"ChapString",cppname:"ChapterString",level:5,type:"8",mandatory:!0,minver:1,webm:!0,description:"Contains the string to use as the chapter atom."},134:{name:"CodecID",level:3,type:"s",mandatory:!0,minver:1,description:"An ID corresponding to the codec, see the codec page for more info."},136:{name:"FlagDefault",cppname:"TrackFlagDefault",level:3,type:"u",mandatory:!0,minver:1,default:1,range:"0-1",description:"Set if that track (audio, video or subs) SHOULD be active if no language found matches the user preference. (1 bit)"},137:{name:"ChapterTrackNumber",level:5,type:"u",mandatory:!0,multiple:!0,minver:1,webm:!1,range:"not 0",description:"UID of the Track to apply this chapter too. In the absense of a control track, choosing this chapter will select the listed Tracks and deselect unlisted tracks. Absense of this element indicates that the Chapter should be applied to any currently used Tracks."},145:{name:"ChapterTimeStart",level:4,type:"u",mandatory:!0,minver:1,webm:!0,description:"Timestamp of the start of Chapter (not scaled)."},146:{name:"ChapterTimeEnd",level:4,type:"u",minver:1,webm:!1,description:"Timestamp of the end of Chapter (timestamp excluded, not scaled)."},150:{name:"CueRefTime",level:5,type:"u",mandatory:!0,minver:2,webm:!1,description:"Timestamp of the referenced Block."},151:{name:"CueRefCluster",level:5,type:"u",mandatory:!0,webm:!1,description:"The Position of the Cluster containing the referenced Block."},152:{name:"ChapterFlagHidden",level:4,type:"u",mandatory:!0,minver:1,webm:!1,default:0,range:"0-1",description:"If a chapter is hidden (1), it should not be available to the user interface (but still to Control Tracks; see flag notes). (1 bit)"},16980:{name:"ContentCompAlgo",level:6,type:"u",mandatory:!0,minver:1,webm:!1,default:0,description:"The compression algorithm used. Algorithms that have been specified so far are: 0 - zlib,   3 - Header Stripping"},16981:{name:"ContentCompSettings",level:6,type:"b",minver:1,webm:!1,description:"Settings that might be needed by the decompressor. For Header Stripping (ContentCompAlgo=3), the bytes that were removed from the beggining of each frames of the track."},17026:{name:"DocType",level:1,type:"s",mandatory:!0,default:"matroska",minver:1,description:"A string that describes the type of document that follows this EBML header. 'matroska' in our case or 'webm' for webm files."},17029:{name:"DocTypeReadVersion",level:1,type:"u",mandatory:!0,default:1,minver:1,description:"The minimum DocType version an interpreter has to support to read this file."},17030:{name:"EBMLVersion",level:1,type:"u",mandatory:!0,default:1,minver:1,description:"The version of EBML parser used to create the file."},17031:{name:"DocTypeVersion",level:1,type:"u",mandatory:!0,default:1,minver:1,description:"The version of DocType interpreter used to create the file."},17476:{name:"SegmentFamily",level:2,type:"b",multiple:!0,minver:1,webm:!1,bytesize:16,description:"A randomly generated unique ID that all segments related to each other must use (128 bits)."},17505:{name:"DateUTC",level:2,type:"d",minver:1,description:"Date of the origin of timestamp (value 0), i.e. production date."},17540:{name:"TagDefault",level:4,type:"u",mandatory:!0,minver:1,webm:!1,default:1,range:"0-1",description:"Indication to know if this is the default/original language to use for the given tag. (1 bit)"},17541:{name:"TagBinary",level:4,type:"b",minver:1,webm:!1,description:"The values of the Tag if it is binary. Note that this cannot be used in the same SimpleTag as TagString."},17543:{name:"TagString",level:4,type:"8",minver:1,webm:!1,description:"The value of the Element."},17545:{name:"Duration",level:2,type:"f",minver:1,range:"> 0",description:"Duration of the segment (based on TimecodeScale)."},17816:{name:"ChapterFlagEnabled",level:4,type:"u",mandatory:!0,minver:1,webm:!1,default:1,range:"0-1",description:"Specify wether the chapter is enabled. It can be enabled/disabled by a Control Track. When disabled, the movie should skip all the content between the TimeStart and TimeEnd of this chapter (see flag notes). (1 bit)"},18016:{name:"FileMimeType",level:3,type:"s",mandatory:!0,minver:1,webm:!1,description:"MIME type of the file."},18017:{name:"FileUsedStartTime",level:3,type:"u",divx:!0,description:"DivX font extension"},18018:{name:"FileUsedEndTime",level:3,type:"u",divx:!0,description:"DivX font extension"},18037:{name:"FileReferral",level:3,type:"b",webm:!1,description:"A binary value that a track/codec can refer to when the attachment is needed."},20529:{name:"ContentEncodingOrder",level:5,type:"u",mandatory:!0,minver:1,webm:!1,default:0,description:"Tells when this modification was used during encoding/muxing starting with 0 and counting upwards. The decoder/demuxer has to start with the highest order number it finds and work its way down. This value has to be unique over all ContentEncodingOrder elements in the segment."},20530:{name:"ContentEncodingScope",level:5,type:"u",mandatory:!0,minver:1,webm:!1,default:1,range:"not 0",description:"A bit field that describes which elements have been modified in this way. Values (big endian) can be OR'ed. Possible values: 1 - all frame contents, 2 - the track's private data, 4 - the next ContentEncoding (next ContentEncodingOrder. Either the data inside ContentCompression and/or ContentEncryption)"},20531:{name:"ContentEncodingType",level:5,type:"u",mandatory:!0,minver:1,webm:!1,default:0,description:"A value describing what kind of transformation has been done. Possible values: 0 - compression, 1 - encryption"},20532:{name:"ContentCompression",level:5,type:"m",minver:1,webm:!1,description:"Settings describing the compression used. Must be present if the value of ContentEncodingType is 0 and absent otherwise. Each block must be decompressable even if no previous block is available in order not to prevent seeking."},20533:{name:"ContentEncryption",level:5,type:"m",minver:1,webm:!1,description:"Settings describing the encryption used. Must be present if the value of ContentEncodingType is 1 and absent otherwise."},21368:{name:"CueBlockNumber",level:4,type:"u",minver:1,default:1,range:"not 0",description:"Number of the Block in the specified Cluster."},22100:{name:"ChapterStringUID",level:4,type:"8",mandatory:!1,minver:3,webm:!0,description:"A unique string ID to identify the Chapter. Use for WebVTT cue identifier storage."},22337:{name:"WritingApp",level:2,type:"8",mandatory:!0,minver:1,description:'Writing application ("mkvmerge-0.3.3").'},22612:{name:"SilentTracks",cppname:"ClusterSilentTracks",level:2,type:"m",minver:1,webm:!1,description:"The list of tracks that are not used in that part of the stream. It is useful when using overlay tracks on seeking. Then you should decide what track to use."},25152:{name:"ContentEncoding",level:4,type:"m",mandatory:!0,multiple:!0,minver:1,webm:!1,description:"Settings for one content encoding like compression or encryption."},25188:{name:"BitDepth",cppname:"AudioBitDepth",level:4,type:"u",minver:1,range:"not 0",description:"Bits per sample, mostly used for PCM."},25906:{name:"SignedElement",level:3,type:"b",multiple:!0,webm:!1,description:"An element ID whose data will be used to compute the signature."},26148:{name:"TrackTranslate",level:3,type:"m",multiple:!0,minver:1,webm:!1,description:"The track identification for the given Chapter Codec."},26897:{name:"ChapProcessCommand",cppname:"ChapterProcessCommand",level:5,type:"m",multiple:!0,minver:1,webm:!1,description:"Contains all the commands associated to the Atom."},26914:{name:"ChapProcessTime",cppname:"ChapterProcessTime",level:6,type:"u",mandatory:!0,minver:1,webm:!1,description:"Defines when the process command should be handled (0: during the whole chapter, 1: before starting playback, 2: after playback of the chapter)."},26916:{name:"ChapterTranslate",level:2,type:"m",multiple:!0,minver:1,webm:!1,description:"A tuple of corresponding ID used by chapter codecs to represent this segment."},26931:{name:"ChapProcessData",cppname:"ChapterProcessData",level:6,type:"b",mandatory:!0,minver:1,webm:!1,description:"Contains the command information. The data should be interpreted depending on the ChapProcessCodecID value. For ChapProcessCodecID = 1, the data correspond to the binary DVD cell pre/post commands."},26948:{name:"ChapProcess",cppname:"ChapterProcess",level:4,type:"m",multiple:!0,minver:1,webm:!1,description:"Contains all the commands associated to the Atom."},26965:{name:"ChapProcessCodecID",cppname:"ChapterProcessCodecID",level:5,type:"u",mandatory:!0,minver:1,webm:!1,default:0,description:"Contains the type of the codec used for the processing. A value of 0 means native Matroska processing (to be defined), a value of 1 means the DVD command set is used. More codec IDs can be added later."},29555:{name:"Tag",level:2,type:"m",mandatory:!0,multiple:!0,minver:1,webm:!1,description:"Element containing elements specific to Tracks/Chapters."},29572:{name:"SegmentFilename",level:2,type:"8",minver:1,webm:!1,description:"A filename corresponding to this segment."},29766:{name:"AttachmentLink",cppname:"TrackAttachmentLink",level:3,type:"u",minver:1,webm:!1,range:"not 0",description:"The UID of an attachment that is used by this codec."},2459272:{name:"CodecName",level:3,type:"8",minver:1,description:"A human-readable string specifying the codec."},408125543:{name:"Segment",level:"0",type:"m",mandatory:!0,multiple:!0,minver:1,description:"This element contains all other top-level (level 1) elements. Typically a Matroska file is composed of 1 segment."},17530:{name:"TagLanguage",level:4,type:"s",mandatory:!0,minver:1,webm:!1,default:"und",description:"Specifies the language of the tag specified, in the Matroska languages form."},17827:{name:"TagName",level:4,type:"8",mandatory:!0,minver:1,webm:!1,description:"The name of the Tag that is going to be stored."},26568:{name:"SimpleTag",cppname:"TagSimple",level:3,recursive:"1",type:"m",mandatory:!0,multiple:!0,minver:1,webm:!1,description:"Contains general information about the target."},25542:{name:"TagAttachmentUID",level:4,type:"u",multiple:!0,minver:1,webm:!1,default:0,description:"A unique ID to identify the Attachment(s) the tags belong to. If the value is 0 at this level, the tags apply to all the attachments in the Segment."},25540:{name:"TagChapterUID",level:4,type:"u",multiple:!0,minver:1,webm:!1,default:0,description:"A unique ID to identify the Chapter(s) the tags belong to. If the value is 0 at this level, the tags apply to all chapters in the Segment."},25545:{name:"TagEditionUID",level:4,type:"u",multiple:!0,minver:1,webm:!1,default:0,description:"A unique ID to identify the EditionEntry(s) the tags belong to. If the value is 0 at this level, the tags apply to all editions in the Segment."},25541:{name:"TagTrackUID",level:4,type:"u",multiple:!0,minver:1,webm:!1,default:0,description:"A unique ID to identify the Track(s) the tags belong to. If the value is 0 at this level, the tags apply to all tracks in the Segment."},25546:{name:"TargetType",cppname:"TagTargetType",level:4,type:"s",minver:1,webm:!1,strong:"informational",description:'An  string that can be used to display the logical level of the target like "ALBUM", "TRACK", "MOVIE", "CHAPTER", etc (see TargetType).'},26826:{name:"TargetTypeValue",cppname:"TagTargetTypeValue",level:4,type:"u",minver:1,webm:!1,default:50,description:"A number to indicate the logical level of the target (see TargetType)."},25536:{name:"Targets",cppname:"TagTargets",level:3,type:"m",mandatory:!0,minver:1,webm:!1,description:"Contain all UIDs where the specified meta data apply. It is empty to describe everything in the segment."},307544935:{name:"Tags",level:1,type:"m",multiple:!0,minver:1,webm:!1,description:"Element containing elements specific to Tracks/Chapters. A list of valid tags can be found here."},17677:{name:"ChapProcessPrivate",cppname:"ChapterProcessPrivate",level:5,type:"b",minver:1,webm:!1,description:'Some optional data attached to the ChapProcessCodecID information. For ChapProcessCodecID = 1, it is the "DVD level" equivalent.'},17278:{name:"ChapCountry",cppname:"ChapterCountry",level:5,type:"s",multiple:!0,minver:1,webm:!1,description:"The countries corresponding to the string, same 2 octets as in Internet domains."},17276:{name:"ChapLanguage",cppname:"ChapterLanguage",level:5,type:"s",mandatory:!0,multiple:!0,minver:1,webm:!0,default:"eng",description:"The languages corresponding to the string, in the bibliographic ISO-639-2 form."},143:{name:"ChapterTrack",level:4,type:"m",minver:1,webm:!1,description:"List of tracks on which the chapter applies. If this element is not present, all tracks apply"},25539:{name:"ChapterPhysicalEquiv",level:4,type:"u",minver:1,webm:!1,description:'Specify the physical equivalent of this ChapterAtom like "DVD" (60) or "SIDE" (50), see complete list of values.'},28348:{name:"ChapterSegmentEditionUID",level:4,type:"u",minver:1,webm:!1,range:"not 0",description:"The EditionUID to play from the segment linked in ChapterSegmentUID."},28263:{name:"ChapterSegmentUID",level:4,type:"b",minver:1,webm:!1,range:">0",bytesize:16,description:"A segment to play in place of this chapter. Edition ChapterSegmentEditionUID should be used for this segment, otherwise no edition is used."},29636:{name:"ChapterUID",level:4,type:"u",mandatory:!0,minver:1,webm:!0,range:"not 0",description:"A unique ID to identify the Chapter."},182:{name:"ChapterAtom",level:3,recursive:"1",type:"m",mandatory:!0,multiple:!0,minver:1,webm:!0,description:"Contains the atom information to use as the chapter atom (apply to all tracks)."},17885:{name:"EditionFlagOrdered",level:3,type:"u",minver:1,webm:!1,default:0,range:"0-1",description:"Specify if the chapters can be defined multiple times and the order to play them is enforced. (1 bit)"},17883:{name:"EditionFlagDefault",level:3,type:"u",mandatory:!0,minver:1,webm:!1,default:0,range:"0-1",description:"If a flag is set (1) the edition should be used as the default one. (1 bit)"},17853:{name:"EditionFlagHidden",level:3,type:"u",mandatory:!0,minver:1,webm:!1,default:0,range:"0-1",description:"If an edition is hidden (1), it should not be available to the user interface (but still to Control Tracks; see flag notes). (1 bit)"},17852:{name:"EditionUID",level:3,type:"u",minver:1,webm:!1,range:"not 0",description:"A unique ID to identify the edition. It's useful for tagging an edition."},17849:{name:"EditionEntry",level:2,type:"m",mandatory:!0,multiple:!0,minver:1,webm:!0,description:"Contains all information about a segment edition."},272869232:{name:"Chapters",level:1,type:"m",minver:1,webm:!0,description:"A system to define basic menus and partition data. For more detailed information, look at the Chapters Explanation."},18094:{name:"FileUID",level:3,type:"u",mandatory:!0,minver:1,webm:!1,range:"not 0",description:"Unique ID representing the file, as random as possible."},18012:{name:"FileData",level:3,type:"b",mandatory:!0,minver:1,webm:!1,description:"The data of the file."},18030:{name:"FileName",level:3,type:"8",mandatory:!0,minver:1,webm:!1,description:"Filename of the attached file."},18046:{name:"FileDescription",level:3,type:"8",minver:1,webm:!1,description:"A human-friendly name for the attached file."},24999:{name:"AttachedFile",level:2,type:"m",mandatory:!0,multiple:!0,minver:1,webm:!1,description:"An attached file."},423732329:{name:"Attachments",level:1,type:"m",minver:1,webm:!1,description:"Contain attached files."},235:{name:"CueRefCodecState",level:5,type:"u",webm:!1,default:0,description:"The position of the Codec State corresponding to this referenced element. 0 means that the data is taken from the initial Track Entry."},21343:{name:"CueRefNumber",level:5,type:"u",webm:!1,default:1,range:"not 0",description:"Number of the referenced Block of Track X in the specified Cluster."},219:{name:"CueReference",level:4,type:"m",multiple:!0,minver:2,webm:!1,description:"The Clusters containing the required referenced Blocks."},234:{name:"CueCodecState",level:4,type:"u",minver:2,webm:!1,default:0,description:"The position of the Codec State corresponding to this Cue element. 0 means that the data is taken from the initial Track Entry."},178:{name:"CueDuration",level:4,type:"u",mandatory:!1,minver:4,webm:!1,description:"The duration of the block according to the segment time base. If missing the track's DefaultDuration does not apply and no duration information is available in terms of the cues."},240:{name:"CueRelativePosition",level:4,type:"u",mandatory:!1,minver:4,webm:!1,description:"The relative position of the referenced block inside the cluster with 0 being the first possible position for an element inside that cluster.",position:"clusterRelative"},241:{name:"CueClusterPosition",level:4,type:"u",mandatory:!0,minver:1,description:"The position of the Cluster containing the required Block.",position:"segment"},247:{name:"CueTrack",level:4,type:"u",mandatory:!0,minver:1,range:"not 0",description:"The track for which a position is given."},183:{name:"CueTrackPositions",level:3,type:"m",mandatory:!0,multiple:!0,minver:1,description:"Contain positions for different tracks corresponding to the timestamp."},179:{name:"CueTime",level:3,type:"u",mandatory:!0,minver:1,description:"Absolute timestamp according to the segment time base."},187:{name:"CuePoint",level:2,type:"m",mandatory:!0,multiple:!0,minver:1,description:"Contains all information relative to a seek point in the segment."},475249515:{name:"Cues",level:1,type:"m",minver:1,description:'A top-level element to speed seeking access. All entries are local to the segment. Should be mandatory for non "live" streams.'},18406:{name:"ContentSigHashAlgo",level:6,type:"u",minver:1,webm:!1,default:0,description:"The hash algorithm used for the signature. A value of '0' means that the contents have not been signed but only encrypted. Predefined values: 1 - SHA1-160 2 - MD5"},18405:{name:"ContentSigAlgo",level:6,type:"u",minver:1,webm:!1,default:0,description:"The algorithm used for the signature. A value of '0' means that the contents have not been signed but only encrypted. Predefined values: 1 - RSA"},18404:{name:"ContentSigKeyID",level:6,type:"b",minver:1,webm:!1,description:"This is the ID of the private key the data was signed with."},18403:{name:"ContentSignature",level:6,type:"b",minver:1,webm:!1,description:"A cryptographic signature of the contents."},18402:{name:"ContentEncKeyID",level:6,type:"b",minver:1,webm:!1,description:"For public key algorithms this is the ID of the public key the the data was encrypted with."},18401:{name:"ContentEncAlgo",level:6,type:"u",minver:1,webm:!1,default:0,description:"The encryption algorithm used. The value '0' means that the contents have not been encrypted but only signed. Predefined values: 1 - DES, 2 - 3DES, 3 - Twofish, 4 - Blowfish, 5 - AES"},28032:{name:"ContentEncodings",level:3,type:"m",minver:1,webm:!1,description:"Settings for several content encoding mechanisms like compression or encryption."},196:{name:"TrickMasterTrackSegmentUID",level:3,type:"b",divx:!0,bytesize:16,description:"DivX trick track extenstions"},199:{name:"TrickMasterTrackUID",level:3,type:"u",divx:!0,description:"DivX trick track extenstions"},198:{name:"TrickTrackFlag",level:3,type:"u",divx:!0,default:0,description:"DivX trick track extenstions"},193:{name:"TrickTrackSegmentUID",level:3,type:"b",divx:!0,bytesize:16,description:"DivX trick track extenstions"},192:{name:"TrickTrackUID",level:3,type:"u",divx:!0,description:"DivX trick track extenstions"},237:{name:"TrackJoinUID",level:5,type:"u",mandatory:!0,multiple:!0,minver:3,webm:!1,range:"not 0",description:"The trackUID number of a track whose blocks are used to create this virtual track."},233:{name:"TrackJoinBlocks",level:4,type:"m",minver:3,webm:!1,description:"Contains the list of all tracks whose Blocks need to be combined to create this virtual track"},230:{name:"TrackPlaneType",level:6,type:"u",mandatory:!0,minver:3,webm:!1,description:"The kind of plane this track corresponds to (0: left eye, 1: right eye, 2: background)."},229:{name:"TrackPlaneUID",level:6,type:"u",mandatory:!0,minver:3,webm:!1,range:"not 0",description:"The trackUID number of the track representing the plane."},228:{name:"TrackPlane",level:5,type:"m",mandatory:!0,multiple:!0,minver:3,webm:!1,description:"Contains a video plane track that need to be combined to create this 3D track"},227:{name:"TrackCombinePlanes",level:4,type:"m",minver:3,webm:!1,description:"Contains the list of all video plane tracks that need to be combined to create this 3D track"},226:{name:"TrackOperation",level:3,type:"m",minver:3,webm:!1,description:"Operation that needs to be applied on tracks to create this virtual track. For more details look at the Specification Notes on the subject."},32123:{name:"ChannelPositions",cppname:"AudioPosition",level:4,type:"b",webm:!1,description:"Table of horizontal angles for each successive channel, see appendix."},159:{name:"Channels",cppname:"AudioChannels",level:4,type:"u",mandatory:!0,minver:1,default:1,range:"not 0",description:"Numbers of channels in the track."},30901:{name:"OutputSamplingFrequency",cppname:"AudioOutputSamplingFreq",level:4,type:"f",minver:1,default:"Sampling Frequency",range:"> 0",description:"Real output sampling frequency in Hz (used for SBR techniques)."},181:{name:"SamplingFrequency",cppname:"AudioSamplingFreq",level:4,type:"f",mandatory:!0,minver:1,default:8e3,range:"> 0",description:"Sampling frequency in Hz."},225:{name:"Audio",cppname:"TrackAudio",level:3,type:"m",minver:1,description:"Audio settings."},2327523:{name:"FrameRate",cppname:"VideoFrameRate",level:4,type:"f",range:"> 0",strong:"Informational",description:"Number of frames per second.  only."},3126563:{name:"GammaValue",cppname:"VideoGamma",level:4,type:"f",webm:!1,range:"> 0",description:"Gamma Value."},3061028:{name:"ColourSpace",cppname:"VideoColourSpace",level:4,type:"b",minver:1,webm:!1,bytesize:4,description:"Same value as in AVI (32 bits)."},21683:{name:"AspectRatioType",cppname:"VideoAspectRatio",level:4,type:"u",minver:1,default:0,description:"Specify the possible modifications to the aspect ratio (0: free resizing, 1: keep aspect ratio, 2: fixed)."},21682:{name:"DisplayUnit",cppname:"VideoDisplayUnit",level:4,type:"u",minver:1,default:0,description:"How DisplayWidth & DisplayHeight should be interpreted (0: pixels, 1: centimeters, 2: inches, 3: Display Aspect Ratio)."},21690:{name:"DisplayHeight",cppname:"VideoDisplayHeight",level:4,type:"u",minver:1,default:"PixelHeight",range:"not 0",description:"Height of the video frames to display. The default value is only valid when DisplayUnit is 0."},21680:{name:"DisplayWidth",cppname:"VideoDisplayWidth",level:4,type:"u",minver:1,default:"PixelWidth",range:"not 0",description:"Width of the video frames to display. The default value is only valid when DisplayUnit is 0."},21725:{name:"PixelCropRight",cppname:"VideoPixelCropRight",level:4,type:"u",minver:1,default:0,description:"The number of video pixels to remove on the right of the image."},21708:{name:"PixelCropLeft",cppname:"VideoPixelCropLeft",level:4,type:"u",minver:1,default:0,description:"The number of video pixels to remove on the left of the image."},21691:{name:"PixelCropTop",cppname:"VideoPixelCropTop",level:4,type:"u",minver:1,default:0,description:"The number of video pixels to remove at the top of the image."},21674:{name:"PixelCropBottom",cppname:"VideoPixelCropBottom",level:4,type:"u",minver:1,default:0,description:"The number of video pixels to remove at the bottom of the image (for HDTV content)."},186:{name:"PixelHeight",cppname:"VideoPixelHeight",level:4,type:"u",mandatory:!0,minver:1,range:"not 0",description:"Height of the encoded video frames in pixels."},176:{name:"PixelWidth",cppname:"VideoPixelWidth",level:4,type:"u",mandatory:!0,minver:1,range:"not 0",description:"Width of the encoded video frames in pixels."},21433:{name:"OldStereoMode",level:4,type:"u",maxver:"0",webm:!1,divx:!1,description:"DEPRECATED, DO NOT USE. Bogus StereoMode value used in old versions of libmatroska. (0: mono, 1: right eye, 2: left eye, 3: both eyes)."},21440:{name:"AlphaMode",cppname:"VideoAlphaMode",level:4,type:"u",minver:3,webm:!0,default:0,description:"Alpha Video Mode. Presence of this element indicates that the BlockAdditional element could contain Alpha data."},21432:{name:"StereoMode",cppname:"VideoStereoMode",level:4,type:"u",minver:3,webm:!0,default:0,description:"Stereo-3D video mode (0: mono, 1: side by side (left eye is first), 2: top-bottom (right eye is first), 3: top-bottom (left eye is first), 4: checkboard (right is first), 5: checkboard (left is first), 6: row interleaved (right is first), 7: row interleaved (left is first), 8: column interleaved (right is first), 9: column interleaved (left is first), 10: anaglyph (cyan/red), 11: side by side (right eye is first), 12: anaglyph (green/magenta), 13 both eyes laced in one Block (left eye is first), 14 both eyes laced in one Block (right eye is first)) . There are some more details on 3D support in the Specification Notes."},154:{name:"FlagInterlaced",cppname:"VideoFlagInterlaced",level:4,type:"u",mandatory:!0,minver:2,webm:!0,default:0,range:"0-1",description:"Set if the video is interlaced. (1 bit)"},224:{name:"Video",cppname:"TrackVideo",level:3,type:"m",minver:1,description:"Video settings."},26277:{name:"TrackTranslateTrackID",level:4,type:"b",mandatory:!0,minver:1,webm:!1,description:"The binary value used to represent this track in the chapter codec data. The format depends on the ChapProcessCodecID used."},26303:{name:"TrackTranslateCodec",level:4,type:"u",mandatory:!0,minver:1,webm:!1,description:"The chapter codec using this ID (0: Matroska Script, 1: DVD-menu)."},26364:{name:"TrackTranslateEditionUID",level:4,type:"u",multiple:!0,minver:1,webm:!1,description:"Specify an edition UID on which this translation applies. When not specified, it means for all editions found in the segment."},22203:{name:"SeekPreRoll",level:3,type:"u",mandatory:!0,multiple:!1,default:0,minver:4,webm:!0,description:"After a discontinuity, SeekPreRoll is the duration in nanoseconds of the data the decoder must decode before the decoded data is valid."},22186:{name:"CodecDelay",level:3,type:"u",multiple:!1,default:0,minver:4,webm:!0,description:"CodecDelay is The codec-built-in delay in nanoseconds. This value must be subtracted from each block timestamp in order to get the actual timestamp. The value should be small so the muxing of tracks with the same actual timestamp are in the same Cluster."},28587:{name:"TrackOverlay",level:3,type:"u",multiple:!0,minver:1,webm:!1,description:"Specify that this track is an overlay track for the Track specified (in the u-integer). That means when this track has a gap (see SilentTracks) the overlay track should be used instead. The order of multiple TrackOverlay matters, the first one is the one that should be used. If not found it should be the second, etc."},170:{name:"CodecDecodeAll",level:3,type:"u",mandatory:!0,minver:2,webm:!1,default:1,range:"0-1",description:"The codec can decode potentially damaged data (1 bit)."},2536e3:{name:"CodecDownloadURL",level:3,type:"s",multiple:!0,webm:!1,description:"A URL to download about the codec used."},3883072:{name:"CodecInfoURL",level:3,type:"s",multiple:!0,webm:!1,description:"A URL to find information about the codec used."},3839639:{name:"CodecSettings",level:3,type:"8",webm:!1,description:"A string describing the encoding setting used."},25506:{name:"CodecPrivate",level:3,type:"b",minver:1,description:"Private data only known to the codec."},2274716:{name:"Language",cppname:"TrackLanguage",level:3,type:"s",minver:1,default:"eng",description:"Specifies the language of the track in the Matroska languages form."},21358:{name:"Name",cppname:"TrackName",level:3,type:"8",minver:1,description:"A human-readable track name."},21998:{name:"MaxBlockAdditionID",level:3,type:"u",mandatory:!0,minver:1,webm:!1,default:0,description:"The maximum value of BlockAdditions for this track."},21375:{name:"TrackOffset",level:3,type:"i",webm:!1,default:0,description:"A value to add to the Block's Timestamp. This can be used to adjust the playback offset of a track."},2306383:{name:"TrackTimecodeScale",level:3,type:"f",mandatory:!0,minver:1,maxver:"3",webm:!1,default:1,range:"> 0",description:"DEPRECATED, DO NOT USE. The scale to apply on this track to work at normal speed in relation with other tracks (mostly used to adjust video speed when the audio length differs)."},2313850:{name:"DefaultDecodedFieldDuration",cppname:"TrackDefaultDecodedFieldDuration",level:3,type:"u",minver:4,range:"not 0",description:`The period in nanoseconds (not scaled by TimcodeScale)
between two successive fields at the output of the decoding process (see the notes)`},2352003:{name:"DefaultDuration",cppname:"TrackDefaultDuration",level:3,type:"u",minver:1,range:"not 0",description:"Number of nanoseconds (not scaled via TimecodeScale) per frame ('frame' in the Matroska sense -- one element put into a (Simple)Block)."},28152:{name:"MaxCache",cppname:"TrackMaxCache",level:3,type:"u",minver:1,webm:!1,description:"The maximum cache size required to store referenced frames in and the current frame. 0 means no cache is needed."},28135:{name:"MinCache",cppname:"TrackMinCache",level:3,type:"u",mandatory:!0,minver:1,webm:!1,default:0,description:"The minimum number of frames a player should be able to cache during playback. If set to 0, the reference pseudo-cache system is not used."},156:{name:"FlagLacing",cppname:"TrackFlagLacing",level:3,type:"u",mandatory:!0,minver:1,default:1,range:"0-1",description:"Set if the track may contain blocks using lacing. (1 bit)"},21930:{name:"FlagForced",cppname:"TrackFlagForced",level:3,type:"u",mandatory:!0,minver:1,default:0,range:"0-1",description:"Set if that track MUST be active during playback. There can be many forced track for a kind (audio, video or subs), the player should select the one which language matches the user preference or the default + forced track. Overlay MAY happen between a forced and non-forced track of the same kind. (1 bit)"},185:{name:"FlagEnabled",cppname:"TrackFlagEnabled",level:3,type:"u",mandatory:!0,minver:2,webm:!0,default:1,range:"0-1",description:"Set if the track is usable. (1 bit)"},29637:{name:"TrackUID",level:3,type:"u",mandatory:!0,minver:1,range:"not 0",description:"A unique ID to identify the Track. This should be kept the same when making a direct stream copy of the Track to another file."},215:{name:"TrackNumber",level:3,type:"u",mandatory:!0,minver:1,range:"not 0",description:"The track number as used in the Block Header (using more than 127 tracks is not encouraged, though the design allows an unlimited number)."},174:{name:"TrackEntry",level:2,type:"m",mandatory:!0,multiple:!0,minver:1,description:"Describes a track with all elements."},374648427:{name:"Tracks",level:1,type:"m",multiple:!0,minver:1,description:"A top-level block of information with many tracks described."},175:{name:"EncryptedBlock",level:2,type:"b",multiple:!0,webm:!1,description:"Similar to EncryptedBlock Structure)"},202:{name:"ReferenceTimeCode",level:4,type:"u",multiple:!1,mandatory:!0,minver:0,webm:!1,divx:!0,description:"DivX trick track extenstions"},201:{name:"ReferenceOffset",level:4,type:"u",multiple:!1,mandatory:!0,minver:0,webm:!1,divx:!0,description:"DivX trick track extenstions"},200:{name:"ReferenceFrame",level:3,type:"m",multiple:!1,minver:0,webm:!1,divx:!0,description:"DivX trick track extenstions"},207:{name:"SliceDuration",level:5,type:"u",default:0,description:"The (scaled) duration to apply to the element."},206:{name:"Delay",cppname:"SliceDelay",level:5,type:"u",default:0,description:"The (scaled) delay to apply to the element."},203:{name:"BlockAdditionID",cppname:"SliceBlockAddID",level:5,type:"u",default:0,description:"The ID of the BlockAdditional element (0 is the main Block)."},205:{name:"FrameNumber",cppname:"SliceFrameNumber",level:5,type:"u",default:0,description:"The number of the frame to generate from this lace with this delay (allow you to generate many frames from the same Block/Frame)."},204:{name:"LaceNumber",cppname:"SliceLaceNumber",level:5,type:"u",minver:1,default:0,divx:!1,description:"The reverse number of the frame in the lace (0 is the last frame, 1 is the next to last, etc). While there are a few files in the wild with this element, it is no longer in use and has been deprecated. Being able to interpret this element is not required for playback."},232:{name:"TimeSlice",level:4,type:"m",multiple:!0,minver:1,divx:!1,description:"Contains extra time information about the data contained in the Block. While there are a few files in the wild with this element, it is no longer in use and has been deprecated. Being able to interpret this element is not required for playback."},142:{name:"Slices",level:3,type:"m",minver:1,divx:!1,description:"Contains slices description."},30114:{name:"DiscardPadding",level:3,type:"i",minver:4,webm:!0,description:"Duration in nanoseconds of the silent data added to the Block (padding at the end of the Block for positive value, at the beginning of the Block for negative value). The duration of DiscardPadding is not calculated in the duration of the TrackEntry and should be discarded during playback."},164:{name:"CodecState",level:3,type:"b",minver:2,webm:!1,description:"The new codec state to use. Data interpretation is private to the codec. This information should always be referenced by a seek entry."},253:{name:"ReferenceVirtual",level:3,type:"i",webm:!1,description:"Relative position of the data that should be in position of the virtual block."},251:{name:"ReferenceBlock",level:3,type:"i",multiple:!0,minver:1,description:"Timestamp of another frame used as a reference (ie: B or P frame). The timestamp is relative to the block it's attached to."},250:{name:"ReferencePriority",cppname:"FlagReferenced",level:3,type:"u",mandatory:!0,minver:1,webm:!1,default:0,description:"This frame is referenced and has the specified cache priority. In cache only a frame of the same or higher priority can replace this frame. A value of 0 means the frame is not referenced."},155:{name:"BlockDuration",level:3,type:"u",minver:1,default:"TrackDuration",description:'The duration of the Block (based on TimecodeScale). This element is mandatory when DefaultDuration is set for the track (but can be omitted as other default values). When not written and with no DefaultDuration, the value is assumed to be the difference between the timestamp of this Block and the timestamp of the next Block in "display" order (not coding order). This element can be useful at the end of a Track (as there is not other Block available), or when there is a break in a track like for subtitle tracks. When set to 0 that means the frame is not a keyframe.'},165:{name:"BlockAdditional",level:5,type:"b",mandatory:!0,minver:1,webm:!1,description:"Interpreted by the codec as it wishes (using the BlockAddID)."},238:{name:"BlockAddID",level:5,type:"u",mandatory:!0,minver:1,webm:!1,default:1,range:"not 0",description:"An ID to identify the BlockAdditional level."},166:{name:"BlockMore",level:4,type:"m",mandatory:!0,multiple:!0,minver:1,webm:!1,description:"Contain the BlockAdditional and some parameters."},30113:{name:"BlockAdditions",level:3,type:"m",minver:1,webm:!1,description:"Contain additional blocks to complete the main one. An EBML parser that has no knowledge of the Block structure could still see and use/skip these data."},162:{name:"BlockVirtual",level:3,type:"b",webm:!1,description:"A Block with no data. It must be stored in the stream at the place the real Block should be in display order. (see Block Virtual)"},161:{name:"Block",level:3,type:"b",mandatory:!0,minver:1,description:"Block containing the actual data to be rendered and a timestamp relative to the Cluster Timecode. (see Block Structure)"},160:{name:"BlockGroup",level:2,type:"m",multiple:!0,minver:1,description:"Basic container of information containing a single Block or BlockVirtual, and information specific to that Block/VirtualBlock."},163:{name:"SimpleBlock",level:2,type:"b",multiple:!0,minver:2,webm:!0,divx:!0,description:"Similar to SimpleBlock Structure"},171:{name:"PrevSize",cppname:"ClusterPrevSize",level:2,type:"u",minver:1,description:"Size of the previous Cluster, in octets. Can be useful for backward playing.",position:"prevCluster"},167:{name:"Position",cppname:"ClusterPosition",level:2,type:"u",minver:1,webm:!1,description:"The Position of the Cluster in the segment (0 in live broadcast streams). It might help to resynchronise offset on damaged streams.",position:"segment"},22743:{name:"SilentTrackNumber",cppname:"ClusterSilentTrackNumber",level:3,type:"u",multiple:!0,minver:1,webm:!1,description:"One of the track number that are not used from now on in the stream. It could change later if not specified as silent in a further Cluster."},231:{name:"Timecode",cppname:"ClusterTimecode",level:2,type:"u",mandatory:!0,minver:1,description:"Absolute timestamp of the cluster (based on TimecodeScale)."},524531317:{name:"Cluster",level:1,type:"m",multiple:!0,minver:1,description:"The lower level element containing the (monolithic) Block structure."},19840:{name:"MuxingApp",level:2,type:"8",mandatory:!0,minver:1,description:'Muxing application or library ("libmatroska-0.4.3").'},31657:{name:"Title",level:2,type:"8",minver:1,webm:!1,description:"General name of the segment."},2807730:{name:"TimecodeScaleDenominator",level:2,type:"u",mandatory:!0,minver:4,default:"1000000000",description:"Timestamp scale numerator, see TimecodeScale."},2807729:{name:"TimecodeScale",level:2,type:"u",mandatory:!0,minver:1,default:"1000000",description:"Timestamp scale in nanoseconds (1.000.000 means all timestamps in the segment are expressed in milliseconds)."},27045:{name:"ChapterTranslateID",level:3,type:"b",mandatory:!0,minver:1,webm:!1,description:"The binary value used to represent this segment in the chapter codec data. The format depends on the ChapProcessCodecID used."},27071:{name:"ChapterTranslateCodec",level:3,type:"u",mandatory:!0,minver:1,webm:!1,description:"The chapter codec using this ID (0: Matroska Script, 1: DVD-menu)."},27132:{name:"ChapterTranslateEditionUID",level:3,type:"u",multiple:!0,minver:1,webm:!1,description:"Specify an edition UID on which this correspondance applies. When not specified, it means for all editions found in the segment."},4096955:{name:"NextFilename",level:2,type:"8",minver:1,webm:!1,description:"An escaped filename corresponding to the next segment."},4110627:{name:"NextUID",level:2,type:"b",minver:1,webm:!1,bytesize:16,description:"A unique ID to identify the next chained segment (128 bits)."},3965867:{name:"PrevFilename",level:2,type:"8",minver:1,webm:!1,description:"An escaped filename corresponding to the previous segment."},3979555:{name:"PrevUID",level:2,type:"b",minver:1,webm:!1,bytesize:16,description:"A unique ID to identify the previous chained segment (128 bits)."},29604:{name:"SegmentUID",level:2,type:"b",minver:1,webm:!1,range:"not 0",bytesize:16,description:"A randomly generated unique ID to identify the current segment between many others (128 bits)."},357149030:{name:"Info",level:1,type:"m",mandatory:!0,multiple:!0,minver:1,description:"Contains miscellaneous general information and statistics on the file."},21420:{name:"SeekPosition",level:3,type:"u",mandatory:!0,minver:1,description:"The position of the element in the segment in octets (0 = first level 1 element).",position:"segment"},21419:{name:"SeekID",level:3,type:"b",mandatory:!0,minver:1,description:"The binary ID corresponding to the element name.",type2:"ebmlID"},19899:{name:"Seek",cppname:"SeekPoint",level:2,type:"m",mandatory:!0,multiple:!0,minver:1,description:"Contains a single seek entry to an EBML element."},290298740:{name:"SeekHead",cppname:"SeekHeader",level:1,type:"m",multiple:!0,minver:1,description:"Contains the position of other level 1 elements."},32379:{name:"SignatureElementList",level:2,type:"m",multiple:!0,webm:!1,i:"Cluster|Block|BlockAdditional",description:"A list consists of a number of consecutive elements that represent one case where data is used in signature. Ex:  means that the BlockAdditional of all Blocks in all Clusters is used for encryption."},32347:{name:"SignatureElements",level:1,type:"m",webm:!1,description:"Contains elements that will be used to compute the signature."},32437:{name:"Signature",level:1,type:"b",webm:!1,description:"The signature of the data (until a new."},32421:{name:"SignaturePublicKey",level:1,type:"b",webm:!1,description:"The public key to use with the algorithm (in the case of a PKI-based signature)."},32410:{name:"SignatureHash",level:1,type:"u",webm:!1,description:"Hash algorithm used (1=SHA1-160, 2=MD5)."},32394:{name:"SignatureAlgo",level:1,type:"u",webm:!1,description:"Signature algorithm used (1=RSA, 2=elliptic)."},458458727:{name:"SignatureSlot",level:-1,type:"m",multiple:!0,webm:!1,description:"Contain signature of some (coming) elements in the stream."},191:{name:"CRC-32",level:-1,type:"b",minver:1,webm:!1,description:"The CRC is computed on all the data of the Master element it's in. The CRC element should be the first in it's parent master for easier reading. All level 1 elements should include a CRC-32. The CRC in use is the IEEE CRC32 Little Endian",crc:!0},236:{name:"Void",level:-1,type:"b",minver:1,description:"Used to void damaged data, to avoid unexpected behaviors when using damaged data. The content is discarded. Also used to reserve space in a sub-element for later use."},17139:{name:"EBMLMaxSizeLength",level:1,type:"u",mandatory:!0,default:8,minver:1,description:"The maximum length of the sizes you'll find in this file (8 or less in Matroska). This does not override the element size indicated at the beginning of an element. Elements that have an indicated size which is larger than what is allowed by EBMLMaxSizeLength shall be considered invalid."},17138:{name:"EBMLMaxIDLength",level:1,type:"u",mandatory:!0,default:4,minver:1,description:"The maximum length of the IDs you'll find in this file (4 or less in Matroska)."},17143:{name:"EBMLReadVersion",level:1,type:"u",mandatory:!0,default:1,minver:1,description:"The minimum EBML version a parser has to support to read this file."},440786851:{name:"EBML",level:"0",type:"m",mandatory:!0,multiple:!0,minver:1,description:"Set the EBML characteristics of the data to follow. Each EBML document has to start with this."}},k={},C={byEbmlID:g,byName:k};for(var L in g){var B=g[L];k[B.name.replace("-","_")]=parseInt(L,10)}d.exports=C},{}],18:[function(p,d,b){d.exports={name:"ts-ebml",version:"2.0.2",description:"ebml decoder and encoder",scripts:{setup:"npm install -g http-server;",init:"npm run update; npm run mkdir; npm run build",update:"npm run reset; npm update",reset:"rm -rf node_modules",mkdir:"mkdir lib dist 2>/dev/null",clean:"rm -rf lib/* dist/* test/*.js; mkdir -p dist",build:"npm run clean   && tsc    -p .; npm run browserify",start:"http-server . -s & tsc -w -p .& watchify lib/example_seekable.js -o test/example_seekable.js",stop:"killall -- node */tsc -w -p",browserify:"browserify lib/index.js --standalone EBML -o dist/EBML.js",watchify:"watchify lib/index.js --standalone EBML -o dist/EBMl.js -v",test:"tsc; espower lib/test.js > lib/test.tmp; mv -f lib/test.tmp lib/test.js; browserify lib/test.js -o test/test.js",example:"tsc; browserify lib/example_seekable.js -o test/example_seekable.js",examples:"tsc; for file in `find lib -name 'example_*.js' -type f -printf '%f\\n'`; do browserify lib/$file -o test/$file; done",examples_bsd:"tsc; for file in `find lib -name 'example_*.js' -type f -print`; do browserify lib/$(basename $file) -o test/$(basename $file); done",check:"tsc -w --noEmit -p ./",lint:"tslint -c ./tslint.json --project ./tsconfig.json --type-check",doc:"typedoc --mode modules --out doc --disableOutputCheck"},repository:{type:"git",url:"git+https://github.com/legokichi/ts-ebml.git"},keywords:["ebml","webm","mkv","matrosika","webp"],author:"legokichi duckscallion",license:"MIT",bugs:{url:"https://github.com/legokichi/ts-ebml/issues"},homepage:"https://github.com/legokichi/ts-ebml#readme",dependencies:{buffer:"^5.0.7",commander:"^2.11.0",ebml:"^2.2.1","ebml-block":"^1.1.0",events:"^1.1.1","int64-buffer":"^0.1.9",matroska:"^2.2.3"},devDependencies:{"@types/commander":"^2.9.1","@types/qunit":"^2.0.31",browserify:"^13.1.0",empower:"^1.2.3","espower-cli":"^1.1.0","power-assert":"^1.4.4","power-assert-formatter":"^1.4.1","qunit-tap":"^1.5.1",qunitjs:"^2.4.0",tslint:"^3.15.1",typedoc:"^0.5.3",typescript:"^2.4.2",watchify:"^3.7.0"},bin:"./lib/cli.js",main:"./lib/index.js",typings:"./lib/index.d.ts"}},{}]},{},[4])(4)})});/*! js-cookie v3.0.5 | MIT */function assign(p){for(var d=1;d<arguments.length;d++){var b=arguments[d];for(var g in b)p[g]=b[g]}return p}var defaultConverter={read:function(p){return p[0]==='"'&&(p=p.slice(1,-1)),p.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(p){return encodeURIComponent(p).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function init(p,d){function b(k,C,L){if(!(typeof document>"u")){L=assign({},d,L),typeof L.expires=="number"&&(L.expires=new Date(Date.now()+L.expires*864e5)),L.expires&&(L.expires=L.expires.toUTCString()),k=encodeURIComponent(k).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var B="";for(var h in L)L[h]&&(B+="; "+h,L[h]!==!0&&(B+="="+L[h].split(";")[0]));return document.cookie=k+"="+p.write(C,k)+B}}function g(k){if(!(typeof document>"u"||arguments.length&&!k)){for(var C=document.cookie?document.cookie.split("; "):[],L={},B=0;B<C.length;B++){var h=C[B].split("="),m=h.slice(1).join("=");try{var y=decodeURIComponent(h[0]);if(L[y]=p.read(m,y),k===y)break}catch{}}return k?L[k]:L}}return Object.create({set:b,get:g,remove:function(k,C){b(k,"",assign({},C,{expires:-1}))},withAttributes:function(k){return init(this.converter,assign({},this.attributes,k))},withConverter:function(k){return init(assign({},this.converter,k),this.attributes)}},{attributes:{value:Object.freeze(d)},converter:{value:Object.freeze(p)}})}var api=init(defaultConverter,{path:"/"});const Event={styleSheetAdded:"CSS.styleSheetAdded",scriptParsed:"Debugger.scriptParsed",domStorageItemRemoved:"DOMStorage.domStorageItemRemoved",domStorageItemsCleared:"DOMStorage.domStorageItemsCleared",setChildNodes:"DOM.setChildNodes",childNodeCountUpdated:"DOM.childNodeCountUpdated",childNodeInserted:"DOM.childNodeInserted",childNodeRemoved:"DOM.childNodeRemoved",attributeModified:"DOM.attributeModified",attributeRemoved:"DOM.attributeRemoved",characterDataModified:"DOM.characterDataModified",requestWillBeSent:"Network.requestWillBeSent",responseReceivedExtraInfo:"Network.responseReceivedExtraInfo",responseReceived:"Network.responseReceived",loadingFinished:"Network.loadingFinished",responseBody:"Network.responseBody",screencastFrame:"Page.screencastFrame",executionContextCreated:"Runtime.executionContextCreated",consoleAPICalled:"Runtime.consoleAPICalled",exceptionThrown:"Runtime.exceptionThrown",nodeHighlightRequested:"Overlay.nodeHighlightRequested",inspectNodeRequested:"Overlay.inspectNodeRequested",captured:"ScreenPreview.captured",syncScroll:"ScreenPreview.syncScroll",webrtcAnswer:"ScreenRecorder.webrtcAnswer"};var numbers="0123456789",letters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",specials="~!@#$%^*()_+-=[]{}|;:,./<>?";function random(p,d){p||(p=8),d||(d={});var b="",g="";for(d===!0?b=numbers+letters+specials:typeof d=="string"?b=d:(d.numbers!==!1&&(b+=typeof d.numbers=="string"?d.numbers:numbers),d.letters!==!1&&(b+=typeof d.letters=="string"?d.letters:letters),d.specials&&(b+=typeof d.specials=="string"?d.specials:specials));p>0;)p--,g+=b[Math.floor(Math.random()*b.length)];return g}var stringRandom=random.default=random;const uuid=getDefaultExportFromCjs(stringRandom),getTimestamp=()=>Date.now()/1e3;class Network{constructor(){dt(this,"namespace","Network"),dt(this,"requestId",uuid(32)),dt(this,"isEnable",!1),dt(this,"socketSend",d=>{var b,g;this.isEnable&&this.send(d);const k=(g=(b=d.params)==null?void 0:b.request)==null?void 0:g.url;isUrlFiltered(k)||addNetwork(d)}),this.hookXhr(),isSelf()?this.hookShareWorkerFetch():this.hookFetch()}static formatResponseHeader(d){const b={};return d.split(`
`).filter(g=>g).forEach(g=>{const[k,C]=g.split(":");b[key2UpperCase(k)]=C}),b}static getDefaultHeaders(){const d={"User-Agent":navigator.userAgent};return isSelf()||document.cookie&&(d.Cookie=document.cookie),d}enable(){this.isEnable=!0}getResponseBody({requestId:d}){return{body:"{}",base64Encoded:!1}}getCookies(){const d=api.get();return{cookies:Object.keys(d).map(b=>({name:b,value:d[b]}))}}deleteCookies({name:d}){api.remove(d,{path:"/"})}setCookie({name:d,value:b,path:g}){api.set(d,b,{path:g})}getRequestId(){return this.requestId=uuid(32),this.requestId}hookXhr(){const d=this,b=XMLHttpRequest.prototype.send,g=XMLHttpRequest.prototype.open,k=XMLHttpRequest.prototype.setRequestHeader;XMLHttpRequest.prototype.open=function(C,L,...B){const h=getAbsoultPath(L);this.$$request={method:C,url:h,requestId:d.getRequestId(),headers:Network.getDefaultHeaders()},g.call(this,C,h,...B)},XMLHttpRequest.prototype.send=function(C){b.call(this,C);const L=this.$$request,{requestId:B,url:h,method:m}=L;m.toLowerCase()==="post"&&!isReqBodyFiltered(h)&&(L.postData=C,L.hasPostData=!!C),d.socketSend({method:Event.requestWillBeSent,params:{requestId:B,request:L,documentURL:location.href,timestamp:getTimestamp(),wallTime:Date.now(),type:this.$$requestType||"XHR"}}),this.addEventListener("readystatechange",()=>{if(this.readyState===4){const y=this.getAllResponseHeaders(),D=Network.formatResponseHeader(y);d.sendNetworkEvent({requestId:B,url:getAbsoultPath(h),headers:D,blockedCookies:[],headersText:y,type:this.$$requestType||"XHR",status:this.status,statusText:this.statusText,encodedDataLength:Number(this.getResponseHeader("Content-Length"))})}}),this.addEventListener("load",()=>{if(this.responseType===""||this.responseType==="text"){if(isResBodyFiltered(h))return;addNetwork({method:Event.responseBody,params:{requestId:B,body:this.responseText}})}})},XMLHttpRequest.prototype.setRequestHeader=function(C,L){this.$$request&&(this.$$request.headers[C]=L),k.call(this,C,L)}}hookFetch(){const d=this,b=window.fetch;window.fetch=function(g,k={}){let C,L,B="";typeof g=="string"?(C=g,L=k.method||"get",B=k.body):{url:C,method:L}=g,C=getAbsoultPath(C);const h=d.getRequestId(),m={url:C,method:L,requestId:h,headers:Network.getDefaultHeaders()};L.toLowerCase()==="post"&&!isReqBodyFiltered(C)&&(m.postData=B,m.hasPostData=!!B),d.socketSend({method:Event.requestWillBeSent,params:{requestId:h,documentURL:location.href,timestamp:getTimestamp(),wallTime:Date.now(),type:"Fetch",request:m}});let y;return b(g,k).then(D=>{y=D;const{headers:K,status:Y,statusText:W}=D,ye={};let te="";K.forEach((ue,de)=>{de=key2UpperCase(de),ye[de]=ue,te+=`${de}: ${ue}\r
`}),d.sendNetworkEvent({url:C,requestId:h,status:Y,statusText:W,headersText:te,type:"Fetch",blockedCookies:[],headers:ye,encodedDataLength:Number(K.get("Content-Length"))});const fe=K.get("Content-Type");return["application/json","application/javascript","text/plain","text/html","text/css"].some(ue=>fe==null?void 0:fe.includes(ue))?D.clone().text():""}).then(D=>{if(!isResBodyFiltered(C))return addNetwork({method:Event.responseBody,params:{requestId:h,body:D}}),y}).catch(D=>{throw d.sendNetworkEvent({url:C,requestId:h,blockedCookies:[],type:"Fetch"}),D})}}hookShareWorkerFetch(){const d=this,b=self.fetch;self.fetch=function(g,k={}){let C,L,B="";typeof g=="string"?(C=g,L=k.method||"get",B=k.body):{url:C,method:L}=g,C=getAbsoultPath(C);const h=d.getRequestId(),m={url:C,method:L,requestId:h,headers:Network.getDefaultHeaders()};L.toLowerCase()==="post"&&!isReqBodyFiltered(C)&&(m.postData=B,m.hasPostData=!!B),d.socketSend({method:Event.requestWillBeSent,params:{requestId:h,documentURL:location.href,timestamp:getTimestamp(),wallTime:Date.now(),type:"Fetch",request:m}});let y;return b(g,k).then(D=>{y=D;const{headers:K,status:Y,statusText:W}=D,ye={};let te="";K.forEach((ue,de)=>{de=key2UpperCase(de),ye[de]=ue,te+=`${de}: ${ue}\r
`}),d.sendNetworkEvent({url:C,requestId:h,status:Y,statusText:W,headersText:te,type:"Fetch",blockedCookies:[],headers:ye,encodedDataLength:Number(K.get("Content-Length"))});const fe=K.get("Content-Type");return["application/json","application/javascript","text/plain","text/html","text/css"].some(ue=>fe==null?void 0:fe.includes(ue))?D.clone().text():""}).then(D=>{if(!isResBodyFiltered(C))return addNetwork({method:Event.responseBody,params:{requestId:h,body:D}}),y}).catch(D=>{throw d.sendNetworkEvent({url:C,requestId:h,blockedCookies:[],type:"Fetch"}),D})}}sendNetworkEvent(d){const{requestId:b,headers:g,headersText:k,type:C,url:L,status:B,statusText:h,encodedDataLength:m}=d;isUrlFiltered(L)||(this.socketSend({method:Event.responseReceivedExtraInfo,params:{requestId:b,headers:g,blockedCookies:[],headersText:k}}),this.socketSend({method:Event.responseReceived,params:{type:C,requestId:b,timestamp:getTimestamp(),response:{url:L,status:B,statusText:h,headers:g}}}),this.socketSend({method:Event.loadingFinished,params:{requestId:b,encodedDataLength:m,timestamp:getTimestamp()}}))}async getDbNetworks(d){console.log("getDbNetworks",d);const b=await getNetworks(d.startTime,d.endTime);console.log("getDbNetworks",d,b),b==null||b.forEach(g=>this.send(g.data))}}const objectIds=new Map,objects=new Map,origins=new Map;let currentId=1;const getIdByObject=(p,d)=>{let b=objectIds.get(p);return b||(b=`${currentId++}`,objects.set(b,p),objectIds.set(p,b),origins.set(b,d),b)},getRealType=p=>{const d=/\[object\s+(.*)\]/.exec(Object.prototype.toString.call(p));return d?d[1]:""},getSubType=p=>{try{if(p&&[1,8,9].includes(p.nodeType))return"node"}catch{}const d=getRealType(p).toLowerCase();return["array","null","regexp","date","map","set","weakmap","weakset","error","proxy","promise","arraybuffer","iterator","generator"].includes(d)?d:""},getType=p=>({type:typeof p,subtype:getSubType(p)}),getPreview=(p,d={})=>{const{length:b=5,origin:g=p}=d,k=Object.keys(p),C=[];return k.slice(0,b).forEach(L=>{var B;let h;try{h=g[L]}catch{}const{type:m,subtype:y}=getType(h);m==="object"?y==="array"?h=`Array(${h.length})`:y==="null"?h="null":["date","regexp"].includes(y)?h=h.toString():y==="node"?h=`#${h.nodeName}`:h=(B=h.constructor)==null?void 0:B.name:h=h===void 0?"undefined":h.toString(),C.push({name:L,type:m,subtype:y,value:h})}),{overflow:k.length>b,properties:C}};function objectFormat(p,d={}){var b,g,k,C,L;const{origin:B=p,preview:h=!1}=d,{type:m,subtype:y}=getType(p);if(m==="undefined")return{type:m};if(m==="number")return{type:m,value:p,description:p.toString()};if(m==="string"||m==="boolean")return{type:m,value:p};if(m==="symbol")return{type:m,objectId:getIdByObject(p,B),description:p.toString()};if(y==="null")return{type:m,subtype:y,value:p};const D={type:m,subtype:y,objectId:getIdByObject(p,B)};return m==="function"?(D.className="Function",D.description=p.toString(),h&&(D.preview={type:m,subtype:y,description:p.toString(),...getPreview(p,{origin:B})})):y==="array"?(D.className="Array",D.description=`Array(${p.length})`,h&&(D.preview={type:m,subtype:y,description:`Array(${p.length})`,...getPreview(p,{length:100,origin:B})})):y==="error"?(D.className="Error",D.description=p.stack,h&&(D.preview={type:m,subtype:y,description:p.stack,...getPreview(p,{origin:B})})):y==="node"?(D.className=(b=p.constructor)==null?void 0:b.name,D.description=(g=p.constructor)==null?void 0:g.name):(D.className=(k=p.constructor)==null?void 0:k.name,D.description=(C=p.constructor)==null?void 0:C.name,h&&(D.preview={type:m,subtype:y,description:(L=p.constructor)==null?void 0:L.name,...getPreview(p,{origin:B})})),D}function getObjectProperties(p){const{accessorPropertiesOnly:d,generatePreview:b,objectId:g,ownProperties:k}=p,C=objects.get(g),L=origins.get(g),B=[],h=C.__proto__,m=h&&!k?h:C,y=Object.getOwnPropertyNames(m);for(const D of y){if(D==="__proto__")continue;const K={name:D};let Y;try{Y=L[D]}catch{}const W=Object.getOwnPropertyDescriptor(m,D);d&&!W.get&&!W.set||(K.configurable=W.configurable,K.enumerable=W.enumerable,K.writable=W.writable,K.isOwn=k?!0:h.hasOwnProperty(D),K.value=objectFormat(Y,{preview:b}),B.push(K))}return h&&B.push({name:"__proto__",configurable:!0,enumerable:!1,isOwn:k,value:objectFormat(h,{origin:L})}),B}function objectRelease({objectId:p}){const d=objects.get(p);objects.delete(p,d),objectIds.delete(d,p),origins.delete(p,origin)}class Console{constructor(){dt(this,"namespace","Console"),dt(this,"cacheConsole",[]),dt(this,"cacheError",[]),dt(this,"isEnable",!1),dt(this,"socketSend",async(p,d)=>{}),configParams.yomConsoleEnable==="1"&&(this.listenError(),isSelf()?this.hookShareWorkerConsole():this.hookConsole())}static getCallFrames(p){let d=[],b;return p!=null&&p.stack?(b=p.stack,d=b.split(`
`).map(g=>({functionName:g,...Console.getPositionAndUrl(g)}))):Error.captureStackTrace?d=callsites().map(g=>({functionName:g.getFunctionName(),lineNumber:g.getLineNumber(),columnNumber:g.getColumnNumber(),url:g.getFileName()})):(b=new Error().stack,console.info(777),console.info(b),d=b.split(`
`).map(g=>({functionName:g,...Console.getPositionAndUrl(g)}))),d.shift(),d}static getPositionAndUrl(p){const d=/at\s+(.*)(?::([0-9]+):([0-9]+))$/,b=/@+(.*)(?::([0-9]+):([0-9]+))$/;let g;return d.test(p)?g=d.exec(p):b.test(p)&&(g=b.exec(p)),g?{url:g[1],lineNumber:g[2],columnNumber:g[3]}:{}}enable(){this.isEnable=!0,this.cacheConsole.forEach(p=>this.send(p)),this.cacheError.forEach(p=>this.send(p)),this.send({method:Event.executionContextCreated,params:{context:{id:1,name:"top",origin:location.origin}}})}evaluate({expression,generatePreview}){const res=eval(expression);return{result:objectFormat(res,{preview:generatePreview})}}getProperties(p){return{result:getObjectProperties(p)}}releaseObject(p){objectRelease(p)}hookConsole(){const p={log:"log",warn:"warning",info:"info",error:"error",debug:"debug"};Object.keys(p).forEach(d=>{const b=window.console[d];window.console[d]=(...g)=>{configParams.chromeConsoleEnable==="1"&&b(...g),addConsole(p[d],Date.now(),g)}})}hookShareWorkerConsole(){const p={log:"log",warn:"warning",info:"info",error:"error",debug:"debug"};Object.keys(p).forEach(d=>{const b=self.console[d];self.console[d]=(...g)=>{configParams.chromeConsoleEnable==="1"&&b(...g),addConsole(p[d],Date.now(),g)}})}listenError(){const p=d=>{const b={method:Event.exceptionThrown,params:{timestamp:Date.now(),exceptionDetails:{text:"Uncaught",exception:{type:"object",subtype:"error",className:(d==null?void 0:d.name)||"Error",description:(d==null?void 0:d.stack)||"Script error."},stackTrace:{callFrames:Console.getCallFrames(d)}}}};this.socketSend("error",b)};isSelf()?(self.addEventListener("error",d=>p(d.error)),self.addEventListener("unhandledrejection",d=>p(d.reason))):(window.addEventListener("error",d=>p(d.error)),window.addEventListener("unhandledrejection",d=>p(d.reason)))}async getDbConsoles(p){const d=await getConsole(p.startTime,p.endTime);console.log("getDbConsoles",d),d==null||d.forEach(b=>this.send(b.data))}}isSelf()||window.addEventListener("keydown",function(p){p.ctrlKey&&p.altKey&&p.key==="6"&&addOverlay()});function registerProtocol(){new Network,new Console}async function getConsoleList(p,d){return await getConsole(p,d)}async function getNetworkList(p,d){return await getNetworks(p,d)}async function downloadFile2Local(p,d){await downloadData(p,d)}async function recordScreen(){const p={audio:!0,video:{displaySurface:"window"}},d=await webrtc.getScreen(p),b=await startRecordClick(d),{startTime:g,endTime:k}=b;return console.log("startRecordClick then",g,k),await downloadRecord(g,k),b}registerProtocol(),setTimeout(()=>{clearDataRegularly()},1e3*60);const index={registerProtocol,getConsoleList,getNetworkList,downloadFile2Local,openNewDatabase,recordScreen,addCallback,...config};console.log("self yom",index),index.setConfig({logRorate:3,yomNetworkEnable:"1",yomConsoleEnable:"1",chromeConsoleEnable:"1",workerBaseUrl:"",dbName:"",networkFilter:[{url:"http://10.110.13.54:10086/",isFullPath:!0,filter:2}]}),console.log("6666"),self.onconnect=function(p){const d=p.ports[0];d.onmessage=function(b){console.info("SharedWorker received:",b.data),d.postMessage("Hello from SharedWorker!");let g=0;setInterval(()=>{g++,console.info("setInterval worker i",g),d.postMessage(g+" from SharedWorker!")},1e3)},setTimeout(()=>{setXHRRequest()},3e3)};function setXHRRequest(){fetch("http://10.110.13.54:10086",{method:"GET"}).then(p=>{console.log("res",p)}).catch(p=>console.error("err",p))}})();
